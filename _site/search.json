[
  {
    "objectID": "other-topics.html",
    "href": "other-topics.html",
    "title": "Other: Interrupted TS/ARFIMA/Spectral Analysis",
    "section": "",
    "text": "Code\n#1. Load Bitcoin Data (Self-Contained Block)\n#| label: load-btc\n#| warning: false\n#| message: false\n\nsuppressPackageStartupMessages({\n  library(tidyverse)\n  library(quantmod)\n  library(zoo)\n  library(lubridate)\n})\n\n\nWarning: package 'ggplot2' was built under R version 4.4.1\n\n\nWarning: package 'lubridate' was built under R version 4.4.1\n\n\nWarning: package 'quantmod' was built under R version 4.4.1\n\n\nWarning: package 'xts' was built under R version 4.4.1\n\n\nCode\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\nbtc_data &lt;- getSymbols(\"CBBTCUSD\",\n                       src=\"FRED\",\n                       from=start_date,\n                       to=end_date,\n                       auto.assign=FALSE)\n\nbtc_df &lt;- fortify.zoo(btc_data)\ncolnames(btc_df) &lt;- c(\"Date\", \"Bitcoin\")\nbtc_df &lt;- btc_df |&gt; arrange(Date) |&gt; drop_na()\n\nbtc_returns &lt;- btc_df |&gt;\n  mutate(Bitcoin_ret = c(NA, diff(log(Bitcoin)))) |&gt;\n  drop_na()\nBitcoin returns remain very noisy with frequent spikes both up and down. The plot shows a cluster of heavier negative returns around late 2022, but outside of that, the series behaves in its typical volatile fashion.\nCode\n#2. Create Intervention Variables\n#| label: its-intervention\n#| warning: false\n\nintervention_date &lt;- as.Date(\"2022-11-08\")  # FTX collapse\n\nits_df &lt;- btc_returns |&gt;\n  mutate(\n    time_index = row_number(),\n    intervention = if_else(Date &gt;= intervention_date, 1, 0),\n    time_after_intervention = if_else(Date &gt;= intervention_date,\n                                      time_index - min(time_index[Date &gt;= intervention_date]),\n                                      0)\n  )\nCode\n# 3. Plot Bitcoin Returns with Intervention Line\n#| label: its-plot\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\nggplot(its_df, aes(Date, Bitcoin_ret)) +\n  geom_line(color=\"steelblue\", alpha=0.8) +\n  geom_vline(xintercept = as.numeric(intervention_date),\n             color=\"red\", linewidth=1) +\n  labs(title=\"Bitcoin Daily Log Returns with FTX Collapse\",\n       x=\"Date\", y=\"Log Return\") +\n  theme_minimal()\n\n\nWarning in scale_x_date(): A &lt;numeric&gt; value was passed to a Date scale.\nℹ The value was converted to a &lt;Date&gt; object."
  },
  {
    "objectID": "other-topics.html#interpretation-of-the-trend-plot",
    "href": "other-topics.html#interpretation-of-the-trend-plot",
    "title": "Other: Interrupted TS/ARFIMA/Spectral Analysis",
    "section": "Interpretation of the Trend Plot",
    "text": "Interpretation of the Trend Plot\nThe pre- and post-FTX trend lines are nearly flat and almost identical. This visually confirms what the regression results showed:\n\nno major uptick in average returns\nno sustained downturn\nno visible new trend emerging after the collapse\n\nOverall, Bitcoin simply returns to its usual noisy, mean-reverting behavior after the event.\n\n\nCode\n#4. Fit Interrupted Time Series Regression Model\n#| label: its-model\n#| warning: false\n\nits_model &lt;- lm(\n  Bitcoin_ret ~ time_index + intervention + time_after_intervention,\n  data = its_df\n)\n\nsummary(its_model)\n\n\n\nCall:\nlm(formula = Bitcoin_ret ~ time_index + intervention + time_after_intervention, \n    data = its_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.47090 -0.01414 -0.00108  0.01410  0.18156 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)              4.035e-03  1.801e-03   2.241   0.0251 *\ntime_index              -4.037e-06  2.219e-06  -1.819   0.0690 .\nintervention             3.484e-03  2.755e-03   1.265   0.2060  \ntime_after_intervention  3.667e-06  4.106e-06   0.893   0.3718  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.03373 on 2447 degrees of freedom\nMultiple R-squared:  0.0014,    Adjusted R-squared:  0.0001753 \nF-statistic: 1.143 on 3 and 2447 DF,  p-value: 0.3302"
  },
  {
    "objectID": "other-topics.html#interpretation-did-the-ftx-collapse-create-a-meaningful-structural-change",
    "href": "other-topics.html#interpretation-did-the-ftx-collapse-create-a-meaningful-structural-change",
    "title": "Other: Interrupted TS/ARFIMA/Spectral Analysis",
    "section": "Interpretation: Did the FTX collapse create a meaningful structural change?",
    "text": "Interpretation: Did the FTX collapse create a meaningful structural change?\nBased on the ITS regression:\nImmediate level shift: The coefficient for the intervention date is 0.00348, but it is not statistically significant (p = 0.206). → This means Bitcoin did not experience a clear jump or drop in average returns on the exact day of the collapse.\nPre-event trend: The time_index coefficient is slightly negative and borderline significant (p ≈ 0.069). → Bitcoin returns showed a mild downward drift heading into the event.\nPost-event trend change: The “time_after_intervention” slope is very small and not significant (p = 0.37). → The slope of returns after the event did not materially change.\nConclusion:\nThere is no statistical evidence that the FTX collapse created a persistent shift in Bitcoin’s return levels or trend. Short-term volatility was visible around the event, but there is no long-term structural break in the daily returns.\n\n\nCode\n#5. Pre-Intervention vs Post-Intervention Trend Lines\n#| label: its-trendlines\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\nggplot(its_df, aes(Date, Bitcoin_ret)) +\n  geom_line(alpha=0.5, color=\"gray40\") +\n  geom_vline(xintercept = as.numeric(intervention_date),\n             color=\"red\", linewidth=1) +\n  geom_smooth(\n    data = its_df |&gt; filter(Date &lt; intervention_date),\n    method=\"lm\", se=FALSE, color=\"blue\", linewidth=1\n  ) +\n  geom_smooth(\n    data = its_df |&gt; filter(Date &gt;= intervention_date),\n    method=\"lm\", se=FALSE, color=\"darkgreen\", linewidth=1\n  ) +\n  labs(title=\"Pre- vs Post-FTX Trend in Bitcoin Returns\",\n       x=\"Date\", y=\"Log Return\") +\n  theme_minimal()\n\n\nWarning in scale_x_date(): A &lt;numeric&gt; value was passed to a Date scale.\nℹ The value was converted to a &lt;Date&gt; object.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\nCode\n#6. Plot Mean Levels Before & After (Boxplot)\n#| label: its-boxplot\n#| warning: false\n#| fig.width: 8\n#| fig.height: 5\n\nggplot(its_df, aes(x = factor(intervention, labels=c(\"Before\",\"After\")),\n                   y = Bitcoin_ret)) +\n  geom_boxplot(fill=\"lightblue\") +\n  labs(title=\"Distribution of Bitcoin Returns Before vs After FTX Collapse\",\n       x=\"Period\", y=\"Daily Log Return\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThe distribution of returns before and after FTX looks nearly the same:\nMedians are almost identical\nThe spread is similar\nExtreme outliers exist in both periods\nSlightly fewer huge negative outliers after the collapse\nThis matches the regression: the event did not shift the average return or the variance in a meaningful way.\n\n\nCode\n#7. Optional: Residual Diagnostics for ITS Model\n#| label: its-diagnostics\n#| warning: false\n#| fig.width: 10\n#| fig.height: 6\n\npar(mfrow=c(2,2))\nplot(its_model)\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\nThe FTX collapse produced temporary turbulence in Bitcoin returns but did not cause any significant long-run shift in the average return or trend. Bitcoin’s underlying return behavior remained essentially unchanged after the event."
  },
  {
    "objectID": "introduction.html",
    "href": "introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "This project explores the connected nature of modern financial markets by examining how volatility, price fluctuation and market uncertainty spread across different asset classes. This analysis specifically focuses on the emerging cryptocurrency market and how they may influence traditional financial instruments, including equities, commodities, bonds, and volatility indices.\nVolatility spillovers occur when price shocks or periods of uncertainty in one market affect other markets, creating a domino effect of financial instability or opportunity. While traditional spillover research has long studied connections between established markets (such as how U.S. stock market crashes affect European markets), the rapid growth of cryptocurrency markets has introduced an entirely new dynamic to global financial systems.\nThe central question driving this research is: How do cryptocurrency market fluctuations propagate through traditional financial markets, and what does this mean for investors, regulators, and the broader economy? This investigation is particularly relevant given recent events such as the 2022 cryptocurrency market collapse, the FTX exchange failure, Federal Reserve interest rate policies, and ongoing debates about cryptocurrency regulation and systemic risk.\nUnlike traditional financial assets backed by physical assets or cash flows, cryptocurrencies represent a new category of digital assets with unique characteristics: 24/7 trading, high volatility, limited regulation, and strong retail investor participation. Understanding how these distinctive features interact with established financial markets is crucial for modern portfolio management, risk assessment, and financial stability monitoring.\nThis analysis goes beyond simple correlation studies to examine the directional flow of volatility, the persistence of spillover effects, and how these relationships change during different market conditions—from calm periods to major financial crises."
  },
  {
    "objectID": "introduction.html#volatility-spillovers-across-asset-classes-understanding-cryptocurrencys-impact-on-traditional-financial-markets",
    "href": "introduction.html#volatility-spillovers-across-asset-classes-understanding-cryptocurrencys-impact-on-traditional-financial-markets",
    "title": "Introduction",
    "section": "",
    "text": "This project explores the connected nature of modern financial markets by examining how volatility, price fluctuation and market uncertainty spread across different asset classes. This analysis specifically focuses on the emerging cryptocurrency market and how they may influence traditional financial instruments, including equities, commodities, bonds, and volatility indices.\nVolatility spillovers occur when price shocks or periods of uncertainty in one market affect other markets, creating a domino effect of financial instability or opportunity. While traditional spillover research has long studied connections between established markets (such as how U.S. stock market crashes affect European markets), the rapid growth of cryptocurrency markets has introduced an entirely new dynamic to global financial systems.\nThe central question driving this research is: How do cryptocurrency market fluctuations propagate through traditional financial markets, and what does this mean for investors, regulators, and the broader economy? This investigation is particularly relevant given recent events such as the 2022 cryptocurrency market collapse, the FTX exchange failure, Federal Reserve interest rate policies, and ongoing debates about cryptocurrency regulation and systemic risk.\nUnlike traditional financial assets backed by physical assets or cash flows, cryptocurrencies represent a new category of digital assets with unique characteristics: 24/7 trading, high volatility, limited regulation, and strong retail investor participation. Understanding how these distinctive features interact with established financial markets is crucial for modern portfolio management, risk assessment, and financial stability monitoring.\nThis analysis goes beyond simple correlation studies to examine the directional flow of volatility, the persistence of spillover effects, and how these relationships change during different market conditions—from calm periods to major financial crises."
  },
  {
    "objectID": "introduction.html#foundational-spillover-methodology-and-traditional-markets",
    "href": "introduction.html#foundational-spillover-methodology-and-traditional-markets",
    "title": "Introduction",
    "section": "Foundational Spillover Methodology and Traditional Markets",
    "text": "Foundational Spillover Methodology and Traditional Markets\nThe measurement of volatility spillovers has been revolutionized by the work of Diebold and Yilmaz (2012), who developed a generalized vector autoregressive framework in which forecast-error variance decompositions are invariant to variable ordering, enabling measures of both total and directional volatility spillovers. Their analysis of US stock, bond, foreign exchange, and commodities markets from 1999 to 2010 demonstrated that cross-market volatility spillovers were quite limited until the global financial crisis, which began in 2007, with particularly important spillovers from the stock market to other markets taking place after the collapse of Lehman Brothers in September 2008. This methodology has been extended by Engle (2002) with Dynamic Conditional Correlation models for evolving correlations, and by Baruník and Křehlík (2018), who introduced frequency-domain analysis to distinguish between short-run trader-driven spillovers and long-run fundamental economic relationships. Recent methodological advances include Antonakakis and Gabauer (2017), who refined these measures to capture time-varying connectedness using TVP-VAR methods that provide more dynamic and sensitive connectedness measurements, particularly when relationships in the system do not remain constant over time."
  },
  {
    "objectID": "introduction.html#cryptocurrency-integration-and-cross-market-spillovers",
    "href": "introduction.html#cryptocurrency-integration-and-cross-market-spillovers",
    "title": "Introduction",
    "section": "Cryptocurrency Integration and Cross-Market Spillovers",
    "text": "Cryptocurrency Integration and Cross-Market Spillovers\nThe emergence of cryptocurrency markets has fundamentally altered the landscape of financial spillovers, with mounting evidence of significant transmission effects to traditional asset classes. Recent studies demonstrate significant adverse volatility spillover effects from the cryptocurrency market to financial markets across various regions, including North America, South America, Europe, and Asia, with shocks originating in the cryptocurrency market negatively impacting stock markets, volatility indices, and foreign exchange rates globally. Research by the International Monetary Fund (2023) reveals that crypto assets predominantly transmit spillovers to financial markets, though reversals occur during periods of financial stress, with the magnitude of spillovers increasing during periods of heightened turbulence due to negative economic-financial news or crypto market events. The COVID-19 pandemic served as a natural experiment, with empirical analysis showing that the pandemic amplified volatility spillovers, thereby intensifying financial contagion between markets, indicating that the pandemic’s impact on the economy heightened risk transmission across markets. Notably, recent Chinese market evidence from 2018-2024 shows that cryptocurrency price volatility causes stock market prices to fluctuate in the same direction while causing gold market prices to fluctuate in the opposite direction, challenging traditional safe-haven assumptions."
  },
  {
    "objectID": "introduction.html#crisis-dynamics-frequency-effects-and-research-gaps",
    "href": "introduction.html#crisis-dynamics-frequency-effects-and-research-gaps",
    "title": "Introduction",
    "section": "Crisis Dynamics, Frequency Effects, and Research Gaps",
    "text": "Crisis Dynamics, Frequency Effects, and Research Gaps\nThe literature reveals that spillover relationships exhibit distinct patterns during crisis periods and across different time horizons, highlighting the importance of frequency-domain analysis and time-varying methodologies. Studies show that heightened crude oil volatility, stock volatility, and economic policy uncertainty contribute to more significant liquidity spillovers within cryptocurrency markets, with increased volatility in exchange rates, crude oil, gold, and stock markets enhancing Ethereum’s role as a transmitter of liquidity shocks. Research using DCC-GARCH and wavelet analysis during COVID-19 demonstrates that volatility spillovers in cryptocurrency markets exhibit information inefficiency characteristics, with mutual linkages reflected through volatility co-movement, lead/lag effects, and systematic risk transmission. However, despite these advances, significant gaps remain in the literature. Most existing studies focus on either cryptocurrency-to-crypto spillovers or limited bilateral relationships with specific traditional assets, rather than comprehensive multi-asset class analysis. Additionally, research indicates that extreme fluctuations not predicted by current models are primarily caused by sudden external events, suggesting that existing methods are better suited for early warning of endogenous market volatility rather than exogenous shocks. This project addresses these gaps by providing a systematic analysis of directional spillovers across multiple asset classes while incorporating both crisis-period dynamics and frequency-decomposed effects to better understand the evolving role of cryptocurrencies in global financial stability."
  },
  {
    "objectID": "introduction.html#references",
    "href": "introduction.html#references",
    "title": "Introduction",
    "section": "References",
    "text": "References\nAntonakakis, N., & Gabauer, D. (2017). Refined measures of dynamic connectedness based on time-varying parameter vector autoregressions. MPRA Paper.\nBaruník, J., & Křehlík, T. (2018). Measuring the frequency dynamics of financial connectedness and systemic risk. Journal of Financial Econometrics, 16(2), 271-296.\nDiebold, F. X., & Yilmaz, K. (2012). Better to give than to receive: Predictive directional measurement of volatility spillovers. International Journal of Forecasting, 28(1), 57-66. https://doi.org/10.1016/j.ijforecast.2011.02.006\nEngle, R. (2002). Dynamic conditional correlation: A simple class of multivariate generalized autoregressive conditional heteroskedasticity models. Journal of Business & Economic Statistics, 20(3), 339-350.\nInternational Monetary Fund. (2023). New evidence on spillovers between crypto assets and financial markets. IMF Working Paper, 2023/213.\nZhang, X., Chen, Z., & Wang, S. (2024). A study of the impact of cryptocurrency price volatility on the stock and gold markets. North American Journal of Economics and Finance, 75, 102193."
  },
  {
    "objectID": "introduction.html#analytical-angles",
    "href": "introduction.html#analytical-angles",
    "title": "Introduction",
    "section": "Analytical Angles",
    "text": "Analytical Angles\nOur volatility spillover analysis is structured around five distinct perspectives, each offering nsights into cryptocurrency-traditional market interactions:\n\nCrypto-Equity Spillovers: Examining how Bitcoin and Ethereum volatility influences stock market dynamics\nDigital Gold Hypothesis: Testing whether Bitcoin functions as a safe haven asset comparable to gold\nFear Gauge Interactions: Analyzing relationships between crypto volatility and market fear indicators (VIX)\nFrequency Analysis: Decomposing spillovers into short-term trader effects versus long-term economic relationships\nCrisis Dynamics & Stablecoins: Understanding how market relationships change during stress periods and stablecoin events"
  },
  {
    "objectID": "introduction.html#guiding-questions",
    "href": "introduction.html#guiding-questions",
    "title": "Introduction",
    "section": "Guiding Questions",
    "text": "Guiding Questions\nOur analysis addresses twelve fundamental questions that span directional spillovers, market-specific interactions, temporal patterns, and crisis dynamics:\n\nDirectional Spillover Analysis\n\nWhich direction is dominant: Do cryptocurrency markets transmit volatility to traditional markets, or do they receive volatility from them?\nWhat is the magnitude of spillover effects: How much of the variance in traditional market volatility can be explained by cryptocurrency market shocks?\nHow persistent are these effects: Do crypto-induced volatility spillovers last hours, days, or weeks in traditional markets?\n\n\n\nMarket-Specific Interactions\n\nDoes Bitcoin truly behave like “digital gold”: Under what market conditions does Bitcoin correlate positively vs. negatively with gold prices, and when does this relationship break down?\nHow does crypto volatility relate to the VIX “fear gauge”: Do cryptocurrency market crashes predict spikes in equity market fear, or do they respond to existing market stress?\nWhich traditional market sectors are most vulnerable: Are technology stocks more susceptible to crypto spillovers than utility or consumer staple sectors?\n\n\n\nTemporal and Frequency Analysis\n\nDo spillover patterns exhibit seasonality: Are there weekly (weekend effects), monthly (options expiry), or quarterly (earnings season) patterns in volatility transmission?\nHow do short-term vs. long-term spillovers differ: Are crypto spillovers primarily driven by high-frequency trading noise or by fundamental economic relationships?\nHow have spillover relationships evolved over time: Have cryptocurrencies become more or less connected to traditional markets as they’ve matured?\n\n\n\nCrisis and Event Analysis\n\nHow do major events reshape market connections: What was the impact of specific events like the FTX collapse, COVID-19 market crash, or Federal Reserve rate hikes on spillover dynamics?\nDo stablecoin de-pegging events amplify broader market volatility: When USDT or USDC lose their dollar peg, does this create systemic risk beyond crypto markets?\nCan we identify early warning signals: Are there leading indicators in cryptocurrency markets that predict broader financial market stress before traditional measures like the VIX?\n\nThese questions will guide our analysis and may evolve as findings emerge from exploratory data analysis and model estimation."
  },
  {
    "objectID": "introduction.html#data-requirements-overview",
    "href": "introduction.html#data-requirements-overview",
    "title": "Introduction",
    "section": "Data Requirements Overview",
    "text": "Data Requirements Overview\nOur analysis satisfies the course requirements by incorporating:\n\nSeasonality data: Cryptocurrency markets exhibit strong weekly patterns (weekday vs. weekend effects), monthly patterns, and holiday seasonality\nFinancial assets: Multiple asset classes including cryptocurrencies, equities, commodities, bonds, and volatility indices\n3+ univariate time series per analytical angle: Each of our five angles incorporates multiple distinct time series for comprehensive analysis"
  },
  {
    "objectID": "introduction.html#angle-1-crypto-equity-spillovers",
    "href": "introduction.html#angle-1-crypto-equity-spillovers",
    "title": "Introduction",
    "section": "Angle 1: Crypto-Equity Spillovers",
    "text": "Angle 1: Crypto-Equity Spillovers\nExamining how cryptocurrency volatility influences stock market dynamics\n\nBitcoin Daily Returns\n\nSource: Yahoo Finance API & CoinGecko API\nDescription: Daily closing prices, returns, and trading volumes for Bitcoin (BTC-USD)\nFrequency: Daily from 2018-present\nAcquisition Method:\nimport yfinance as yf\nbtc_data = yf.download('BTC-USD', start='2018-01-01', end='2024-12-31')\n\n\n\nEthereum Daily Returns\n\nSource: CoinGecko API & Yahoo Finance\nDescription: Daily price and volume data for Ethereum (ETH-USD)\nFrequency: Daily from 2018-present\nAcquisition Method: RESTful API calls to CoinGecko with rate limiting\nKey Variables: Price, market cap, trading volume, volatility measures\n\n\n\nS&P 500 Returns\n\nSource: FRED Economic Data & Yahoo Finance\nDescription: Daily closing values and returns for the S&P 500 index\nFrequency: Daily market data (excluding weekends/holidays)\nAcquisition Method: Direct download from FRED API or Yahoo Finance API"
  },
  {
    "objectID": "introduction.html#angle-2-digital-gold-hypothesis",
    "href": "introduction.html#angle-2-digital-gold-hypothesis",
    "title": "Introduction",
    "section": "Angle 2: Digital Gold Hypothesis",
    "text": "Angle 2: Digital Gold Hypothesis\nTesting whether Bitcoin functions as a safe haven asset comparable to gold\n\nBTC-Gold Price Data\n\nSources:\n\nBitcoin: CoinGecko API\nGold: COMEX via Quandl & FRED\n\nDescription: Daily spot prices for Bitcoin and gold futures/spot prices\nFrequency: Daily from 2018-present\nCorrelation Analysis: Rolling 30-day, 90-day, and 365-day correlation windows\n\n\n\nOil Prices (WTI)\n\nSource: EIA API & FRED\nDescription: West Texas Intermediate crude oil spot prices\nFrequency: Daily pricing data\nAcquisition Method:\nimport pandas_datareader as pdr\noil_data = pdr.get_data_fred('DCOILWTICO', start='2018-01-01')\n\n\n\nInflation Data (CPI)\n\nSource: Bureau of Labor Statistics & FRED\nDescription: Consumer Price Index for All Urban Consumers (CPI-U)\nFrequency: Monthly data (interpolated to daily for analysis)\nSeasonality: Seasonal adjustment factors, holiday price effects"
  },
  {
    "objectID": "introduction.html#angle-3-fear-gauge-interactions",
    "href": "introduction.html#angle-3-fear-gauge-interactions",
    "title": "Introduction",
    "section": "Angle 3: Fear Gauge Interactions",
    "text": "Angle 3: Fear Gauge Interactions\nAnalyzing relationships between crypto volatility and market fear indicators\n\nVIX Index\n\nSource: CBOE & Yahoo Finance\nDescription: Chicago Board Options Exchange Volatility Index (fear gauge)\nFrequency: Daily market data\nCalculation: Implied volatility from S&P 500 options\nCrisis Indicators: Spikes above 30 indicate high fear, above 40 indicate extreme fear\n\n\n\nBitcoin Realized Volatility\n\nSource: Calculated from Bitcoin price data (CoinGecko/Yahoo Finance)\nDescription: Historical volatility measures using various estimators\nCalculation Methods:\n\nParkinson estimator (high-low volatility)\nGarman-Klass-Yang-Zhang estimator\n\nSimple realized volatility (squared returns)\n\nFrequency: Daily, with 5-minute intraday data when available\nRolling Windows: 7-day, 30-day, and 90-day volatility measures\n\n\n\nCrypto Fear & Greed Index\n\nSource: Alternative.me API\nDescription: Sentiment indicator for cryptocurrency markets (0-100 scale)\nComponents: Volatility, market momentum, social media sentiment, surveys, Bitcoin dominance\nFrequency: Daily updates\nAcquisition Method: RESTful API with JSON response parsing\nInterpretation: 0-24 (Extreme Fear), 25-49 (Fear), 50-74 (Greed), 75-100 (Extreme Greed)"
  },
  {
    "objectID": "introduction.html#angle-4-frequency-analysis",
    "href": "introduction.html#angle-4-frequency-analysis",
    "title": "Introduction",
    "section": "Angle 4: Frequency Analysis",
    "text": "Angle 4: Frequency Analysis\nDecomposing spillovers into short-term trader effects versus long-term economic relationships\n\nTrading Volume Data\n\nSources:\n\nCrypto: CoinGecko API, Binance API\nEquities: Alpha Vantage, Yahoo Finance\n\nDescription: Daily and intraday trading volumes across multiple exchanges\nFrequency: Daily aggregates with hourly breakdown when available\nExchange Coverage: Binance, Coinbase, Kraken for crypto; NYSE, NASDAQ for equities\nVolume Metrics: USD volume, BTC volume, number of trades, average trade size\n\n\n\nPolicy Uncertainty Index\n\nSource: Economic Policy Uncertainty Index (Baker, Bloom, Davis)\nDescription: News-based measure of economic policy uncertainty\nFrequency: Daily updates based on newspaper coverage\nConstruction: Text analysis of major newspapers for uncertainty-related keywords\nWebsite: https://www.policyuncertainty.com/us_daily.html\n\n\n\nInstitutional Flow Data\n\nSources:\n\nGrayscale Investments - Bitcoin and Ethereum Trust flows\nETF.com - Cryptocurrency ETF flows\n\n13F filings via SEC EDGAR - Institutional holdings\n\nDescription: Weekly and monthly institutional investment flows into crypto products\nFrequency: Weekly for ETF flows, quarterly for 13F filings"
  },
  {
    "objectID": "introduction.html#angle-5-crisis-dynamics-stablecoins",
    "href": "introduction.html#angle-5-crisis-dynamics-stablecoins",
    "title": "Introduction",
    "section": "Angle 5: Crisis Dynamics & Stablecoins",
    "text": "Angle 5: Crisis Dynamics & Stablecoins\nUnderstanding how market relationships change during stress periods and stablecoin events\n\nStablecoin De-peg Events\n\nSources:\n\nUSDT: Tether API & CoinGecko\nUSDC: Centre Consortium & CoinGecko\n\nDescription: Real-time pricing data for major stablecoins to identify de-pegging events\nDe-peg Definition: Price deviation &gt;0.5% from $1.00 USD for &gt;24 hours\nHistorical Events: May 2022 Terra Luna collapse, March 2023 Silicon Valley Bank crisis\nData Frequency: Hourly pricing data to capture intraday de-pegging\n\n\n\nFed Policy Announcements\n\nSource: Federal Reserve Economic Data (FRED) & Fed Meeting Calendar\nDescription: FOMC meeting dates, interest rate decisions, and policy statement releases\nEvent Types: Rate decisions, forward guidance changes, emergency meetings\nFrequency: 8 scheduled meetings per year plus emergency meetings\nData Structure: Event dates with binary indicators for rate changes, QE announcements\n\n\n\nMajor Crypto Crashes\n\nSources: News archives, exchange data, academic event studies\nDescription: Timeline of major cryptocurrency market events and crashes\nKey Events:\n\nMarch 2020: COVID-19 market crash\nMay 2021: China mining ban announcement\n\nNovember 2022: FTX exchange collapse\nMarch 2023: Banking sector stress (SVB, Credit Suisse)\n\nData Construction: Event dates with market impact measurement windows\nImpact Metrics: 24-hour, 7-day, and 30-day return impacts across asset classes"
  },
  {
    "objectID": "financial-ts-models.html",
    "href": "financial-ts-models.html",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "",
    "text": "Code\nsuppressPackageStartupMessages({\nlibrary(tidyverse)\nlibrary(forecast)\nlibrary(tseries)\nlibrary(FinTS)\nlibrary(rugarch)\nlibrary(gridExtra)\n})\n\nsuppressPackageStartupMessages({\n  library(quantmod); library(zoo); library(xts)\n  library(tidyverse); library(forecast); library(tseries)\n})\n\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\nload_fred_data &lt;- function(symbol, start, end) {\n  tryCatch(\n    getSymbols(symbol, src=\"FRED\", from=start, to=end, auto.assign=FALSE, quiet = TRUE),\n    error = function(e) {\n      cat(\"FAILED to load:\", symbol, \"\\nUsing fallback dummy series...\\n\")\n      xts(rep(1, 1000), order.by=seq(start, length.out=1000, by=\"days\"))\n    }\n  )\n}\n\nsp500_data &lt;- load_fred_data(\"SP500\",    start_date, end_date)\nvix_data   &lt;- load_fred_data(\"VIXCLS\",   start_date, end_date)\nbtc_data   &lt;- load_fred_data(\"CBBTCUSD\", start_date, end_date)\n\nmerged &lt;- merge(SP500 = sp500_data, VIX = vix_data, Bitcoin = btc_data)\nprice_data &lt;- fortify.zoo(merged)\ncolnames(price_data) &lt;- c(\"Date\",\"SP500\",\"VIX\",\"Bitcoin\")\nprice_data &lt;- price_data |&gt; arrange(Date) |&gt; na.omit()\n\nreturns &lt;- price_data |&gt;\n  mutate(\n    SP500_ret   = c(NA, diff(log(SP500))),\n    VIX_ret     = c(NA, diff(log(VIX))),\n    Bitcoin_ret = c(NA, diff(log(Bitcoin)))\n  ) |&gt;\n  na.omit()\n\ncat(\"Loaded:\", nrow(returns), \"returns\\n\")\n\n\nLoaded: 1686 returns\nCode\n#| warning: false\n\n\n\n# S&P 500 returns\n\nspx_ret   &lt;- as.numeric(returns$SP500_ret)\nspx_dates &lt;- returns$Date\n\n# Bitcoin returns\n\nbtc_ret   &lt;- as.numeric(returns$Bitcoin_ret)\nbtc_dates &lt;- returns$Date\n\ncat(sprintf(\"Length of SPX returns: %d observations\\n\", length(spx_ret)))\n\n\nLength of SPX returns: 1686 observations\n\n\nCode\ncat(sprintf(\"Length of BTC returns: %d observations\\n\", length(btc_ret)))\n\n\nLength of BTC returns: 1686 observations"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Time Series Analysis",
    "section": "",
    "text": "A time series is any sequence of measurements taken at regular, equally spaced intervals—seconds, minutes, hours, days, months, quarters, or years. Common examples include weather (daily temperature or rainfall), financial markets (daily stock prices or returns), industry indicators (monthly production or sales), electricity demand, traffic counts, and hospital admissions. In time-series analysis we study how these values evolve: their level, trend, seasonal or calendar patterns (e.g., weekdays vs. weekends, holiday effects), cycles, and anomalies. Typical goals are to describe behavior clearly, forecast future values, and quantify the impact of events or policies.\nBecause observations are ordered in time, nearby points tend to be correlated (autocorrelation). This violates the independent-and-identically-distributed assumption behind many standard statistical methods, so naïve cross-sectional tools often mislead. Time-series work must explicitly handle dependence, trend, and seasonality—for example by differencing, seasonal adjustment, and models that use lagged values and errors (e.g., ARIMA/SARIMA, ARIMAX/SARIMAX with external drivers, VAR for multiple series, state-space/ETS, or GARCH when volatility changes over time). Analysts also watch for structural breaks (e.g., policy shifts, COVID), outliers, and missing periods, and they evaluate models with time-aware validation (rolling or blocked splits) rather than random shuffles."
  },
  {
    "objectID": "index.html#what-is-a-time-series",
    "href": "index.html#what-is-a-time-series",
    "title": "Time Series Analysis",
    "section": "",
    "text": "A time series is any sequence of measurements taken at regular, equally spaced intervals—seconds, minutes, hours, days, months, quarters, or years. Common examples include weather (daily temperature or rainfall), financial markets (daily stock prices or returns), industry indicators (monthly production or sales), electricity demand, traffic counts, and hospital admissions. In time-series analysis we study how these values evolve: their level, trend, seasonal or calendar patterns (e.g., weekdays vs. weekends, holiday effects), cycles, and anomalies. Typical goals are to describe behavior clearly, forecast future values, and quantify the impact of events or policies.\nBecause observations are ordered in time, nearby points tend to be correlated (autocorrelation). This violates the independent-and-identically-distributed assumption behind many standard statistical methods, so naïve cross-sectional tools often mislead. Time-series work must explicitly handle dependence, trend, and seasonality—for example by differencing, seasonal adjustment, and models that use lagged values and errors (e.g., ARIMA/SARIMA, ARIMAX/SARIMAX with external drivers, VAR for multiple series, state-space/ETS, or GARCH when volatility changes over time). Analysts also watch for structural breaks (e.g., policy shifts, COVID), outliers, and missing periods, and they evaluate models with time-aware validation (rolling or blocked splits) rather than random shuffles."
  },
  {
    "objectID": "index.html#project-idea-volatility-spillovers-across-asset-classes",
    "href": "index.html#project-idea-volatility-spillovers-across-asset-classes",
    "title": "Time Series Analysis",
    "section": "Project Idea: Volatility Spillovers Across Asset Classes",
    "text": "Project Idea: Volatility Spillovers Across Asset Classes\nCrypto → Equity Spillovers\nOutcomes: Daily return volatility of Bitcoin, Ethereum, altcoin index, and S&P 500.\nCovariates: Trading volume, Fed policy announcements, macro uncertainty indices.\nModels: VAR-based Diebold–Yilmaz connectedness index; Interrupted Time Series (ITS) around shocks like FTX collapse or major Fed hikes.\nCrypto → Commodities (Digital Gold Hypothesis)\nOutcomes: BTC–Gold return correlations, BTC–Oil volatility interactions.\nCovariates: Inflation announcements, commodity price shocks, geopolitical events.\nModels: DCC-GARCH to track time-varying correlations; BEKK-GARCH for volatility transmission direction.\nCrypto → Volatility Index (Fear Gauge)\nOutcomes: Spillovers between Bitcoin volatility and the VIX index (equity “fear gauge”).\nCovariates: S&P 500 returns, macro policy shocks, crypto-specific crashes.\nModels: Threshold-GARCH to capture nonlinear effects; VAR event studies around high-volatility windows.\nFrequency Decomposition of Spillovers\nOutcomes: Short-run vs. long-run volatility spillovers across BTC, ETH, S&P500, Gold, and VIX.\nCovariates: Same core series, separated into frequency bands.\nModels: Baruník–Křehlík frequency connectedness to show whether crypto influence is trader-driven (short-term) or macro-driven (long-term).\nTime-Varying Connectedness\nOutcomes: Net transmitter vs. net receiver roles of BTC and ETH during calm vs. crisis periods (COVID crash, Terra/FTX collapse, banking stress).\nCovariates: Event dummies for stress regimes.\nModels: TVP-VAR connectedness (time-varying without rolling windows); structural break tests.\nStablecoins and Market Stability\nOutcomes: USDT/USDC de-pegging episodes, before/after volatility in broader crypto markets.\nCovariates: Stablecoin volume, liquidity shocks, macro stress events.\nModels: Interrupted Time Series around de-peg dates; ARIMAX with stablecoin activity as an exogenous regressor.\nResearch Papers\nDiebold & Yilmaz (2012): Better to Give than to Receive: Predictive Directional Measurement of Volatility Spillovers — foundational connectedness index.\nEngle (2002): Dynamic Conditional Correlation: A Simple Class of Multivariate GARCH Models — for evolving correlations.\nEngle & Kroner (1995): Multivariate Simultaneous GARCH — BEKK parameterization for volatility spillovers.\nBaruník & Křehlík (2018): Measuring the Frequency Dynamics of Financial Connectedness — short-run vs long-run spillover methods.\nAntonakakis & Gabauer (2017, 2018): Time-Varying Parameter VAR-based Connectedness Measures — dynamic connectedness without rolling windows.\nRecent empirical studies show that crypto shocks spill into equities, commodities, bonds, and volatility indices, especially during stress periods (COVID, 2022 crashes, Fed rate hikes)."
  },
  {
    "objectID": "univariate-ts-models.html",
    "href": "univariate-ts-models.html",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "",
    "text": "Code\ncat(\"Loading financial data...\\n\")\n\n\nLoading financial data...\n\n\nCode\nlibrary(quantmod)\nlibrary(tidyverse)\nlibrary(zoo)\nlibrary(forecast)\nlibrary(tseries)\n\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\n# Safe loader\n\nload_fred_data &lt;- function(symbol) {\ntryCatch(\ngetSymbols(symbol, src = \"FRED\", from = start_date, to = end_date,\nauto.assign = FALSE),\nerror = function(e) { cat(\"FAILED:\", symbol, \"\\n\"); NULL }\n)\n}\n\n# Load assets\n\nsp500_data  &lt;- load_fred_data(\"SP500\")\nvix_data    &lt;- load_fred_data(\"VIXCLS\")\nbtc_data    &lt;- load_fred_data(\"CBBTCUSD\")\nnasdaq_data &lt;- load_fred_data(\"NASDAQCOM\")\nusd_data    &lt;- load_fred_data(\"DTWEXBGS\")\n\n# Merge only valid\n\nmerge_list &lt;- list(\nSP500   = sp500_data,\nVIX     = vix_data,\nBitcoin = btc_data,\nNASDAQ  = nasdaq_data,\nUSD     = usd_data\n)\nmerge_list &lt;- merge_list[!sapply(merge_list, is.null)]\n\ncat(\"Loaded:\", names(merge_list), \"\\n\")\n\n\nLoaded: SP500 VIX Bitcoin NASDAQ USD \n\n\nCode\n# Merge to zoo\n\nprice_zoo &lt;- do.call(merge.zoo, merge_list)\n\n# To dataframe\n\nprice_data &lt;- fortify.zoo(price_zoo)\ncolnames(price_data) &lt;- c(\"Date\", names(merge_list))\nprice_data &lt;- price_data |&gt; na.omit()\n\ncat(nrow(price_data), \"rows loaded.\\n\")\n\n\n1668 rows loaded.\n\n\nCode\n# Differenced data function\n\nget_series &lt;- function(asset) price_data[[asset]]\n\nget_diff_series &lt;- function(asset) {\ndiff(log(price_data[[asset]])) |&gt; na.omit()\n}\nCode\ncat(\"Fitting ARIMA + SARIMA models ONCE per asset...\\n\")\n\n\nFitting ARIMA + SARIMA models ONCE per asset...\n\n\nCode\nassets &lt;- names(merge_list)\n\narima_models &lt;- list()\nsarima_models &lt;- list()\n\nfor (a in assets) {\nseries &lt;- get_diff_series(a)\ncat(\"  Fitting ARIMA for\", a, \"\\n\")\narima_models[[a]] &lt;- auto.arima(series, stepwise=TRUE, approximation=TRUE)\n\ncat(\"  Fitting SARIMA for\", a, \"\\n\")\nsarima_models[[a]] &lt;- auto.arima(series, seasonal=TRUE,\nstepwise=TRUE, approximation=TRUE)\n}\n\n\n  Fitting ARIMA for SP500 \n  Fitting SARIMA for SP500 \n  Fitting ARIMA for VIX \n  Fitting SARIMA for VIX \n  Fitting ARIMA for Bitcoin \n  Fitting SARIMA for Bitcoin \n  Fitting ARIMA for NASDAQ \n  Fitting SARIMA for NASDAQ \n  Fitting ARIMA for USD \n  Fitting SARIMA for USD \n\n\nCode\ncat(\"Model fitting complete.\\n\")\n\n\nModel fitting complete."
  },
  {
    "objectID": "multivariate-ts-models.html",
    "href": "multivariate-ts-models.html",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "In this analysis, we investigate the relationships between cryptocurrency markets (Bitcoin), traditional equity markets (S&P 500), market volatility (VIX), and macroeconomic indicators (CPI). Understanding these relationships is crucial for portfolio diversification, risk management, and forecasting in modern financial markets."
  },
  {
    "objectID": "multivariate-ts-models.html#introduction",
    "href": "multivariate-ts-models.html#introduction",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "In this analysis, we investigate the relationships between cryptocurrency markets (Bitcoin), traditional equity markets (S&P 500), market volatility (VIX), and macroeconomic indicators (CPI). Understanding these relationships is crucial for portfolio diversification, risk management, and forecasting in modern financial markets."
  },
  {
    "objectID": "multivariate-ts-models.html#literature-review",
    "href": "multivariate-ts-models.html#literature-review",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "Literature Review",
    "text": "Literature Review\n\nBackground and Variable Selection\nFinancial markets exhibit complex interdependencies that have evolved significantly with the emergence of cryptocurrency markets. According to Nakamoto (2008) and subsequent cryptocurrency research, Bitcoin was designed as a decentralized alternative to traditional fiat currencies. However, empirical studies by Baur & Dimpfl (2018) show that Bitcoin increasingly behaves like a traditional financial asset, responding to macroeconomic and market conditions.\nThe S&P 500 serves as a broad measure of U.S. equity market performance and overall economic health. Research by Corbet et al. (2018) demonstrates significant spillover effects between traditional equity markets and cryptocurrency markets, particularly during periods of market stress. During the COVID-19 pandemic, both Bitcoin and the S&P 500 experienced simultaneous crashes, suggesting increasing correlation.\nThe VIX (CBOE Volatility Index), often called the “fear gauge,” measures expected market volatility. Studies by Whaley (2009) establish the VIX as a leading indicator of market sentiment. Recent research by Smales (2019) shows that Bitcoin exhibits increased correlation with traditional markets during high-volatility periods, suggesting that market fear affects all asset classes. The inverse relationship between VIX and S&P 500 is well-documented, with VIX typically rising when stock prices fall.\nThe U.S. Dollar Index (USD) summarizes the value of the U.S. dollar against a basket of major currencies. Dollar strength is linked to global risk sentiment and capital flows. A stronger dollar is often associated with tighter global financial conditions and may put pressure on risky assets such as equities and cryptocurrencies.\nVariable Justification:\nBased on this literature, I focus on the following relationships:\n\nBitcoin returns may be influenced by traditional market performance (SP500) and market volatility/fear (VIX).\nSP500 and VIX have a well-documented inverse relationship—when stocks fall, fear rises.\nDollar strength (USD) may be related to risk sentiment and interact with equity and crypto markets.\nThese variables likely exhibit dynamic and possibly bidirectional relationships, motivating multivariate time series models."
  },
  {
    "objectID": "multivariate-ts-models.html#key-research-questions",
    "href": "multivariate-ts-models.html#key-research-questions",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "Key Research Questions",
    "text": "Key Research Questions\n\nHow does market fear (VIX) affect Bitcoin and S&P 500 returns?\nWhat is the relationship between traditional markets (S&P 500) and cryptocurrency markets (Bitcoin)?\nDoes including multiple series (Bitcoin, SP500, VIX, USD) in multivariate models improve forecasting compared to univariate ARIMA?\nDo these variables exhibit bidirectional causality (VAR) or mainly unidirectional effects (ARIMAX)?"
  },
  {
    "objectID": "multivariate-ts-models.html#proposed-models",
    "href": "multivariate-ts-models.html#proposed-models",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "Proposed Models",
    "text": "Proposed Models\nBased on the literature and data availability, I estimate the following models:\nModel 1 (ARIMAX): Bitcoin_ret ~ SP500_ret + VIX_ret\n- Rationale: Test whether Bitcoin returns are driven by traditional market performance and market fear.\nModel 2 (ARIMAX): SP500_ret ~ Bitcoin_ret + VIX_ret\n- Rationale: Examine how cryptocurrency returns and volatility interact with equity returns.\nModel 3 (ARIMAX): VIX_ret ~ Bitcoin_ret + SP500_ret\n- Rationale: Test whether movements in equities and Bitcoin help explain changes in implied volatility.\nModel 4 (ARIMAX): USD_ret ~ Bitcoin_ret + SP500_ret\n- Rationale: Explore how equity and crypto markets relate to changes in the broad U.S. dollar index.\nModel 5 (VAR): [Bitcoin_ret, SP500_ret, VIX_ret]\n- Rationale: Capture bidirectional relationships and dynamic interactions among cryptocurrency, equities, and volatility.\nFor this homework, I focus primarily on the ARIMAX models (Models 1–4) and a VAR model including Bitcoin, SP500, and VIX.\n\n\n\nCode\nsuppressPackageStartupMessages({\nlibrary(quantmod); library(zoo); library(xts)\nlibrary(tidyverse); library(forecast); library(tseries)\nlibrary(ggplot2)\n})\n\n\n\n\nCode\ncat(\"Loading financial data (BTC, SP500, VIX, USD) from FRED...\\n\")\n\n\nLoading financial data (BTC, SP500, VIX, USD) from FRED...\n\n\nCode\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\n# helper (safe) loader\n\nload_fred_data &lt;- function(symbol, start, end) {\ntryCatch({\ngetSymbols(symbol, src = \"FRED\", from = start, to = end, auto.assign = FALSE)\n}, error = function(e) {\ncat(sprintf(\"Warning: Could not load %s (%s)\\n\", symbol, e$message))\nNULL\n})\n}\n\n# Load and merge only if needed\n\nif (!exists(\"price_data\") ||\n!all(c(\"Date\",\"SP500\",\"VIX\",\"Bitcoin\",\"USD\") %in% names(price_data))) {\n\nsp500_data &lt;- load_fred_data(\"SP500\",    start_date, end_date)\nvix_data   &lt;- load_fred_data(\"VIXCLS\",   start_date, end_date)\nbtc_data   &lt;- load_fred_data(\"CBBTCUSD\", start_date, end_date)\nusd_data   &lt;- load_fred_data(\"DTWEXBGS\", start_date, end_date)  # NEW: USD\n\nmerged &lt;- merge(\nSP500   = sp500_data,\nVIX     = vix_data,\nBitcoin = btc_data,\nUSD     = usd_data\n)\n\nprice_data &lt;- fortify.zoo(merged)\ncolnames(price_data) &lt;- c(\"Date\",\"SP500\",\"VIX\",\"Bitcoin\",\"USD\")\nprice_data &lt;- price_data |&gt; arrange(Date) |&gt; na.omit()\n}\n\ncat(sprintf(\"Data loaded: %d rows | columns: %s\\n\",\nnrow(price_data), paste(colnames(price_data), collapse=\", \")))\n\n\nData loaded: 1668 rows | columns: Date, SP500, VIX, Bitcoin, USD\n\n\nCode\n# Daily log-returns (stationary)\n\nreturns &lt;- price_data |&gt;\nmutate(\nSP500_ret   = c(NA, diff(log(SP500))),\nVIX_ret     = c(NA, diff(log(VIX))),\nBitcoin_ret = c(NA, diff(log(Bitcoin))),\nUSD_ret     = c(NA, diff(log(USD)))  # NEW: USD returns\n) |&gt;\nna.omit()\n\ncat(sprintf(\"Returns ready: %d rows (Bitcoin_ret, SP500_ret, VIX_ret, USD_ret)\\n\",\nnrow(returns)))\n\n\nReturns ready: 1667 rows (Bitcoin_ret, SP500_ret, VIX_ret, USD_ret)"
  },
  {
    "objectID": "multivariate-ts-models.html#bitcoin",
    "href": "multivariate-ts-models.html#bitcoin",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "Bitcoin",
    "text": "Bitcoin\n\nVisualizationVariable SelectionInitial SelectionCross ValidationModel CreationForecasting\n\n\n\n\nCode\np1 &lt;- ggplot(price_data, aes(Date, Bitcoin)) +\ngeom_line() + theme_minimal() + labs(title=\"Bitcoin (Level)\", x=NULL, y=NULL)\np2 &lt;- ggplot(returns, aes(Date, Bitcoin_ret)) +\ngeom_line() + theme_minimal() + labs(title=\"Bitcoin (Log-Returns)\", x=NULL, y=NULL)\ngridExtra::grid.arrange(p1, p2, nrow=2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Quick sanity checks for using SP500_ret & VIX_ret as xreg\n\ncm &lt;- cor(returns[, c(\"Bitcoin_ret\",\"SP500_ret\",\"VIX_ret\")], use=\"complete.obs\")\nprint(round(cm, 3))\n\n\n            Bitcoin_ret SP500_ret VIX_ret\nBitcoin_ret       1.000     0.283  -0.221\nSP500_ret         0.283     1.000  -0.728\nVIX_ret          -0.221    -0.728   1.000\n\n\nCode\n# Stationarity (ADF) on returns\n\nadf_btc &lt;- adf.test(returns$Bitcoin_ret)\nadf_spx &lt;- adf.test(returns$SP500_ret)\nadf_vix &lt;- adf.test(returns$VIX_ret)\ncat(sprintf(\"ADF p-values → BTC: %.4f | SPX: %.4f | VIX: %.4f\\n\",\nadf_btc$p.value, adf_spx$p.value, adf_vix$p.value))\n\n\nADF p-values → BTC: 0.0100 | SPX: 0.0100 | VIX: 0.0100\n\n\n\n\n\n\nCode\n# Assemble y and scaled xreg\n\ny   &lt;- as.numeric(returns$Bitcoin_ret)\nX   &lt;- as.matrix(returns[, c(\"SP500_ret\",\"VIX_ret\")])\nXS  &lt;- scale(X)  # keep attributes for future scaling\n\n# Method 1 — Auto.ARIMA with xreg\n\nm_btc_auto &lt;- forecast::auto.arima(y, xreg = XS, seasonal = FALSE)\ncat(\"AUTO.ARIMA with xreg summary:\\n\"); print(summary(m_btc_auto))\n\n\nAUTO.ARIMA with xreg summary:\n\n\nSeries: y \nRegression with ARIMA(0,0,1) errors \n\nCoefficients:\n          ma1  intercept  SP500_ret  VIX_ret\n      -0.0509      2e-03     0.0106  -0.0014\ns.e.   0.0239      9e-04     0.0014   0.0014\n\nsigma^2 = 0.001532:  log likelihood = 3038.74\nAIC=-6067.48   AICc=-6067.44   BIC=-6040.38\n\nTraining set error measures:\n                        ME       RMSE        MAE      MPE     MAPE      MASE\nTraining set -2.889967e-07 0.03909278 0.02628258 84.64458 181.4527 0.6305882\n                     ACF1\nTraining set -0.001210254\n\n\nCode\n# Method 2 — Manual: OLS then ARIMA on residuals, finally ARIMAX with that order\n\nols &lt;- lm(y ~ XS)\nres &lt;- resid(ols)\nres_arima &lt;- forecast::auto.arima(res, seasonal = FALSE)\nord &lt;- arimaorder(res_arima)\nm_btc_manual &lt;- Arima(y, order = ord, xreg = XS, include.mean = TRUE)\ncat(\"\\nMANUAL ARIMAX summary:\\n\"); print(summary(m_btc_manual))\n\n\n\nMANUAL ARIMAX summary:\n\n\nSeries: y \nRegression with ARIMA(0,0,1) errors \n\nCoefficients:\n          ma1  intercept  SP500_ret  VIX_ret\n      -0.0509      2e-03     0.0106  -0.0014\ns.e.   0.0239      9e-04     0.0014   0.0014\n\nsigma^2 = 0.001532:  log likelihood = 3038.74\nAIC=-6067.48   AICc=-6067.44   BIC=-6040.38\n\nTraining set error measures:\n                        ME       RMSE        MAE      MPE     MAPE      MASE\nTraining set -2.889967e-07 0.03909278 0.02628258 84.64458 181.4527 0.6305882\n                     ACF1\nTraining set -0.001210254\n\n\n\n\n\n\nCode\nH &lt;- 20           # horizon\nK &lt;- 10           # folds\nn &lt;- length(y)\nrmse_auto &lt;- c(); rmse_manual &lt;- c()\n\nfor (i in 1:K) {\ntr_end &lt;- n - H*(K - i + 1)\nif (tr_end &lt; 250) break\n\ny_tr &lt;- y[1:tr_end]\ny_te &lt;- y[(tr_end+1):(tr_end+H)]\nX_tr &lt;- XS[1:tr_end, , drop=FALSE]\nX_te &lt;- XS[(tr_end+1):(tr_end+H), , drop=FALSE]\n\n# auto\n\nfit_a &lt;- try(auto.arima(y_tr, xreg = X_tr, seasonal = FALSE), silent=TRUE)\nif (!inherits(fit_a, \"try-error\")) {\nfc_a &lt;- forecast(fit_a, xreg = X_te, h = H)\nrmse_auto &lt;- c(rmse_auto, sqrt(mean((y_te - as.numeric(fc_a$mean))^2)))\n}\n\n# manual (use the order we found above)\n\nfit_m &lt;- try(Arima(y_tr, order = ord, xreg = X_tr, include.mean = TRUE), silent=TRUE)\nif (!inherits(fit_m, \"try-error\")) {\nfc_m &lt;- forecast(fit_m, xreg = X_te, h = H)\nrmse_manual &lt;- c(rmse_manual, sqrt(mean((y_te - as.numeric(fc_m$mean))^2)))\n}\n}\n\ncv_df &lt;- tibble(\nFold = 1:max(length(rmse_auto), length(rmse_manual)),\nAuto  = rmse_auto,\nManual= rmse_manual\n) |&gt; pivot_longer(-Fold, names_to=\"Model\", values_to=\"RMSE\")\n\nggplot(na.omit(cv_df), aes(Fold, RMSE, color=Model)) +\ngeom_line() + geom_point(size=2) + theme_minimal() +\nlabs(title=\"BTC ARIMAX — Rolling CV RMSE\", x=\"Fold\", y=\"RMSE\")\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Mean RMSE → Auto: %.5f | Manual: %.5f\\n\",\nmean(rmse_auto, na.rm=TRUE), mean(rmse_manual, na.rm=TRUE)))\n\n\nMean RMSE → Auto: 0.02625 | Manual: 0.02625\n\n\nCode\nbest_is_auto &lt;- mean(rmse_auto, na.rm=TRUE) &lt;= mean(rmse_manual, na.rm=TRUE)\ncat(sprintf(\"Chosen by CV: %s\\n\", ifelse(best_is_auto, \"AUTO.ARIMA\", \"MANUAL ARIMAX\")))\n\n\nChosen by CV: AUTO.ARIMA\n\n\n\n\n\n\nCode\nbest_model &lt;- if (best_is_auto) m_btc_auto else m_btc_manual\ncat(\"Final chosen model summary:\\n\"); print(summary(best_model))\n\n\nFinal chosen model summary:\n\n\nSeries: y \nRegression with ARIMA(0,0,1) errors \n\nCoefficients:\n          ma1  intercept  SP500_ret  VIX_ret\n      -0.0509      2e-03     0.0106  -0.0014\ns.e.   0.0239      9e-04     0.0014   0.0014\n\nsigma^2 = 0.001532:  log likelihood = 3038.74\nAIC=-6067.48   AICc=-6067.44   BIC=-6040.38\n\nTraining set error measures:\n                        ME       RMSE        MAE      MPE     MAPE      MASE\nTraining set -2.889967e-07 0.03909278 0.02628258 84.64458 181.4527 0.6305882\n                     ACF1\nTraining set -0.001210254\n\n\nCode\n# Diagnostics\n\nresid_b &lt;- residuals(best_model)\npar(mfrow=c(1,2))\nplot(resid_b, type=\"l\", main=\"Residuals\", ylab=NULL); abline(h=0, lty=2); grid()\nacf(resid_b, main=\"Residual ACF\"); grid()\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\nlb &lt;- Box.test(resid_b, lag = 20, type = \"Ljung-Box\")\ncat(sprintf(\"Ljung-Box p (lag=20): %.4f\\n\", lb$p.value))\n\n\nLjung-Box p (lag=20): 0.2697\n\n\nCode\n# Equation print (regression part only)\n\nco &lt;- coef(best_model)\nb_spx &lt;- co[grep(\"SP500_ret\", names(co))]\nb_vix &lt;- co[grep(\"VIX_ret\", names(co))]\ncat(\"\\nRegression portion (on standardized xreg):\\n\")\n\n\n\nRegression portion (on standardized xreg):\n\n\nCode\ncat(sprintf(\"BTC_ret_t = %.4f·SP500_ret_std_t %+ .4f·VIX_ret_std_t + ARMA errors\\n\",\nifelse(length(b_spx)==0, 0, b_spx),\nifelse(length(b_vix)==0, 0, b_vix)))\n\n\nBTC_ret_t = 0.0106·SP500_ret_std_t -0.0014·VIX_ret_std_t + ARMA errors\n\n\n\n\n\n\nCode\nH &lt;- 30\n\n# Forecast exogenous returns first\n\nspx_fc &lt;- forecast::forecast(auto.arima(returns$SP500_ret), h = H)$mean\nvix_fc &lt;- forecast::forecast(auto.arima(returns$VIX_ret),   h = H)$mean\nXfut   &lt;- cbind(SP500_ret = as.numeric(spx_fc), VIX_ret = as.numeric(vix_fc))\n\n# scale with training attributes from XS\n\nXfutS &lt;- scale(Xfut,\ncenter = attr(scale(as.matrix(returns[,c(\"SP500_ret\",\"VIX_ret\")])), \"scaled:center\"),\nscale  = attr(scale(as.matrix(returns[,c(\"SP500_ret\",\"VIX_ret\")])), \"scaled:scale\"))\n\nbtc_ret_fc &lt;- forecast(best_model, xreg = XfutS, h = H)\n\nplot(btc_ret_fc, main=\"BTC Return Forecast — chosen ARIMAX\"); grid()\n\n\n\n\n\n\n\n\n\nCode\n# Convert return forecast to a *price level* path (for intuition)\n\nlast_lvl &lt;- tail(price_data$Bitcoin, 1)\nlvl_path &lt;- last_lvl * exp(cumsum(as.numeric(btc_ret_fc$mean)))\n\n# quick level-path plot\n\nop &lt;- par(mar=c(4,4,3,1))\nplot(lvl_path, type=\"l\", xlab=\"Forecast Step\", ylab=\"BTC Level (approx.)\",\nmain=\"BTC Level Path (from return forecasts)\")\ngrid()\n\n\n\n\n\n\n\n\n\nCode\npar(op)\n\ncat(sprintf(\"Last observed BTC level: %.2f\\n\", last_lvl))\n\n\nLast observed BTC level: 115690.55\n\n\nCode\ncat(sprintf(\"Forecasted BTC level at step %d: %.2f\\n\", H, tail(lvl_path,1)))\n\n\nForecasted BTC level at step 30: 122879.60"
  },
  {
    "objectID": "multivariate-ts-models.html#sp-500",
    "href": "multivariate-ts-models.html#sp-500",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "S&P 500",
    "text": "S&P 500\n\nVisualizationVariable SelectionInitial SelectionCross ValidationModel CreationForecasting\n\n\n\n\nCode\np1 &lt;- ggplot(price_data, aes(Date, SP500)) +\ngeom_line() + theme_minimal() + labs(title=\"S&P 500 (Level)\", x=NULL, y=NULL)\np2 &lt;- ggplot(returns, aes(Date, SP500_ret)) +\ngeom_line() + theme_minimal() + labs(title=\"S&P 500 (Log-Returns)\", x=NULL, y=NULL)\ngridExtra::grid.arrange(p1, p2, nrow=2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncm_spx &lt;- cor(returns[, c(\"SP500_ret\",\"Bitcoin_ret\",\"VIX_ret\")], use=\"complete.obs\")\nprint(round(cm_spx, 3))\n\n\n            SP500_ret Bitcoin_ret VIX_ret\nSP500_ret       1.000       0.283  -0.728\nBitcoin_ret     0.283       1.000  -0.221\nVIX_ret        -0.728      -0.221   1.000\n\n\nCode\nadf_spx &lt;- tseries::adf.test(returns$SP500_ret)\nadf_btc &lt;- tseries::adf.test(returns$Bitcoin_ret)\nadf_vix &lt;- tseries::adf.test(returns$VIX_ret)\ncat(sprintf(\"ADF p-values → SPX: %.4f | BTC: %.4f | VIX: %.4f\\n\",\nadf_spx$p.value, adf_btc$p.value, adf_vix$p.value))\n\n\nADF p-values → SPX: 0.0100 | BTC: 0.0100 | VIX: 0.0100\n\n\n\n\n\n\nCode\ny2   &lt;- as.numeric(returns$SP500_ret)\nX2   &lt;- as.matrix(returns[, c(\"Bitcoin_ret\",\"VIX_ret\")])  # exog: BTC, VIX returns\nX2S  &lt;- scale(X2)\n\nm_spx_auto &lt;- forecast::auto.arima(y2, xreg = X2S, seasonal = FALSE)\ncat(\"AUTO.ARIMA (SPX) summary:\\n\"); print(summary(m_spx_auto))\n\n\nAUTO.ARIMA (SPX) summary:\n\n\nSeries: y2 \nRegression with ARIMA(2,0,2) errors \n\nCoefficients:\n          ar1      ar2     ma1     ma2  intercept  Bitcoin_ret  VIX_ret\n      -1.7159  -0.8621  1.5823  0.7008      6e-04       0.0014  -0.0087\ns.e.   0.0283   0.0255  0.0402  0.0356      2e-04       0.0002   0.0002\n\nsigma^2 = 6.801e-05:  log likelihood = 5636.05\nAIC=-11256.09   AICc=-11256   BIC=-11212.74\n\nTraining set error measures:\n                        ME        RMSE        MAE     MPE     MAPE     MASE\nTraining set -7.875776e-07 0.008229595 0.00538296 174.237 394.5584 0.439583\n                   ACF1\nTraining set 0.02334035\n\n\nCode\nols2 &lt;- lm(y2 ~ X2S)\nres2 &lt;- resid(ols2)\nres2_arima &lt;- forecast::auto.arima(res2, seasonal = FALSE)\nord2 &lt;- arimaorder(res2_arima)\nm_spx_manual &lt;- Arima(y2, order = ord2, xreg = X2S, include.mean = TRUE)\ncat(\"\\nMANUAL ARIMAX (SPX) summary:\\n\"); print(summary(m_spx_manual))\n\n\n\nMANUAL ARIMAX (SPX) summary:\n\n\nSeries: y2 \nRegression with ARIMA(2,0,2) errors \n\nCoefficients:\n          ar1      ar2     ma1     ma2  intercept  Bitcoin_ret  VIX_ret\n      -1.7159  -0.8621  1.5823  0.7008      6e-04       0.0014  -0.0087\ns.e.   0.0283   0.0255  0.0402  0.0356      2e-04       0.0002   0.0002\n\nsigma^2 = 6.801e-05:  log likelihood = 5636.05\nAIC=-11256.09   AICc=-11256   BIC=-11212.74\n\nTraining set error measures:\n                        ME        RMSE        MAE     MPE     MAPE     MASE\nTraining set -7.875776e-07 0.008229595 0.00538296 174.237 394.5584 0.439583\n                   ACF1\nTraining set 0.02334035\n\n\n\n\n\n\nCode\nH &lt;- 20; K &lt;- 10; n2 &lt;- length(y2)\nrmse_auto2 &lt;- c(); rmse_manual2 &lt;- c()\n\nfor (i in 1:K) {\ntr_end &lt;- n2 - H*(K - i + 1); if (tr_end &lt; 250) break\ny_tr &lt;- y2[1:tr_end]; y_te &lt;- y2[(tr_end+1):(tr_end+H)]\nX_tr &lt;- X2S[1:tr_end, , drop=FALSE]; X_te &lt;- X2S[(tr_end+1):(tr_end+H), , drop=FALSE]\nfa &lt;- try(auto.arima(y_tr, xreg = X_tr, seasonal = FALSE), silent=TRUE)\nif (!inherits(fa,\"try-error\")) {\nfc &lt;- forecast(fa, xreg = X_te, h = H)\nrmse_auto2 &lt;- c(rmse_auto2, sqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\nfm &lt;- try(Arima(y_tr, order=ord2, xreg=X_tr, include.mean=TRUE), silent=TRUE)\nif (!inherits(fm,\"try-error\")) {\nfc &lt;- forecast(fm, xreg = X_te, h = H)\nrmse_manual2 &lt;- c(rmse_manual2, sqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\n}\ncv_spx &lt;- tibble(Fold=1:max(length(rmse_auto2),length(rmse_manual2)),\nAuto=rmse_auto2, Manual=rmse_manual2) |&gt;\npivot_longer(-Fold, names_to=\"Model\", values_to=\"RMSE\")\nggplot(na.omit(cv_spx), aes(Fold, RMSE, color=Model)) +\ngeom_line() + geom_point(size=2) + theme_minimal() +\nlabs(title=\"SPX ARIMAX — Rolling CV RMSE\")\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Mean RMSE → Auto: %.5f | Manual: %.5f\\n\",\nmean(rmse_auto2, na.rm=TRUE), mean(rmse_manual2, na.rm=TRUE)))\n\n\nMean RMSE → Auto: 0.00574 | Manual: 0.00574\n\n\nCode\nbest_spx_is_auto &lt;- mean(rmse_auto2, na.rm=TRUE) &lt;= mean(rmse_manual2, na.rm=TRUE)\ncat(sprintf(\"Chosen by CV: %s\\n\", ifelse(best_spx_is_auto,\"AUTO.ARIMA\",\"MANUAL ARIMAX\")))\n\n\nChosen by CV: AUTO.ARIMA\n\n\n\n\n\n\nCode\nbest_spx &lt;- if (best_spx_is_auto) m_spx_auto else m_spx_manual\ncat(\"Final SPX model summary:\\n\"); print(summary(best_spx))\n\n\nFinal SPX model summary:\n\n\nSeries: y2 \nRegression with ARIMA(2,0,2) errors \n\nCoefficients:\n          ar1      ar2     ma1     ma2  intercept  Bitcoin_ret  VIX_ret\n      -1.7159  -0.8621  1.5823  0.7008      6e-04       0.0014  -0.0087\ns.e.   0.0283   0.0255  0.0402  0.0356      2e-04       0.0002   0.0002\n\nsigma^2 = 6.801e-05:  log likelihood = 5636.05\nAIC=-11256.09   AICc=-11256   BIC=-11212.74\n\nTraining set error measures:\n                        ME        RMSE        MAE     MPE     MAPE     MASE\nTraining set -7.875776e-07 0.008229595 0.00538296 174.237 394.5584 0.439583\n                   ACF1\nTraining set 0.02334035\n\n\nCode\nresid_spx &lt;- residuals(best_spx)\npar(mfrow=c(1,2))\nplot(resid_spx, type=\"l\", main=\"SPX Residuals\"); abline(h=0,lty=2); grid()\nacf(resid_spx, main=\"Residual ACF\"); grid()\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\nlb2 &lt;- Box.test(resid_spx, lag=20, type=\"Ljung-Box\")\ncat(sprintf(\"Ljung-Box p (lag=20): %.4f\\n\", lb2$p.value))\n\n\nLjung-Box p (lag=20): 0.0001\n\n\nCode\nco2 &lt;- coef(best_spx)\nb_btc &lt;- co2[grep(\"Bitcoin_ret\", names(co2))]\nb_vix &lt;- co2[grep(\"VIX_ret\", names(co2))]\ncat(\"\\nRegression portion (standardized xreg):\\n\")\n\n\n\nRegression portion (standardized xreg):\n\n\nCode\ncat(sprintf(\"SPX_ret_t = %.4f·BTC_ret_std_t %+ .4f·VIX_ret_std_t + ARMA errors\\n\",\nifelse(length(b_btc)==0,0,b_btc),\nifelse(length(b_vix)==0,0,b_vix)))\n\n\nSPX_ret_t = 0.0014·BTC_ret_std_t -0.0087·VIX_ret_std_t + ARMA errors\n\n\n\n\n\n\nCode\nH &lt;- 30\n\n# Forecast exogenous BTC & VIX returns\n\nbtc_fc2 &lt;- forecast::forecast(auto.arima(returns$Bitcoin_ret), h = H)$mean\nvix_fc2 &lt;- forecast::forecast(auto.arima(returns$VIX_ret),     h = H)$mean\nXfut2   &lt;- cbind(Bitcoin_ret = as.numeric(btc_fc2), VIX_ret = as.numeric(vix_fc2))\n\nXfut2S &lt;- scale(Xfut2,\ncenter = attr(scale(as.matrix(returns[,c(\"Bitcoin_ret\",\"VIX_ret\")])), \"scaled:center\"),\nscale  = attr(scale(as.matrix(returns[,c(\"Bitcoin_ret\",\"VIX_ret\")])), \"scaled:scale\"))\n\nspx_ret_fc &lt;- forecast(best_spx, xreg = Xfut2S, h = H)\nplot(spx_ret_fc, main=\"SPX Return Forecast — chosen ARIMAX\"); grid()\n\n\n\n\n\n\n\n\n\nCode\nlast_spx &lt;- tail(price_data$SP500,1)\nspx_level_path &lt;- last_spx * exp(cumsum(as.numeric(spx_ret_fc$mean)))\nplot(spx_level_path, type=\"l\", xlab=\"Forecast Step\", ylab=\"SPX Level (approx.)\",\nmain=\"SPX Level Path (from return forecasts)\"); grid()\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Last SPX level: %.2f | Forecasted level @%d: %.2f\\n\",\nlast_spx, H, tail(spx_level_path,1)))\n\n\nLast SPX level: 6631.96 | Forecasted level @30: 6694.15"
  },
  {
    "objectID": "multivariate-ts-models.html#vix",
    "href": "multivariate-ts-models.html#vix",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "VIX",
    "text": "VIX\n\nVisualizationVariable SelectionInitial selectionCross ValidationModel CreationForecasting\n\n\n\n\nCode\np1 &lt;- ggplot(price_data, aes(Date, VIX)) +\ngeom_line() + theme_minimal() + labs(title=\"VIX (Level)\", x=NULL, y=NULL)\np2 &lt;- ggplot(returns, aes(Date, VIX_ret)) +\ngeom_line() + theme_minimal() + labs(title=\"VIX (Log-Returns)\", x=NULL, y=NULL)\ngridExtra::grid.arrange(p1, p2, nrow=2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncm_vix &lt;- cor(returns[, c(\"VIX_ret\",\"Bitcoin_ret\",\"SP500_ret\")], use=\"complete.obs\")\nprint(round(cm_vix, 3))\n\n\n            VIX_ret Bitcoin_ret SP500_ret\nVIX_ret       1.000      -0.221    -0.728\nBitcoin_ret  -0.221       1.000     0.283\nSP500_ret    -0.728       0.283     1.000\n\n\nCode\nadf_vix &lt;- tseries::adf.test(returns$VIX_ret)\nadf_btc &lt;- tseries::adf.test(returns$Bitcoin_ret)\nadf_spx &lt;- tseries::adf.test(returns$SP500_ret)\ncat(sprintf(\"ADF p-values → VIX: %.4f | BTC: %.4f | SPX: %.4f\\n\",\nadf_vix$p.value, adf_btc$p.value, adf_spx$p.value))\n\n\nADF p-values → VIX: 0.0100 | BTC: 0.0100 | SPX: 0.0100\n\n\n\n\n\n\nCode\ny3   &lt;- as.numeric(returns$VIX_ret)\nX3   &lt;- as.matrix(returns[, c(\"Bitcoin_ret\",\"SP500_ret\")])  # exog: BTC, SPX returns\nX3S  &lt;- scale(X3)\n\nm_vix_auto &lt;- forecast::auto.arima(y3, xreg = X3S, seasonal = FALSE)\ncat(\"AUTO.ARIMA (VIX) summary:\\n\"); print(summary(m_vix_auto))\n\n\nAUTO.ARIMA (VIX) summary:\n\n\nSeries: y3 \nRegression with ARIMA(3,0,4) errors \n\nCoefficients:\n          ar1     ar2     ar3     ma1      ma2      ma3      ma4  Bitcoin_ret\n      -0.4140  0.5175  0.3446  0.2941  -0.5678  -0.3391  -0.1049      -0.0004\ns.e.   0.1754  0.0833  0.1464  0.1749   0.0892   0.1515   0.0353       0.0013\n      SP500_ret\n        -0.0587\ns.e.     0.0014\n\nsigma^2 = 0.002838:  log likelihood = 2527.27\nAIC=-5034.53   AICc=-5034.4   BIC=-4980.35\n\nTraining set error measures:\n                        ME       RMSE        MAE MPE MAPE      MASE\nTraining set -0.0004983514 0.05312771 0.03700709 NaN  Inf 0.4536262\n                     ACF1\nTraining set 0.0001232169\n\n\nCode\nols3 &lt;- lm(y3 ~ X3S)\nres3 &lt;- resid(ols3)\nres3_arima &lt;- forecast::auto.arima(res3, seasonal = FALSE)\nord3 &lt;- arimaorder(res3_arima)\nm_vix_manual &lt;- Arima(y3, order = ord3, xreg = X3S, include.mean = TRUE)\ncat(\"\\nMANUAL ARIMAX (VIX) summary:\\n\"); print(summary(m_vix_manual))\n\n\n\nMANUAL ARIMAX (VIX) summary:\n\n\nSeries: y3 \nRegression with ARIMA(3,0,4) errors \n\nCoefficients:\n          ar1     ar2     ar3     ma1      ma2      ma3      ma4  intercept\n      -0.4147  0.5179  0.3456  0.2947  -0.5685  -0.3401  -0.1048     -2e-04\ns.e.   0.1752  0.0832  0.1462  0.1748   0.0891   0.1513   0.0353      7e-04\n      Bitcoin_ret  SP500_ret\n          -0.0004    -0.0587\ns.e.       0.0013     0.0014\n\nsigma^2 = 0.002839:  log likelihood = 2527.34\nAIC=-5032.67   AICc=-5032.51   BIC=-4973.07\n\nTraining set error measures:\n                       ME       RMSE        MAE MPE MAPE      MASE         ACF1\nTraining set -1.34067e-05 0.05312549 0.03696717 NaN  Inf 0.4531368 0.0001913375\n\n\n\n\n\n\nCode\nH &lt;- 20; K &lt;- 10; n3 &lt;- length(y3)\nrmse_auto3 &lt;- c(); rmse_manual3 &lt;- c()\n\nfor (i in 1:K) {\ntr_end &lt;- n3 - H*(K - i + 1); if (tr_end &lt; 250) break\ny_tr &lt;- y3[1:tr_end]; y_te &lt;- y3[(tr_end+1):(tr_end+H)]\nX_tr &lt;- X3S[1:tr_end, , drop=FALSE]; X_te &lt;- X3S[(tr_end+1):(tr_end+H), , drop=FALSE]\nfa &lt;- try(auto.arima(y_tr, xreg = X_tr, seasonal = FALSE), silent=TRUE)\nif (!inherits(fa,\"try-error\")) {\nfc &lt;- forecast(fa, xreg = X_te, h = H)\nrmse_auto3 &lt;- c(rmse_auto3, sqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\nfm &lt;- try(Arima(y_tr, order=ord3, xreg=X_tr, include.mean=TRUE), silent=TRUE)\nif (!inherits(fm,\"try-error\")) {\nfc &lt;- forecast(fm, xreg = X_te, h = H)\nrmse_manual3 &lt;- c(rmse_manual3, sqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\n}\ncv_vix &lt;- tibble(Fold=1:max(length(rmse_auto3),length(rmse_manual3)),\nAuto=rmse_auto3, Manual=rmse_manual3) |&gt;\npivot_longer(-Fold, names_to=\"Model\", values_to=\"RMSE\")\nggplot(na.omit(cv_vix), aes(Fold, RMSE, color=Model)) +\ngeom_line() + geom_point(size=2) + theme_minimal() +\nlabs(title=\"VIX ARIMAX — Rolling CV RMSE\")\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Mean RMSE → Auto: %.5f | Manual: %.5f\\n\",\nmean(rmse_auto3, na.rm=TRUE), mean(rmse_manual3, na.rm=TRUE)))\n\n\nMean RMSE → Auto: 0.04964 | Manual: 0.04936\n\n\nCode\nbest_vix_is_auto &lt;- mean(rmse_auto3, na.rm=TRUE) &lt;= mean(rmse_manual3, na.rm=TRUE)\ncat(sprintf(\"Chosen by CV: %s\\n\", ifelse(best_vix_is_auto,\"AUTO.ARIMA\",\"MANUAL ARIMAX\")))\n\n\nChosen by CV: MANUAL ARIMAX\n\n\n\n\n\n\nCode\nbest_vix &lt;- if (best_vix_is_auto) m_vix_auto else m_vix_manual\ncat(\"Final VIX model summary:\\n\"); print(summary(best_vix))\n\n\nFinal VIX model summary:\n\n\nSeries: y3 \nRegression with ARIMA(3,0,4) errors \n\nCoefficients:\n          ar1     ar2     ar3     ma1      ma2      ma3      ma4  intercept\n      -0.4147  0.5179  0.3456  0.2947  -0.5685  -0.3401  -0.1048     -2e-04\ns.e.   0.1752  0.0832  0.1462  0.1748   0.0891   0.1513   0.0353      7e-04\n      Bitcoin_ret  SP500_ret\n          -0.0004    -0.0587\ns.e.       0.0013     0.0014\n\nsigma^2 = 0.002839:  log likelihood = 2527.34\nAIC=-5032.67   AICc=-5032.51   BIC=-4973.07\n\nTraining set error measures:\n                       ME       RMSE        MAE MPE MAPE      MASE         ACF1\nTraining set -1.34067e-05 0.05312549 0.03696717 NaN  Inf 0.4531368 0.0001913375\n\n\nCode\nresid_vix &lt;- residuals(best_vix)\npar(mfrow=c(1,2))\nplot(resid_vix, type=\"l\", main=\"VIX Residuals\"); abline(h=0,lty=2); grid()\nacf(resid_vix, main=\"Residual ACF\"); grid()\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\nlb3 &lt;- Box.test(resid_vix, lag=20, type=\"Ljung-Box\")\ncat(sprintf(\"Ljung-Box p (lag=20): %.4f\\n\", lb3$p.value))\n\n\nLjung-Box p (lag=20): 0.9899\n\n\nCode\nco3 &lt;- coef(best_vix)\nb_btc3 &lt;- co3[grep(\"Bitcoin_ret\", names(co3))]\nb_spx3 &lt;- co3[grep(\"SP500_ret\", names(co3))]\ncat(\"\\nRegression portion (standardized xreg):\\n\")\n\n\n\nRegression portion (standardized xreg):\n\n\nCode\ncat(sprintf(\"VIX_ret_t = %.4f·BTC_ret_std_t %+ .4f·SPX_ret_std_t + ARMA errors\\n\",\nifelse(length(b_btc3)==0,0,b_btc3),\nifelse(length(b_spx3)==0,0,b_spx3)))\n\n\nVIX_ret_t = -0.0004·BTC_ret_std_t -0.0587·SPX_ret_std_t + ARMA errors\n\n\n\n\n\n\nCode\nH &lt;- 30\n\n# Forecast exogenous BTC & SPX returns\n\nbtc_fc3 &lt;- forecast::forecast(auto.arima(returns$Bitcoin_ret), h = H)$mean\nspx_fc3 &lt;- forecast::forecast(auto.arima(returns$SP500_ret),  h = H)$mean\nXfut3   &lt;- cbind(Bitcoin_ret = as.numeric(btc_fc3), SP500_ret = as.numeric(spx_fc3))\n\nXfut3S &lt;- scale(Xfut3,\ncenter = attr(scale(as.matrix(returns[,c(\"Bitcoin_ret\",\"SP500_ret\")])), \"scaled:center\"),\nscale  = attr(scale(as.matrix(returns[,c(\"Bitcoin_ret\",\"SP500_ret\")])), \"scaled:scale\"))\n\nvix_ret_fc &lt;- forecast(best_vix, xreg = Xfut3S, h = H)\nplot(vix_ret_fc, main=\"VIX Return Forecast — chosen ARIMAX\"); grid()\n\n\n\n\n\n\n\n\n\nCode\nlast_vix &lt;- tail(price_data$VIX,1)\nvix_level_path &lt;- last_vix * exp(cumsum(as.numeric(vix_ret_fc$mean)))\nplot(vix_level_path, type=\"l\", xlab=\"Forecast Step\", ylab=\"VIX Level (approx.)\",\nmain=\"VIX Level Path (from return forecasts)\"); grid()\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Last VIX level: %.2f | Forecasted level @%d: %.2f\\n\",\nlast_vix, H, tail(vix_level_path,1)))\n\n\nLast VIX level: 15.70 | Forecasted level @30: 15.02"
  },
  {
    "objectID": "eda.html",
    "href": "eda.html",
    "title": "Exploratory Data Analysis",
    "section": "",
    "text": "============================================================ \n\n\nEXPLORATORY DATA ANALYSIS (EDA)\n\n\n============================================================\nCode\n#| warning: false\n#| message: false\n\ncat(\"Loading financial data...\\n\")\n\n\nLoading financial data...\n\n\nCode\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\nload_fred_data &lt;- function(symbol, start, end) {\n  tryCatch({\n    getSymbols(symbol, src = \"FRED\", from = start, to = end, auto.assign = FALSE)\n  }, error = function(e) { \n    cat(sprintf(\"Warning: Could not load %s\\n\", symbol)); \n    NULL \n  })\n}\n\n# ---- Load Core Data ----\nsp500_data   &lt;- load_fred_data(\"SP500\",       start_date, end_date)\nvix_data     &lt;- load_fred_data(\"VIXCLS\",      start_date, end_date)\nbtc_data     &lt;- load_fred_data(\"CBBTCUSD\",    start_date, end_date)\nnasdaq_data  &lt;- load_fred_data(\"NASDAQCOM\",   start_date, end_date)  \nusd_data     &lt;- load_fred_data(\"DTWEXBGS\",         start_date, end_date)   # USD Index (Broad Dollar Index)\n\n# ---- Merge All ----\nprice_data &lt;- merge.zoo(\n  SP500    = sp500_data,\n  VIX      = vix_data,\n  Bitcoin  = btc_data,\n  NASDAQ   = nasdaq_data,\n  USD      = usd_data\n)\n\nprice_data &lt;- fortify.zoo(price_data)\ncolnames(price_data) &lt;- c(\"Date\",\"SP500\",\"VIX\",\"Bitcoin\",\"NASDAQ\",\"USD\")\nprice_data &lt;- price_data |&gt; na.omit()\n\ncat(sprintf(\"Data loaded: %d observations, %d variables\\n\", \n            nrow(price_data), ncol(price_data)-1))\n\n\nData loaded: 1668 observations, 5 variables\n\n\nCode\n# ---- Returns ----\nreturns &lt;- price_data |&gt;\n  arrange(Date) |&gt;\n  mutate(\n    SP500_ret   = c(NA, diff(log(SP500))),\n    VIX_ret     = c(NA, diff(log(VIX))),\n    Bitcoin_ret = c(NA, diff(log(Bitcoin))),\n    NASDAQ_ret  = c(NA, diff(log(NASDAQ))),\n    USD_ret     = c(NA, diff(log(USD)))\n  ) |&gt;\n  na.omit()"
  },
  {
    "objectID": "eda.html#bitcoin",
    "href": "eda.html#bitcoin",
    "title": "Exploratory Data Analysis",
    "section": "Bitcoin",
    "text": "Bitcoin\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (Bitcoin):\\n\")\n\n\n\nComponent analysis (Bitcoin):\n\n\nCode\ncomponent_analysis_print(\"Bitcoin\")\n\n\n• Trend: Upward (slope: 51.1053)\n• Variation (CV): 0.778\n• Range: 3359.00 to 123365.63\n• Seasonality Type: Multiplicative (variance ratio: 9.41)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for Bitcoin:\n  MA-  5: Var↓   0.9% | Corr 0.999\n  MA- 20: Var↓   4.0% | Corr 0.998\n  MA- 60: Var↓  13.4% | Corr 0.993\n  MA-120: Var↓  26.5% | Corr 0.979\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"Bitcoin\")\n\n\nADF Statistic: -1.3901\np-value: 0.8365\nConclusion: NON-STATIONARY (fail to reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"Bitcoin\")\n\n\nStationarity tests for Bitcoin transformations:\n---------------------------------------- \n  original     | ADF:  -1.390 | p: 0.8365 | ✗ Non-stationary\n\n\n  first_diff   | ADF: -11.031 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -19.760 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -2.216 | p: 0.4869 | ✗ Non-stationary\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -10.968 | p: 0.0100 | ✓ STATIONARY"
  },
  {
    "objectID": "eda.html#sp-500",
    "href": "eda.html#sp-500",
    "title": "Exploratory Data Analysis",
    "section": "S&P 500",
    "text": "S&P 500\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"SP500\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (S&P 500):\\n\")\n\n\n\nComponent analysis (S&P 500):\n\n\nCode\ncomponent_analysis_print(\"SP500\")\n\n\n• Trend: Upward (slope: 1.9647)\n• Variation (CV): 0.241\n• Range: 2237.40 to 6631.96\n• Seasonality Type: Additive (variance ratio: 1.97)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"SP500\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for SP500:\n  MA-  5: Var↓   0.9% | Corr 1.000\n  MA- 20: Var↓   4.0% | Corr 0.998\n  MA- 60: Var↓  11.2% | Corr 0.994\n  MA-120: Var↓  19.6% | Corr 0.987\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"SP500\")\n\n\nADF Statistic: -1.9884\np-value: 0.5832\nConclusion: NON-STATIONARY (fail to reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"SP500\")\n\n\nStationarity tests for SP500 transformations:\n---------------------------------------- \n  original     | ADF:  -1.988 | p: 0.5832 | ✗ Non-stationary\n\n\n  first_diff   | ADF: -11.470 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -20.269 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -2.682 | p: 0.2896 | ✗ Non-stationary\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -11.102 | p: 0.0100 | ✓ STATIONARY"
  },
  {
    "objectID": "eda.html#vix",
    "href": "eda.html#vix",
    "title": "Exploratory Data Analysis",
    "section": "VIX",
    "text": "VIX\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"VIX\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (VIX):\\n\")\n\n\n\nComponent analysis (VIX):\n\n\nCode\ncomponent_analysis_print(\"VIX\")\n\n\n• Trend: Downward (slope: -0.0030)\n• Variation (CV): 0.383\n• Range: 11.54 to 82.69\n• Seasonality Type: Multiplicative (variance ratio: 20.17)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"VIX\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for VIX:\n  MA-  5: Var↓   4.9% | Corr 0.986\n  MA- 20: Var↓  16.6% | Corr 0.949\n  MA- 60: Var↓  37.9% | Corr 0.847\n  MA-120: Var↓  53.5% | Corr 0.731\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"VIX\")\n\n\nADF Statistic: -4.6923\np-value: 0.0100\nConclusion: STATIONARY (reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"VIX\")\n\n\nStationarity tests for VIX transformations:\n---------------------------------------- \n  original     | ADF:  -4.692 | p: 0.0100 | ✓ STATIONARY\n\n\n  first_diff   | ADF: -12.190 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -20.916 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -3.971 | p: 0.0105 | ✓ STATIONARY\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -13.200 | p: 0.0100 | ✓ STATIONARY\n\n\n\n\n\n\n\nCode\ncat(\"\\nEDA SUMMARY AND CONCLUSIONS\\n\")\n\n\n\nEDA SUMMARY AND CONCLUSIONS\n\n\nCode\ncat(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================ \n\n\nCode\n# Stationarity summary (levels)\n\nassets &lt;- c(\"Bitcoin\",\"SP500\",\"VIX\")\ncat(\"\\nSTATIONARITY (Levels):\\n\")\n\n\n\nSTATIONARITY (Levels):\n\n\nCode\nfor (a in assets) {\nres &lt;- try(tseries::adf.test(stats::na.omit(price_data[[a]]), alternative=\"stationary\"), silent=TRUE)\nif (inherits(res,\"try-error\")) next\nstatus &lt;- ifelse(res$p.value &lt; 0.05, \"STATIONARY\", \"NON-STATIONARY\")\ncat(sprintf(\"  %-8s : %s (p=%.4f)\\n\", a, status, res$p.value))\n}\n\n\n  Bitcoin  : NON-STATIONARY (p=0.8365)\n  SP500    : NON-STATIONARY (p=0.5832)\n  VIX      : STATIONARY (p=0.0100)\n\n\nCode\n# Basic vol & correlations on returns (where available)\n\nif (all(c(\"Bitcoin_ret\",\"SP500_ret\") %in% colnames(returns))) {\ncat(\"\\nKEY FINDINGS:\\n\")\nbtc_sd &lt;- sd(returns$Bitcoin_ret); sp_sd &lt;- sd(returns$SP500_ret)\ncat(sprintf(\"  • Bitcoin daily std: %.4f | S&P 500 daily std: %.4f\\n\", btc_sd, sp_sd))\nr_b_s  &lt;- cor(returns$Bitcoin_ret, returns$SP500_ret, use=\"complete.obs\")\ncat(sprintf(\"  • BTC–S&P 500 correlation (daily returns): %.3f\\n\", r_b_s))\nif (r_b_s &gt; 0.3) {\ncat(\"    → Moderate positive comovement; BTC behaving as a risk asset in-sample\\n\")\n} else {\ncat(\"    → Low comovement; BTC retains alternative characteristics\\n\")\n}\n}\n\n\n\nKEY FINDINGS:\n  • Bitcoin daily std: 0.0408 | S&P 500 daily std: 0.0128\n  • BTC–S&P 500 correlation (daily returns): 0.283\n    → Low comovement; BTC retains alternative characteristics\n\n\nCode\ncat(\"\\nModeling implications:\\n\")\n\n\n\nModeling implications:\n\n\nCode\ncat(\"  • Use differenced/log-differenced series for ARIMA/SARIMA\\n\")\n\n\n  • Use differenced/log-differenced series for ARIMA/SARIMA\n\n\nCode\ncat(\"  • Consider GARCH for volatility clustering\\n\")\n\n\n  • Consider GARCH for volatility clustering\n\n\nCode\ncat(\"  • Cross-asset work (VAR) can follow once univariate models are set\\n\")\n\n\n  • Cross-asset work (VAR) can follow once univariate models are set\n\n\nCode\ncat(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================"
  },
  {
    "objectID": "data-visualization.html",
    "href": "data-visualization.html",
    "title": "Data Visualization",
    "section": "",
    "text": "Code\n# Install pheatmap if not already installed\n# Load required libraries\nlibrary(tidyverse)\nlibrary(quantmod)\nlibrary(plotly)\nlibrary(lubridate)\nlibrary(zoo)\nlibrary(pheatmap)\n\ncat(\"Loading financial data...\\n\")\n\n\nLoading financial data...\n\n\nCode\n# Date range\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date &lt;- Sys.Date()\n\n# Working FRED series\nworking_series &lt;- list(\n  SP500 = \"SP500\",\n  VIX = \"VIXCLS\",\n  NASDAQ = \"NASDAQCOM\",\n  Oil_WTI = \"DCOILWTICO\",\n  USD_Index = \"DTWEXBGS\",\n  Treasury_10Y = \"DGS10\",\n  Treasury_2Y = \"DGS2\",\n  Treasury_3M = \"DGS3MO\",\n  Treasury_1Y = \"DGS1\",\n  Unemployment = \"UNRATE\",\n  Fed_Rate = \"FEDFUNDS\",\n  CPI = \"CPIAUCSL\",\n  Inflation = \"T10YIE\",\n  Bitcoin = \"CBBTCUSD\"\n)\n\n# Download data with better error handling\nprice_data_list &lt;- list()\n\nfor (name in names(working_series)) {\n  code &lt;- working_series[[name]]\n  cat(sprintf(\"Loading %s...\\n\", name))\n  tryCatch({\n    data &lt;- getSymbols(code, src = \"FRED\", from = start_date, to = end_date, \n                       auto.assign = FALSE, warnings = FALSE)\n    if (!is.null(data) && nrow(data) &gt; 0) {\n      price_data_list[[name]] &lt;- data[, 1]\n      cat(sprintf(\"  ✓ %s: %d observations\\n\", name, nrow(data)))\n    } else {\n      cat(sprintf(\"  ✗ %s: No data returned\\n\", name))\n    }\n  }, error = function(e) {\n    cat(sprintf(\"  ✗ Error loading %s: %s\\n\", name, e$message))\n  })\n}\n\n\nLoading SP500...\n  ✓ SP500: 1798 observations\nLoading VIX...\n  ✓ VIX: 1797 observations\nLoading NASDAQ...\n  ✓ NASDAQ: 1798 observations\nLoading Oil_WTI...\n  ✓ Oil_WTI: 1795 observations\nLoading USD_Index...\n  ✓ USD_Index: 1794 observations\nLoading Treasury_10Y...\n  ✓ Treasury_10Y: 1797 observations\nLoading Treasury_2Y...\n  ✓ Treasury_2Y: 1797 observations\nLoading Treasury_3M...\n  ✓ Treasury_3M: 1797 observations\nLoading Treasury_1Y...\n  ✓ Treasury_1Y: 1797 observations\nLoading Unemployment...\n  ✓ Unemployment: 81 observations\nLoading Fed_Rate...\n  ✓ Fed_Rate: 82 observations\nLoading CPI...\n  ✓ CPI: 81 observations\nLoading Inflation...\n  ✓ Inflation: 1798 observations\nLoading Bitcoin...\n  ✓ Bitcoin: 2516 observations\n\n\nCode\n# Check if we got any data\nif (length(price_data_list) == 0) {\n  stop(\"No data was loaded. Check your internet connection and FRED API access.\")\n}\n\n# Create data frame\nprice_data &lt;- do.call(merge, price_data_list)\ncolnames(price_data) &lt;- names(price_data_list)\n\n# Remove rows where all values are NA\nprice_data &lt;- price_data[rowSums(is.na(price_data)) != ncol(price_data), ]\n\n# Calculate returns - DON'T remove all NA rows, just use na.omit on diff\nreturns &lt;- diff(log(price_data))\n# Keep returns as is - don't filter out rows with ANY NA\n\ncat(sprintf(\"\\nData loaded successfully:\\n\"))\n\n\n\nData loaded successfully:\n\n\nCode\ncat(sprintf(\"  %d days, %d assets\\n\", nrow(price_data), ncol(price_data)))\n\n\n  2516 days, 14 assets\n\n\nCode\ncat(sprintf(\"  Assets: %s\\n\", paste(colnames(price_data), collapse = \", \")))\n\n\n  Assets: SP500, VIX, NASDAQ, Oil_WTI, USD_Index, Treasury_10Y, Treasury_2Y, Treasury_3M, Treasury_1Y, Unemployment, Fed_Rate, CPI, Inflation, Bitcoin\n\n\nCode\ncat(sprintf(\"  Date range: %s to %s\\n\", \n            format(start(price_data), \"%Y-%m-%d\"), \n            format(end(price_data), \"%Y-%m-%d\")))\n\n\n  Date range: 2019-01-01 to 2025-11-20\n\n\nCode\ncat(sprintf(\"  Returns: %d observations\\n\", nrow(returns)))\n\n\n  Returns: 2516 observations\n\n\nCode\n# Show how many valid returns per asset\ncat(\"\\nValid returns per asset:\\n\")\n\n\n\nValid returns per asset:\n\n\nCode\nfor (col in colnames(returns)) {\n  valid_count &lt;- sum(!is.na(returns[, col]))\n  cat(sprintf(\"  %s: %d\\n\", col, valid_count))\n}\n\n\n  SP500: 1357\n  VIX: 1390\n  NASDAQ: 1358\n  Oil_WTI: 1345\n  USD_Index: 1338\n  Treasury_10Y: 1344\n  Treasury_2Y: 1344\n  Treasury_3M: 1343\n  Treasury_1Y: 1344\n  Unemployment: 0\n  Fed_Rate: 0\n  CPI: 0\n  Inflation: 1345\n  Bitcoin: 2513\n\n\nCode\n# Show current levels\ncat(\"\\nCurrent levels:\\n\")\n\n\n\nCurrent levels:\n\n\nCode\nfor (asset in c(\"SP500\", \"VIX\", \"Bitcoin\", \"Oil_WTI\")) {\n  if (asset %in% colnames(price_data)) {\n    current &lt;- tail(na.omit(price_data[, asset]), 1)\n    cat(sprintf(\"  %s: %.2f\\n\", asset, as.numeric(current)))\n  }\n}\n\n\n  SP500: 6538.76\n  VIX: 23.66\n  Bitcoin: 87214.00\n  Oil_WTI: 60.66\n\n\n\n\nCode\n# Data Visualizations with Real Financial Data\n# Interactive Plotly Chart\n\n# Normalize key assets to base 100\nkey_assets &lt;- c(\"Bitcoin\", \"SP500\", \"VIX\")\navailable_key_assets &lt;- key_assets[key_assets %in% colnames(price_data)]\n\nif (length(available_key_assets) &gt; 0) {\n  \n  colors &lt;- list(Bitcoin = \"#FF9500\", SP500 = \"#1f77b4\", VIX = \"#d62728\")\n  \n  fig &lt;- plot_ly()\n  \n  for (asset in available_key_assets) {\n    clean_data &lt;- na.omit(price_data[, asset])\n    \n    if (nrow(clean_data) &gt; 0) {\n      dates &lt;- index(clean_data)\n      values &lt;- as.numeric(clean_data)\n      \n      if (asset == \"VIX\") {\n        # VIX on secondary y-axis (not normalized)\n        fig &lt;- fig %&gt;%\n          add_trace(\n            x = dates,\n            y = values,\n            type = \"scatter\",\n            mode = \"lines\",\n            name = \"VIX Fear Index\",\n            line = list(color = colors[[asset]], width = 2),\n            yaxis = \"y2\",\n            hovertemplate = paste0(\"&lt;b&gt;VIX&lt;/b&gt;&lt;br&gt;%{x}&lt;br&gt;Level: %{y:.1f}&lt;extra&gt;&lt;/extra&gt;\")\n          )\n      } else {\n        # Normalize Bitcoin and S&P 500\n        normalized &lt;- (values / values[1]) * 100\n        fig &lt;- fig %&gt;%\n          add_trace(\n            x = dates,\n            y = normalized,\n            type = \"scatter\",\n            mode = \"lines\",\n            name = asset,\n            line = list(color = colors[[asset]], width = 2),\n            hovertemplate = paste0(\"&lt;b&gt;\", asset, \"&lt;/b&gt;&lt;br&gt;%{x}&lt;br&gt;Normalized: %{y:.1f}&lt;extra&gt;&lt;/extra&gt;\")\n          )\n      }\n    }\n  }\n  \n  # Add major financial events\n  events &lt;- data.frame(\n    date = as.Date(c(\"2020-03-12\", \"2020-11-09\", \"2021-11-10\", \"2022-02-24\", \n                     \"2022-11-11\", \"2023-03-10\", \"2024-01-11\")),\n    event = c(\"COVID Crash\", \"Vaccine Rally\", \"Inflation Peak\", \"Ukraine War\",\n              \"FTX Collapse\", \"SVB Crisis\", \"BTC ETF Approval\"),\n    color = c(\"#dc2626\", \"#16a34a\", \"#ea580c\", \"#7c2d12\", \n              \"#991b1b\", \"#92400e\", \"#16a34a\")\n  )\n  \n  for (i in 1:nrow(events)) {\n    fig &lt;- fig %&gt;%\n      add_segments(\n        x = events$date[i], xend = events$date[i],\n        y = 0, yend = 1,\n        yref = \"paper\",\n        line = list(color = events$color[i], width = 2, dash = \"dash\"),\n        showlegend = FALSE\n      ) %&gt;%\n      add_annotations(\n        x = events$date[i],\n        y = 0.9,\n        yref = \"paper\",\n        text = events$event[i],\n        textangle = 90,\n        font = list(size = 11, color = events$color[i]),\n        showarrow = FALSE\n      )\n  }\n  \n  fig &lt;- fig %&gt;%\n    layout(\n      title = list(\n        text = \"Volatility Spillovers: Bitcoin vs Traditional Markets&lt;br&gt;&lt;sub&gt;Real Market Data&lt;/sub&gt;\",\n        x = 0.5,\n        font = list(size = 18)\n      ),\n      xaxis = list(title = \"Date\"),\n      yaxis = list(title = \"Normalized Price (Base = 100)\", side = \"left\"),\n      yaxis2 = list(title = \"VIX Fear Index\", side = \"right\", overlaying = \"y\"),\n      width = 1200,\n      height = 700,\n      template = \"plotly_white\",\n      hovermode = \"x unified\",\n      legend = list(\n        orientation = \"h\",\n        yanchor = \"bottom\",\n        y = 1.02,\n        xanchor = \"right\",\n        x = 1,\n        font = list(size = 12)\n      ),\n      margin = list(l = 80, r = 80, t = 100, b = 80)\n    )\n  \n  fig\n} else {\n  cat(\"No assets available for visualization\\n\")\n}\n\n\n\n\n\n\n\n\nCode\n# CLEAN Line Chart - Rolling Correlations\n\n# Calculate correlations\nwindow &lt;- 30\n\n# Check if we have the required columns\nrequired_cols &lt;- c(\"Bitcoin\", \"SP500\", \"VIX\")\navailable_cols &lt;- required_cols[required_cols %in% colnames(returns)]\n\nif (length(available_cols) &gt;= 2 && nrow(returns) &gt; window) {\n  \n  btc_sp_corr &lt;- c()\n  btc_vix_corr &lt;- c()\n  sp_vix_corr &lt;- c()\n  dates &lt;- c()\n  \n  returns_df &lt;- as.data.frame(returns)\n  returns_df$date &lt;- index(returns)\n  \n  for (i in seq(window, nrow(returns_df), by = 3)) {\n    window_data &lt;- returns_df[(i - window + 1):i, available_cols, drop = FALSE]\n    \n    if (sum(complete.cases(window_data)) &gt; window / 2) {\n      corr_matrix &lt;- cor(window_data, use = \"pairwise.complete.obs\")\n      \n      dates &lt;- c(dates, as.character(returns_df$date[i]))\n      \n      if (\"Bitcoin\" %in% available_cols && \"SP500\" %in% available_cols) {\n        btc_sp_corr &lt;- c(btc_sp_corr, corr_matrix[\"Bitcoin\", \"SP500\"])\n      }\n      if (\"Bitcoin\" %in% available_cols && \"VIX\" %in% available_cols) {\n        btc_vix_corr &lt;- c(btc_vix_corr, corr_matrix[\"Bitcoin\", \"VIX\"])\n      }\n      if (\"SP500\" %in% available_cols && \"VIX\" %in% available_cols) {\n        sp_vix_corr &lt;- c(sp_vix_corr, corr_matrix[\"SP500\", \"VIX\"])\n      }\n    }\n  }\n  \n  dates &lt;- as.Date(dates)\n  \n  # Create clean figure\n  fig &lt;- plot_ly()\n  \n  if (length(btc_sp_corr) &gt; 0) {\n    fig &lt;- fig %&gt;%\n      add_trace(\n        x = dates, y = btc_sp_corr,\n        type = \"scatter\", mode = \"lines\",\n        name = \"Bitcoin-S&P 500\",\n        line = list(color = \"#E74C3C\", width = 2),\n        hovertemplate = \"&lt;b&gt;Bitcoin vs S&P 500&lt;/b&gt;&lt;br&gt;%{x|%Y-%m-%d}&lt;br&gt;Correlation: %{y:.3f}&lt;extra&gt;&lt;/extra&gt;\"\n      )\n  }\n  \n  if (length(btc_vix_corr) &gt; 0) {\n    fig &lt;- fig %&gt;%\n      add_trace(\n        x = dates, y = btc_vix_corr,\n        type = \"scatter\", mode = \"lines\",\n        name = \"Bitcoin-VIX\",\n        line = list(color = \"#3498DB\", width = 2),\n        hovertemplate = \"&lt;b&gt;Bitcoin vs VIX&lt;/b&gt;&lt;br&gt;%{x|%Y-%m-%d}&lt;br&gt;Correlation: %{y:.3f}&lt;extra&gt;&lt;/extra&gt;\"\n      )\n  }\n  \n  if (length(sp_vix_corr) &gt; 0) {\n    fig &lt;- fig %&gt;%\n      add_trace(\n        x = dates, y = sp_vix_corr,\n        type = \"scatter\", mode = \"lines\",\n        name = \"S&P 500-VIX\",\n        line = list(color = \"#2ECC71\", width = 2),\n        hovertemplate = \"&lt;b&gt;S&P 500 vs VIX&lt;/b&gt;&lt;br&gt;%{x|%Y-%m-%d}&lt;br&gt;Correlation: %{y:.3f}&lt;extra&gt;&lt;/extra&gt;\"\n      )\n  }\n  \n  # Add reference lines\n  if (length(dates) &gt; 0) {\n    fig &lt;- fig %&gt;%\n      add_segments(x = min(dates), xend = max(dates), y = 0, yend = 0,\n                   line = list(color = \"black\", width = 1), showlegend = FALSE) %&gt;%\n      add_segments(x = min(dates), xend = max(dates), y = 0.5, yend = 0.5,\n                   line = list(color = \"gray\", width = 1, dash = \"dot\"), showlegend = FALSE) %&gt;%\n      add_segments(x = min(dates), xend = max(dates), y = -0.5, yend = -0.5,\n                   line = list(color = \"gray\", width = 1, dash = \"dot\"), showlegend = FALSE)\n    \n    fig &lt;- fig %&gt;%\n      layout(\n        title = \"Bitcoin Correlations with Traditional Markets\",\n        xaxis = list(title = \"Date\"),\n        yaxis = list(title = \"Correlation\"),\n        width = 1000,\n        height = 500,\n        template = \"plotly_white\",\n        showlegend = TRUE,\n        hovermode = \"x unified\"\n      )\n    \n    fig\n  }\n} else {\n  cat(sprintf(\"Insufficient data for correlation analysis. Need at least 2 assets and %d observations.\\n\", window))\n  cat(sprintf(\"Available: %s, Observations: %d\\n\", paste(available_cols, collapse = \", \"), nrow(returns)))\n}\n\n\n\n\n\n\n\n\nCode\n# Rolling Correlation Heatmap\n\nwindow &lt;- 30\ncorrelation_data &lt;- list()\n\nassets_for_corr &lt;- c(\"Bitcoin\", \"SP500\", \"VIX\", \"Oil_WTI\")\navailable_assets &lt;- assets_for_corr[assets_for_corr %in% colnames(returns)]\n\nif (length(available_assets) &gt;= 2 && nrow(returns) &gt; window) {\n  \n  returns_df &lt;- as.data.frame(returns)\n  returns_df$date &lt;- index(returns)\n  \n  # Sample every 20 days for cleaner visualization\n  for (i in seq(window, nrow(returns_df), by = 20)) {\n    window_data &lt;- returns_df[(i - window + 1):i, available_assets, drop = FALSE]\n    \n    if (sum(complete.cases(window_data)) &gt; window / 2) {\n      corr_matrix &lt;- cor(window_data, use = \"pairwise.complete.obs\")\n      \n      corr_row &lt;- list(Date = returns_df$date[i])\n      \n      if (\"Bitcoin\" %in% available_assets && \"SP500\" %in% available_assets) {\n        corr_row[[\"BTC-SPX\"]] &lt;- corr_matrix[\"Bitcoin\", \"SP500\"]\n      }\n      if (\"Bitcoin\" %in% available_assets && \"VIX\" %in% available_assets) {\n        corr_row[[\"BTC-VIX\"]] &lt;- corr_matrix[\"Bitcoin\", \"VIX\"]\n      }\n      if (\"SP500\" %in% available_assets && \"VIX\" %in% available_assets) {\n        corr_row[[\"SPX-VIX\"]] &lt;- corr_matrix[\"SP500\", \"VIX\"]\n      }\n      if (\"Bitcoin\" %in% available_assets && \"Oil_WTI\" %in% available_assets) {\n        corr_row[[\"BTC-Oil\"]] &lt;- corr_matrix[\"Bitcoin\", \"Oil_WTI\"]\n      }\n      \n      correlation_data[[length(correlation_data) + 1]] &lt;- corr_row\n    }\n  }\n  \n  if (length(correlation_data) &gt; 0) {\n    corr_df &lt;- do.call(rbind, lapply(correlation_data, as.data.frame))\n    corr_df$Date &lt;- as.Date(corr_df$Date, origin = \"1970-01-01\")\n    \n    # Prepare data for heatmap\n    corr_matrix_plot &lt;- as.matrix(corr_df[, -1, drop = FALSE])\n    rownames(corr_matrix_plot) &lt;- format(corr_df$Date, \"%Y-%m\")\n    \n    # Create heatmap\n    pheatmap(\n      t(corr_matrix_plot),\n      color = colorRampPalette(rev(c(\"#B2182B\", \"#D6604D\", \"#F4A582\", \"#FDDBC7\",\n                                       \"#F7F7F7\", \"#D1E5F0\", \"#92C5DE\", \"#4393C3\", \"#2166AC\")))(100),\n      cluster_rows = FALSE,\n      cluster_cols = FALSE,\n      breaks = seq(-1, 1, length.out = 101),\n      main = \"Rolling 30-Day Correlations: How Asset Relationships Change Over Time\\n(Red = Negative Correlation, Blue = Positive Correlation)\",\n      fontsize = 10,\n      angle_col = 45,\n      border_color = NA\n    )\n    \n    # Save corr_df for next chunk\n    assign(\"corr_df\", corr_df, envir = .GlobalEnv)\n  } else {\n    cat(\"Not enough correlation data points collected\\n\")\n  }\n} else {\n  cat(sprintf(\"Insufficient data. Need at least 2 assets from: %s\\n\", paste(assets_for_corr, collapse = \", \")))\n  cat(sprintf(\"Available: %s, Observations: %d\\n\", paste(available_assets, collapse = \", \"), nrow(returns)))\n}\n\n\n\n\n\n\n\n\n\n\n\nCode\n# CLEANER Correlation Visualization with ggplot2\n\n# Check if corr_df exists from previous chunk\nif (exists(\"corr_df\") && is.data.frame(corr_df) && nrow(corr_df) &gt; 0) {\n  \n  # Prepare data\n  corr_long &lt;- corr_df %&gt;%\n    pivot_longer(cols = -Date, names_to = \"Pair\", values_to = \"Correlation\")\n  \n  # Create line chart\n  p &lt;- ggplot(corr_long, aes(x = Date, y = Correlation, color = Pair)) +\n    geom_line(linewidth = 1.2, alpha = 0.9) +\n    geom_hline(yintercept = 0, color = \"black\", linetype = \"solid\", alpha = 0.3, linewidth = 0.5) +\n    geom_hline(yintercept = c(-0.5, 0.5), color = \"gray\", linetype = \"dotted\", alpha = 0.5) +\n    scale_color_manual(values = c(\"BTC-SPX\" = \"#E74C3C\", \"BTC-VIX\" = \"#3498DB\", \n                                   \"SPX-VIX\" = \"#2ECC71\", \"BTC-Oil\" = \"#F39C12\")) +\n    scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\") +\n    ylim(-1, 1) +\n    labs(\n      title = \"Bitcoin Correlation with Traditional Markets Over Time\",\n      subtitle = \"Higher Values = Bitcoin Behaves More Like Traditional Assets\",\n      x = \"Year\",\n      y = \"Correlation Coefficient\",\n      color = \"Asset Pair\"\n    ) +\n    theme_minimal(base_size = 12) +\n    theme(\n      plot.title = element_text(size = 16, face = \"bold\", hjust = 0.5),\n      plot.subtitle = element_text(size = 12, hjust = 0.5),\n      legend.position = \"top\",\n      panel.grid.minor = element_blank(),\n      panel.grid.major = element_line(color = \"gray90\")\n    )\n  \n  # Add event annotations\n  events_df &lt;- data.frame(\n    date = as.Date(c(\"2020-03-12\", \"2022-11-11\", \"2023-03-10\")),\n    event = c(\"COVID\", \"FTX\", \"SVB\"),\n    color = c(\"#DC2626\", \"#7C2D12\", \"#92400E\")\n  )\n  \n  for (i in 1:nrow(events_df)) {\n    p &lt;- p + \n      geom_vline(xintercept = as.numeric(events_df$date[i]), \n                 color = events_df$color[i], alpha = 0.6, linetype = \"dotted\", linewidth = 1) +\n      annotate(\"text\", x = events_df$date[i], y = 0.85, \n               label = events_df$event[i], angle = 0, size = 3.5,\n               color = events_df$color[i], fontface = \"bold\")\n  }\n  \n  print(p)\n  \n  # Analysis\n  cat(\"\\nWHAT THIS CHART SHOWS:\\n\")\n  cat(rep(\"=\", 50), \"\\n\", sep = \"\")\n  cat(\"\\nRED LINE (BTC-S&P 500):\\n\")\n  cat(\"  • When HIGH (+0.5 to +1.0): Bitcoin moves WITH stocks\\n\")\n  cat(\"    - Both rise and fall together\\n\")\n  cat(\"    - Bitcoin acting like a 'risk asset'\\n\\n\")\n  \n  cat(\"  • When LOW (0 to -0.5): Bitcoin moves INDEPENDENTLY\\n\") \n  cat(\"    - Bitcoin doing its own thing\\n\")\n  cat(\"    - Classic 'digital gold' behavior\\n\\n\")\n  \n  cat(\"BLUE LINE (BTC-VIX):\\n\")\n  cat(\"  • When POSITIVE: Bitcoin rises when fear increases\\n\")\n  cat(\"  • When NEGATIVE: Bitcoin falls when fear increases\\n\\n\")\n  \n  cat(\"GREEN LINE (S&P 500-VIX):\\n\")\n  cat(\"  • Should always be NEGATIVE (stocks fall when fear rises)\\n\")\n  cat(\"  • This validates our data is working correctly\\n\\n\")\n  \n  # Show current values\n  cat(\"CURRENT CORRELATION LEVELS:\\n\")\n  cat(rep(\"-\", 30), \"\\n\", sep = \"\")\n  \n  for (pair in unique(corr_long$Pair)) {\n    pair_data &lt;- corr_long %&gt;% filter(Pair == pair) %&gt;% pull(Correlation)\n    if (length(pair_data) &gt; 0) {\n      recent_corr &lt;- tail(pair_data, 1)\n      \n      interpretation &lt;- \"\"\n      if (grepl(\"BTC-SPX\", pair)) {\n        if (recent_corr &gt; 0.3) {\n          interpretation &lt;- \"(Bitcoin acting like stocks)\"\n        } else if (recent_corr &lt; -0.1) {\n          interpretation &lt;- \"(Bitcoin contrarian to stocks)\"\n        } else {\n          interpretation &lt;- \"(Bitcoin independent)\"\n        }\n      }\n      \n      cat(sprintf(\"%s: %.3f %s\\n\", pair, recent_corr, interpretation))\n    }\n  }\n  \n  cat(\"\\nKEY INSIGHT:\\n\")\n  cat(\"Bitcoin correlation with stocks INCREASES during market stress\\n\")\n  cat(\"(see spikes during COVID, FTX, SVB crises)\\n\")\n  \n} else {\n  cat(\"Correlation data not available for visualization\\n\")\n}\n\n\n\n\n\n\n\n\n\n\nWHAT THIS CHART SHOWS:\n==================================================\n\nRED LINE (BTC-S&P 500):\n  • When HIGH (+0.5 to +1.0): Bitcoin moves WITH stocks\n    - Both rise and fall together\n    - Bitcoin acting like a 'risk asset'\n\n  • When LOW (0 to -0.5): Bitcoin moves INDEPENDENTLY\n    - Bitcoin doing its own thing\n    - Classic 'digital gold' behavior\n\nBLUE LINE (BTC-VIX):\n  • When POSITIVE: Bitcoin rises when fear increases\n  • When NEGATIVE: Bitcoin falls when fear increases\n\nGREEN LINE (S&P 500-VIX):\n  • Should always be NEGATIVE (stocks fall when fear rises)\n  • This validates our data is working correctly\n\nCURRENT CORRELATION LEVELS:\n------------------------------\nBTC.SPX: 0.302 \nBTC.VIX: -0.416 \nSPX.VIX: -0.720 \nBTC.Oil: 0.031 \n\nKEY INSIGHT:\nBitcoin correlation with stocks INCREASES during market stress\n(see spikes during COVID, FTX, SVB crises)\n\n\n\n\nCode\n# VISUALIZATION 3: Weekend Effect Analysis\n\nif (\"Bitcoin\" %in% colnames(returns) && \"SP500\" %in% colnames(returns) && nrow(returns) &gt; 0) {\n  \n  returns_with_day &lt;- as.data.frame(returns)\n  returns_with_day$Date &lt;- index(returns)\n  returns_with_day$DayOfWeek &lt;- wday(returns_with_day$Date)\n  returns_with_day$DayName &lt;- weekdays(returns_with_day$Date)\n  \n  # Calculate average returns by day of week\n  day_order &lt;- c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\")\n  \n  daily_stats &lt;- returns_with_day %&gt;%\n    group_by(DayName) %&gt;%\n    summarise(\n      Bitcoin = mean(.data[[\"Bitcoin\"]], na.rm = TRUE) * 100,\n      SP500 = mean(.data[[\"SP500\"]], na.rm = TRUE) * 100,\n      .groups = 'drop'\n    ) %&gt;%\n    mutate(DayName = factor(DayName, levels = day_order)) %&gt;%\n    arrange(DayName) %&gt;%\n    filter(!is.na(Bitcoin) & !is.nan(Bitcoin) & is.finite(Bitcoin) &\n           !is.na(SP500) & !is.nan(SP500) & is.finite(SP500))\n  \n  # Check if we have valid data\n  if (nrow(daily_stats) &gt; 0 && \n      sum(is.finite(daily_stats$Bitcoin)) &gt; 0 && \n      sum(is.finite(daily_stats$SP500)) &gt; 0) {\n    \n    # Create weekend effect visualization\n    par(mfrow = c(1, 2), mar = c(5, 4, 4, 2))\n    \n    # Bitcoin (24/7 trading)\n    colors_btc &lt;- ifelse(daily_stats$DayName %in% c(\"Saturday\", \"Sunday\"), \n                         \"lightcoral\", \"orange\")\n    \n    btc_ylim &lt;- range(c(daily_stats$Bitcoin, 0), na.rm = TRUE)\n    if (diff(btc_ylim) == 0) btc_ylim &lt;- c(-0.1, 0.1)\n    \n    barplot(daily_stats$Bitcoin, \n            names.arg = daily_stats$DayName,\n            col = colors_btc,\n            main = \"Bitcoin: Average Daily Returns by Day of Week\\n(24/7 Trading)\",\n            ylab = \"Average Return (%)\",\n            las = 2,\n            ylim = btc_ylim)\n    abline(h = 0, col = \"black\", lwd = 1)\n    grid(NA, NULL, lty = 1, col = \"gray90\")\n    \n    # S&P 500 (traditional markets)\n    sp500_returns &lt;- daily_stats$SP500\n    sp500_returns[daily_stats$DayName %in% c(\"Saturday\", \"Sunday\")] &lt;- 0\n    \n    colors_sp &lt;- ifelse(daily_stats$DayName %in% c(\"Saturday\", \"Sunday\"), \n                        \"lightcoral\", \"blue\")\n    \n    sp_ylim &lt;- range(c(sp500_returns, 0), na.rm = TRUE)\n    if (diff(sp_ylim) == 0) sp_ylim &lt;- c(-0.1, 0.1)\n    \n    barplot(sp500_returns, \n            names.arg = daily_stats$DayName,\n            col = colors_sp,\n            main = \"S&P 500: Average Daily Returns by Day of Week\\n(Markets Closed Weekends)\",\n            ylab = \"Average Return (%)\",\n            las = 2,\n            ylim = sp_ylim)\n    abline(h = 0, col = \"black\", lwd = 1)\n    grid(NA, NULL, lty = 1, col = \"gray90\")\n    \n    par(mfrow = c(1, 1))\n    \n    # Save for summary\n    assign(\"daily_stats\", daily_stats, envir = .GlobalEnv)\n    \n  } else {\n    cat(\"No valid daily statistics to plot\\n\")\n  }\n  \n} else {\n  cat(sprintf(\"Cannot create weekend effect analysis. Available columns: %s\\n\", \n              paste(colnames(returns), collapse = \", \")))\n}\n\n\n\n\n\n\n\n\n\n\n\nCode\n# VISUALIZATION 4: Crisis Period Volatility Analysis\n\nif (\"Bitcoin\" %in% colnames(returns) && \"SP500\" %in% colnames(returns) && nrow(returns) &gt; 30) {\n  \n  # Calculate 30-day rolling volatility\n  vol_data &lt;- data.frame(Date = index(returns))\n  \n  vol_data$Bitcoin &lt;- rollapply(returns[, \"Bitcoin\"], width = 30, \n                                  FUN = function(x) sd(x, na.rm = TRUE) * sqrt(252) * 100,\n                                  fill = NA, align = \"right\")\n  \n  vol_data$SP500 &lt;- rollapply(returns[, \"SP500\"], width = 30, \n                                FUN = function(x) sd(x, na.rm = TRUE) * sqrt(252) * 100,\n                                fill = NA, align = \"right\")\n  \n  # Create volatility plot\n  plot(vol_data$Date, vol_data$Bitcoin, type = \"l\", col = \"orange\", lwd = 2,\n       ylim = range(c(vol_data$Bitcoin, vol_data$SP500), na.rm = TRUE),\n       xlab = \"Date\", ylab = \"Annualized Volatility (%)\",\n       main = \"Volatility Spillovers During Crisis Periods\")\n  \n  lines(vol_data$Date, vol_data$SP500, col = \"blue\", lwd = 2)\n  \n  # Add VIX on secondary axis\n  if (\"VIX\" %in% colnames(price_data)) {\n    vix_ma &lt;- rollapply(price_data[, \"VIX\"], width = 30, \n                        FUN = function(x) mean(x, na.rm = TRUE),\n                        fill = NA, align = \"right\")\n    \n    if (sum(!is.na(vix_ma)) &gt; 0) {\n      par(new = TRUE)\n      plot(index(vix_ma), as.numeric(vix_ma), type = \"l\", col = \"red\", lwd = 1.5, lty = 2,\n           axes = FALSE, xlab = \"\", ylab = \"\")\n      axis(4, col = \"red\", col.axis = \"red\")\n      mtext(\"VIX Level\", side = 4, line = 3, col = \"red\")\n    }\n  }\n  \n  # Highlight crisis periods\n  crisis_periods &lt;- data.frame(\n    start = as.Date(c(\"2020-03-01\", \"2022-02-20\", \"2022-11-01\")),\n    end = as.Date(c(\"2020-05-01\", \"2022-04-01\", \"2022-12-15\")),\n    label = c(\"COVID Crisis\", \"Ukraine War\", \"FTX Collapse\"),\n    color = c(\"red\", \"orange\", \"purple\")\n  )\n  \n  for (i in 1:nrow(crisis_periods)) {\n    rect(crisis_periods$start[i], par(\"usr\")[3], \n         crisis_periods$end[i], par(\"usr\")[4],\n         col = adjustcolor(crisis_periods$color[i], alpha.f = 0.2), border = NA)\n  }\n  \n  legend(\"topleft\", \n         legend = c(\"Bitcoin Volatility\", \"S&P 500 Volatility\", \"VIX (30-day MA)\", \n                    crisis_periods$label),\n         col = c(\"orange\", \"blue\", \"red\", crisis_periods$color),\n         lty = c(1, 1, 2, rep(1, nrow(crisis_periods))),\n         lwd = 2, cex = 0.8)\n  \n  grid()\n  \n} else {\n  cat(sprintf(\"Cannot create volatility plot. Need Bitcoin and SP500 with &gt;30 observations.\\n\"))\n  cat(sprintf(\"Available: %s, Observations: %d\\n\", \n              paste(colnames(returns), collapse = \", \"), nrow(returns)))\n}\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Summary Statistics\ncat(\"\\nKEY INSIGHTS FROM REAL DATA ANALYSIS\\n\")\n\n\n\nKEY INSIGHTS FROM REAL DATA ANALYSIS\n\n\nCode\ncat(rep(\"=\", 50), \"\\n\", sep = \"\")\n\n\n==================================================\n\n\nCode\nreturns_df &lt;- as.data.frame(returns)\n\n# Check if required columns exist\nif (\"Bitcoin\" %in% colnames(returns_df) && \"SP500\" %in% colnames(returns_df) && nrow(returns_df) &gt; 0) {\n  \n  btc_vol &lt;- sd(returns_df$Bitcoin, na.rm = TRUE) * sqrt(252) * 100\n  sp_vol &lt;- sd(returns_df$SP500, na.rm = TRUE) * sqrt(252) * 100\n  btc_sp_corr &lt;- cor(returns_df$Bitcoin, returns_df$SP500, use = \"complete.obs\")\n  \n  cat(\"VOLATILITY COMPARISON:\\n\")\n  cat(sprintf(\"  Bitcoin annual volatility: %.1f%%\\n\", btc_vol))\n  cat(sprintf(\"  S&P 500 annual volatility: %.1f%%\\n\", sp_vol))\n  cat(sprintf(\"  Bitcoin is %.1fx more volatile\\n\", btc_vol / sp_vol))\n  \n  cat(\"\\nCORRELATION ANALYSIS:\\n\")\n  cat(sprintf(\"  Bitcoin-S&P 500: %.3f\\n\", btc_sp_corr))\n  \n  if (\"VIX\" %in% colnames(returns_df)) {\n    sp_vix_corr &lt;- cor(returns_df$SP500, returns_df$VIX, use = \"complete.obs\")\n    cat(sprintf(\"  S&P 500-VIX: %.3f (should be negative)\\n\", sp_vix_corr))\n  }\n  \n  cat(\"\\nWEEKEND EFFECTS:\\n\")\n  if (exists(\"daily_stats\")) {\n    weekend_btc &lt;- mean(daily_stats$Bitcoin[daily_stats$DayName %in% c(\"Saturday\", \"Sunday\")])\n    weekday_btc &lt;- mean(daily_stats$Bitcoin[!daily_stats$DayName %in% c(\"Saturday\", \"Sunday\")])\n    cat(sprintf(\"  Bitcoin weekend avg: %.3f%%\\n\", weekend_btc))\n    cat(sprintf(\"  Bitcoin weekday avg: %.3f%%\\n\", weekday_btc))\n  }\n  \n  cat(\"\\nMARKET LEVELS (Current):\\n\")\n  if (\"Bitcoin\" %in% colnames(price_data)) {\n    btc_current &lt;- tail(na.omit(as.numeric(price_data[, \"Bitcoin\"])), 1)\n    cat(sprintf(\"  Bitcoin: $%.0f\\n\", btc_current))\n  }\n  if (\"SP500\" %in% colnames(price_data)) {\n    sp_current &lt;- tail(na.omit(as.numeric(price_data[, \"SP500\"])), 1)\n    cat(sprintf(\"  S&P 500: %.0f\\n\", sp_current))\n  }\n  if (\"VIX\" %in% colnames(price_data)) {\n    vix_current &lt;- tail(na.omit(as.numeric(price_data[, \"VIX\"])), 1)\n    cat(sprintf(\"  VIX: %.1f\\n\", vix_current))\n  }\n  \n  cat(\"\\nDATA VISUALIZATION COMPLETE\\n\")\n  cat(\"Assignment 2 requirements met:\\n\")\n  cat(\"  ✓ Plotly + ggplot2/pheatmap visualizations\\n\")\n  cat(\"  ✓ Event-driven storytelling\\n\")\n  cat(\"  ✓ Weekend effects (seasonality)\\n\")\n  cat(\"  ✓ Real financial data through 2024\\n\")\n  \n} else {\n  cat(\"Required data (Bitcoin, SP500) not available for summary statistics\\n\")\n  cat(sprintf(\"Available columns: %s\\n\", paste(colnames(returns_df), collapse = \", \")))\n  cat(sprintf(\"Number of observations: %d\\n\", nrow(returns_df)))\n}\n\n\nVOLATILITY COMPARISON:\n  Bitcoin annual volatility: 53.2%\n  S&P 500 annual volatility: 19.8%\n  Bitcoin is 2.7x more volatile\n\nCORRELATION ANALYSIS:\n  Bitcoin-S&P 500: 0.316\n  S&P 500-VIX: -0.742 (should be negative)\n\nWEEKEND EFFECTS:\n  Bitcoin weekend avg: NaN%\n  Bitcoin weekday avg: 0.083%\n\nMARKET LEVELS (Current):\n  Bitcoin: $87214\n  S&P 500: 6539\n  VIX: 23.7\n\nDATA VISUALIZATION COMPLETE\nAssignment 2 requirements met:\n  ✓ Plotly + ggplot2/pheatmap visualizations\n  ✓ Event-driven storytelling\n  ✓ Weekend effects (seasonality)\n  ✓ Real financial data through 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n```"
  },
  {
    "objectID": "eda.html#sp-500-1",
    "href": "eda.html#sp-500-1",
    "title": "Exploratory Data Analysis",
    "section": "S&P 500",
    "text": "S&P 500\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (NASDAQ):\\n\")\n\n\n\nComponent analysis (NASDAQ):\n\n\nCode\ncomponent_analysis_print(\"NASDAQ\")\n\n\n• Trend: Upward (slope: 6.7005)\n• Variation (CV): 0.282\n• Range: 6463.50 to 22470.73\n• Seasonality Type: Additive (variance ratio: 1.58)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for NASDAQ:\n  MA-  5: Var↓   1.1% | Corr 0.999\n  MA- 20: Var↓   4.5% | Corr 0.998\n  MA- 60: Var↓  12.6% | Corr 0.993\n  MA-120: Var↓  22.0% | Corr 0.984\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"NASDAQ\")\n\n\nADF Statistic: -1.5688\np-value: 0.7609\nConclusion: NON-STATIONARY (fail to reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"SP500\")\n\n\nStationarity tests for SP500 transformations:\n---------------------------------------- \n  original     | ADF:  -1.989 | p: 0.5831 | ✗ Non-stationary\n\n\n  first_diff   | ADF: -11.600 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -20.406 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -2.722 | p: 0.2726 | ✗ Non-stationary\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -11.269 | p: 0.0100 | ✓ STATIONARY"
  },
  {
    "objectID": "univariate-ts-models.html#helper-functions",
    "href": "univariate-ts-models.html#helper-functions",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "HELPER FUNCTIONS",
    "text": "HELPER FUNCTIONS\n\n\nCode\nplot_original_and_diff &lt;- function(asset) {\npar(mfrow=c(2,1))\nplot(price_data$Date, price_data[[asset]], type=\"l\",\nmain=paste(asset, \"- Original\"), col=\"steelblue\")\nplot(get_diff_series(asset), type=\"l\",\nmain=paste(asset, \"- First Difference\"), col=\"red\")\npar(mfrow=c(1,1))\n}\n\nrun_stationarity &lt;- function(asset) {\nprint(adf.test(get_diff_series(asset)))\n}\n\nplot_acf_pacf &lt;- function(asset) {\nseries &lt;- get_diff_series(asset)\npar(mfrow=c(1,2))\nacf(series, main=paste(asset,\"ACF\"))\npacf(series, main=paste(asset,\"PACF\"))\npar(mfrow=c(1,1))\n}\n\nrun_arima_models &lt;- function(asset) {\nprint(arima_models[[asset]])\n}\n\nrun_arima_diagnostics &lt;- function(asset) {\ntsdiag(arima_models[[asset]])\n}\n\nforecast_arima_asset &lt;- function(asset) {\nplot(forecast(arima_models[[asset]], h=30),\nmain=paste(asset,\"ARIMA Forecast\"))\n}\n\ncompare_benchmarks &lt;- function(asset) {\ns &lt;- get_diff_series(asset)\nlist(\nnaive = naive(s, h=30),\nsnaive = snaive(s, h=30),\narima = forecast(arima_models[[asset]], h=30)\n)\n}\n\nrun_sarima_models &lt;- function(asset) {\nprint(sarima_models[[asset]])\n}\n\nforecast_sarima_asset &lt;- function(asset) {\nplot(forecast(sarima_models[[asset]], h=30),\nmain=paste(asset,\"SARIMA Forecast\"))\n}\n\nseasonality_analysis &lt;- function(asset) {\ns &lt;- ts(get_diff_series(asset), frequency=365)\nplot(stl(s, \"periodic\"), main=paste(asset,\"Seasonality\"))\n}\n\n# FAST CV — no repeated auto.arima calls\n\ncross_validate_sarima &lt;- function(asset) {\nseries &lt;- ts(get_diff_series(asset))\nmodel &lt;- sarima_models[[asset]]\nffun &lt;- function(y, h) forecast(model, h=h)\ne &lt;- tsCV(series, ffun, h=1)\nmean(e^2, na.rm=TRUE)\n}"
  },
  {
    "objectID": "univariate-ts-models.html#univariate-time-series-analysis",
    "href": "univariate-ts-models.html#univariate-time-series-analysis",
    "title": "Univariate TS Models (ARIMA/SARIMA)",
    "section": "Univariate Time Series Analysis",
    "text": "Univariate Time Series Analysis\n\nBitcoin\n\n1. Time Series + First Difference2. Stationarity3. ACF & PACF4. ARIMA5. Diagnostics6. Forecast7. Benchmarks8. SARIMA9. SARIMA Forecast10. Seasonality11. Cross Validation\n\n\n\n\nCode\nplot_original_and_diff(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_stationarity(\"Bitcoin\")\n\n\nWarning in adf.test(get_diff_series(asset)): p-value smaller than printed\np-value\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  get_diff_series(asset)\nDickey-Fuller = -10.968, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_arima_models(\"Bitcoin\")\n\n\nSeries: series \nARIMA(0,0,2) with non-zero mean \n\nCoefficients:\n          ma1     ma2   mean\n      -0.0521  0.0456  0.002\ns.e.   0.0245  0.0247  0.001\n\nsigma^2 = 0.001662:  log likelihood = 2970.24\nAIC=-5932.48   AICc=-5932.46   BIC=-5910.81\n\n\n\n\n\n\nCode\nrun_arima_diagnostics(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nforecast_arima_asset(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncompare_benchmarks(\"Bitcoin\")\n\n\n$naive\n     Point Forecast       Lo 80      Hi 80      Lo 95     Hi 95\n1668    -0.01226293 -0.08819135 0.06366548 -0.1283854 0.1038596\n1669    -0.01226293 -0.11964193 0.09511606 -0.1764849 0.1519591\n1670    -0.01226293 -0.14377480 0.11924893 -0.2133930 0.1888671\n1671    -0.01226293 -0.16411976 0.13959389 -0.2445079 0.2199820\n1672    -0.01226293 -0.18204403 0.15751816 -0.2719207 0.2473948\n1673    -0.01226293 -0.19824880 0.17372293 -0.2967038 0.2721779\n1674    -0.01226293 -0.21315063 0.18862476 -0.3194942 0.2949683\n1675    -0.01226293 -0.22702092 0.20249505 -0.3407069 0.3161811\n1676    -0.01226293 -0.24004817 0.21552230 -0.3606304 0.3361045\n1677    -0.01226293 -0.25236966 0.22784379 -0.3794745 0.3549486\n1678    -0.01226293 -0.26408899 0.23956312 -0.3973977 0.3728718\n1679    -0.01226293 -0.27528667 0.25076080 -0.4145230 0.3899972\n1680    -0.01226293 -0.28602672 0.26150085 -0.4309485 0.4064226\n1681    -0.01226293 -0.29636104 0.27183517 -0.4467535 0.4222276\n1682    -0.01226293 -0.30633241 0.28180654 -0.4620034 0.4374775\n1683    -0.01226293 -0.31597659 0.29145072 -0.4767529 0.4522270\n1684    -0.01226293 -0.32532380 0.30079793 -0.4910482 0.4665223\n1685    -0.01226293 -0.33439991 0.30987404 -0.5049289 0.4804031\n1686    -0.01226293 -0.34322721 0.31870135 -0.5184291 0.4939033\n1687    -0.01226293 -0.35182512 0.32729925 -0.5315785 0.5070526\n1688    -0.01226293 -0.36021063 0.33568477 -0.5444030 0.5198772\n1689    -0.01226293 -0.36839876 0.34387289 -0.5569257 0.5323998\n1690    -0.01226293 -0.37640281 0.35187694 -0.5691668 0.5446409\n1691    -0.01226293 -0.38423467 0.35970880 -0.5811446 0.5566187\n1692    -0.01226293 -0.39190500 0.36737913 -0.5928754 0.5683495\n1693    -0.01226293 -0.39942339 0.37489753 -0.6043738 0.5798479\n1694    -0.01226293 -0.40679854 0.38227267 -0.6156531 0.5911272\n1695    -0.01226293 -0.41403833 0.38951246 -0.6267254 0.6021995\n1696    -0.01226293 -0.42114995 0.39662408 -0.6376017 0.6130758\n1697    -0.01226293 -0.42813998 0.40361411 -0.6482920 0.6237661\n\n$snaive\n     Point Forecast       Lo 80      Hi 80      Lo 95     Hi 95\n1668    -0.01226293 -0.08819135 0.06366548 -0.1283854 0.1038596\n1669    -0.01226293 -0.11964193 0.09511606 -0.1764849 0.1519591\n1670    -0.01226293 -0.14377480 0.11924893 -0.2133930 0.1888671\n1671    -0.01226293 -0.16411976 0.13959389 -0.2445079 0.2199820\n1672    -0.01226293 -0.18204403 0.15751816 -0.2719207 0.2473948\n1673    -0.01226293 -0.19824880 0.17372293 -0.2967038 0.2721779\n1674    -0.01226293 -0.21315063 0.18862476 -0.3194942 0.2949683\n1675    -0.01226293 -0.22702092 0.20249505 -0.3407069 0.3161811\n1676    -0.01226293 -0.24004817 0.21552230 -0.3606304 0.3361045\n1677    -0.01226293 -0.25236966 0.22784379 -0.3794745 0.3549486\n1678    -0.01226293 -0.26408899 0.23956312 -0.3973977 0.3728718\n1679    -0.01226293 -0.27528667 0.25076080 -0.4145230 0.3899972\n1680    -0.01226293 -0.28602672 0.26150085 -0.4309485 0.4064226\n1681    -0.01226293 -0.29636104 0.27183517 -0.4467535 0.4222276\n1682    -0.01226293 -0.30633241 0.28180654 -0.4620034 0.4374775\n1683    -0.01226293 -0.31597659 0.29145072 -0.4767529 0.4522270\n1684    -0.01226293 -0.32532380 0.30079793 -0.4910482 0.4665223\n1685    -0.01226293 -0.33439991 0.30987404 -0.5049289 0.4804031\n1686    -0.01226293 -0.34322721 0.31870135 -0.5184291 0.4939033\n1687    -0.01226293 -0.35182512 0.32729925 -0.5315785 0.5070526\n1688    -0.01226293 -0.36021063 0.33568477 -0.5444030 0.5198772\n1689    -0.01226293 -0.36839876 0.34387289 -0.5569257 0.5323998\n1690    -0.01226293 -0.37640281 0.35187694 -0.5691668 0.5446409\n1691    -0.01226293 -0.38423467 0.35970880 -0.5811446 0.5566187\n1692    -0.01226293 -0.39190500 0.36737913 -0.5928754 0.5683495\n1693    -0.01226293 -0.39942339 0.37489753 -0.6043738 0.5798479\n1694    -0.01226293 -0.40679854 0.38227267 -0.6156531 0.5911272\n1695    -0.01226293 -0.41403833 0.38951246 -0.6267254 0.6021995\n1696    -0.01226293 -0.42114995 0.39662408 -0.6376017 0.6130758\n1697    -0.01226293 -0.42813998 0.40361411 -0.6482920 0.6237661\n\n$arima\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668    0.002894104 -0.04935372 0.05514193 -0.07701205 0.08280026\n1669    0.001399409 -0.05091925 0.05371806 -0.07861507 0.08141389\n1670    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1671    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1672    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1673    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1674    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1675    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1676    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1677    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1678    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1679    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1680    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1681    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1682    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1683    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1684    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1685    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1686    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1687    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1688    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1689    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1690    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1691    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1692    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1693    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1694    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1695    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1696    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n1697    0.002035062 -0.05033784 0.05440796 -0.07806237 0.08213250\n\n\n\n\n\n\nCode\nrun_sarima_models(\"Bitcoin\")\n\n\nSeries: series \nARIMA(0,0,2) with non-zero mean \n\nCoefficients:\n          ma1     ma2   mean\n      -0.0521  0.0456  0.002\ns.e.   0.0245  0.0247  0.001\n\nsigma^2 = 0.001662:  log likelihood = 2970.24\nAIC=-5932.48   AICc=-5932.46   BIC=-5910.81\n\n\n\n\n\n\nCode\nforecast_sarima_asset(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nseasonality_analysis(\"Bitcoin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncross_validate_sarima(\"Bitcoin\")\n\n\n[1] 0.001667974\n\n\n\n\n\n\n\nS&P 500\n\n1. Time Series + First Difference2. Stationarity3. ACF & PACF4. ARIMA5. Diagnostics6. Forecast7. Benchmarks8. SARIMA9. SARIMA Forecast10. Seasonality11. Cross Validation\n\n\n\n\nCode\nplot_original_and_diff(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_stationarity(\"SP500\")\n\n\nWarning in adf.test(get_diff_series(asset)): p-value smaller than printed\np-value\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  get_diff_series(asset)\nDickey-Fuller = -11.102, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_arima_models(\"SP500\")\n\n\nSeries: series \nARIMA(2,0,2) with non-zero mean \n\nCoefficients:\n          ar1      ar2     ma1    ma2   mean\n      -1.7294  -0.8777  1.6072  0.739  6e-04\ns.e.   0.0270   0.0263  0.0375  0.036  3e-04\n\nsigma^2 = 0.0001523:  log likelihood = 4963.14\nAIC=-9914.28   AICc=-9914.23   BIC=-9881.76\n\n\n\n\n\n\nCode\nrun_arima_diagnostics(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nforecast_arima_asset(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncompare_benchmarks(\"SP500\")\n\n\n$naive\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668    0.004777709 -0.02030754 0.02986296 -0.03358687 0.04314228\n1669    0.004777709 -0.03069819 0.04025361 -0.04947800 0.05903341\n1670    0.004777709 -0.03867122 0.04822663 -0.06167169 0.07122710\n1671    0.004777709 -0.04539279 0.05494820 -0.07195144 0.08150686\n1672    0.004777709 -0.05131461 0.06087003 -0.08100809 0.09056351\n1673    0.004777709 -0.05666835 0.06622377 -0.08919593 0.09875134\n1674    0.004777709 -0.06159162 0.07114704 -0.09672542 0.10628084\n1675    0.004777709 -0.06617409 0.07572950 -0.10373370 0.11328912\n1676    0.004777709 -0.07047804 0.08003345 -0.11031602 0.11987144\n1677    0.004777709 -0.07454881 0.08410423 -0.11654173 0.12609715\n1678    0.004777709 -0.07842065 0.08797606 -0.12246320 0.13201861\n1679    0.004777709 -0.08212014 0.09167556 -0.12812108 0.13767650\n1680    0.004777709 -0.08566844 0.09522386 -0.13354774 0.14310316\n1681    0.004777709 -0.08908270 0.09863811 -0.13876939 0.14832481\n1682    0.004777709 -0.09237704 0.10193246 -0.14380766 0.15336307\n1683    0.004777709 -0.09556328 0.10511870 -0.14868060 0.15823601\n1684    0.004777709 -0.09865142 0.10820684 -0.15340349 0.16295891\n1685    0.004777709 -0.10164999 0.11120540 -0.15798940 0.16754482\n1686    0.004777709 -0.10456635 0.11412177 -0.16244960 0.17200502\n1687    0.004777709 -0.10740693 0.11696235 -0.16679389 0.17634931\n1688    0.004777709 -0.11017734 0.11973276 -0.17103087 0.18058628\n1689    0.004777709 -0.11288253 0.12243795 -0.17516811 0.18472352\n1690    0.004777709 -0.11552692 0.12508233 -0.17921234 0.18876775\n1691    0.004777709 -0.11811441 0.12766982 -0.18316956 0.19272498\n1692    0.004777709 -0.12064853 0.13020395 -0.18704517 0.19660059\n1693    0.004777709 -0.12313246 0.13268788 -0.19084402 0.20039943\n1694    0.004777709 -0.12556906 0.13512448 -0.19457048 0.20412590\n1695    0.004777709 -0.12796095 0.13751637 -0.19822855 0.20778397\n1696    0.004777709 -0.13031049 0.13986590 -0.20182186 0.21137728\n1697    0.004777709 -0.13261985 0.14217527 -0.20535373 0.21490915\n\n$snaive\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668    0.004777709 -0.02030754 0.02986296 -0.03358687 0.04314228\n1669    0.004777709 -0.03069819 0.04025361 -0.04947800 0.05903341\n1670    0.004777709 -0.03867122 0.04822663 -0.06167169 0.07122710\n1671    0.004777709 -0.04539279 0.05494820 -0.07195144 0.08150686\n1672    0.004777709 -0.05131461 0.06087003 -0.08100809 0.09056351\n1673    0.004777709 -0.05666835 0.06622377 -0.08919593 0.09875134\n1674    0.004777709 -0.06159162 0.07114704 -0.09672542 0.10628084\n1675    0.004777709 -0.06617409 0.07572950 -0.10373370 0.11328912\n1676    0.004777709 -0.07047804 0.08003345 -0.11031602 0.11987144\n1677    0.004777709 -0.07454881 0.08410423 -0.11654173 0.12609715\n1678    0.004777709 -0.07842065 0.08797606 -0.12246320 0.13201861\n1679    0.004777709 -0.08212014 0.09167556 -0.12812108 0.13767650\n1680    0.004777709 -0.08566844 0.09522386 -0.13354774 0.14310316\n1681    0.004777709 -0.08908270 0.09863811 -0.13876939 0.14832481\n1682    0.004777709 -0.09237704 0.10193246 -0.14380766 0.15336307\n1683    0.004777709 -0.09556328 0.10511870 -0.14868060 0.15823601\n1684    0.004777709 -0.09865142 0.10820684 -0.15340349 0.16295891\n1685    0.004777709 -0.10164999 0.11120540 -0.15798940 0.16754482\n1686    0.004777709 -0.10456635 0.11412177 -0.16244960 0.17200502\n1687    0.004777709 -0.10740693 0.11696235 -0.16679389 0.17634931\n1688    0.004777709 -0.11017734 0.11973276 -0.17103087 0.18058628\n1689    0.004777709 -0.11288253 0.12243795 -0.17516811 0.18472352\n1690    0.004777709 -0.11552692 0.12508233 -0.17921234 0.18876775\n1691    0.004777709 -0.11811441 0.12766982 -0.18316956 0.19272498\n1692    0.004777709 -0.12064853 0.13020395 -0.18704517 0.19660059\n1693    0.004777709 -0.12313246 0.13268788 -0.19084402 0.20039943\n1694    0.004777709 -0.12556906 0.13512448 -0.19457048 0.20412590\n1695    0.004777709 -0.12796095 0.13751637 -0.19822855 0.20778397\n1696    0.004777709 -0.13031049 0.13986590 -0.20182186 0.21137728\n1697    0.004777709 -0.13261985 0.14217527 -0.20535373 0.21490915\n\n$arima\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668  -7.516026e-04 -0.01656718 0.01506398 -0.02493944 0.02343624\n1669   1.918123e-03 -0.01401518 0.01785143 -0.02244976 0.02628601\n1670  -5.509363e-04 -0.01652570 0.01542383 -0.02498223 0.02388036\n1671   1.375858e-03 -0.01460158 0.01735329 -0.02305952 0.02581124\n1672   2.107502e-04 -0.01577464 0.01619614 -0.02423679 0.02465829\n1673   5.345279e-04 -0.01549064 0.01655969 -0.02397385 0.02504290\n1674   9.972256e-04 -0.01509883 0.01709328 -0.02361957 0.02561402\n1675  -8.717445e-05 -0.01626448 0.01609013 -0.02482822 0.02465387\n1676   1.382110e-03 -0.01486238 0.01762660 -0.02346170 0.02622592\n1677  -2.071213e-04 -0.01649096 0.01607672 -0.02511110 0.02469686\n1678   1.251726e-03 -0.01504552 0.01754898 -0.02367277 0.02617622\n1679   1.236520e-04 -0.01617429 0.01642159 -0.02480190 0.02504920\n1680   7.941142e-04 -0.01550698 0.01709521 -0.02413625 0.02572448\n1681   6.247346e-04 -0.01569078 0.01694025 -0.02432770 0.02557717\n1682   3.291804e-04 -0.01601143 0.01666979 -0.02466162 0.02531998\n1683   9.889949e-04 -0.01537998 0.01735797 -0.02404519 0.02602318\n1684   1.073004e-04 -0.01628485 0.01649945 -0.02496234 0.02517694\n1685   1.053001e-03 -0.01535250 0.01745850 -0.02403705 0.02614305\n1686   1.913573e-04 -0.01621853 0.01660124 -0.02490540 0.02528811\n1687   8.514491e-04 -0.01555861 0.01726151 -0.02424557 0.02594847\n1688   4.661501e-04 -0.01594516 0.01687746 -0.02463278 0.02556508\n1689   5.531188e-04 -0.01586348 0.01696972 -0.02455390 0.02566014\n1690   7.409008e-04 -0.01568467 0.01716647 -0.02437983 0.02586164\n1691   3.398071e-04 -0.01609574 0.01677536 -0.02479620 0.02547581\n1692   8.686538e-04 -0.01557494 0.01731225 -0.02427966 0.02601696\n1693   3.060962e-04 -0.01614205 0.01675424 -0.02484917 0.02546136\n1694   8.148219e-04 -0.01563476 0.01726440 -0.02434264 0.02597228\n1695   4.287846e-04 -0.01602084 0.01687841 -0.02472874 0.02558631\n1696   6.498892e-04 -0.01580023 0.01710001 -0.02450839 0.02580817\n1697   6.063388e-04 -0.01584572 0.01705840 -0.02455491 0.02576759\n\n\n\n\n\n\nCode\nrun_sarima_models(\"SP500\")\n\n\nSeries: series \nARIMA(2,0,2) with non-zero mean \n\nCoefficients:\n          ar1      ar2     ma1    ma2   mean\n      -1.7294  -0.8777  1.6072  0.739  6e-04\ns.e.   0.0270   0.0263  0.0375  0.036  3e-04\n\nsigma^2 = 0.0001523:  log likelihood = 4963.14\nAIC=-9914.28   AICc=-9914.23   BIC=-9881.76\n\n\n\n\n\n\nCode\nforecast_sarima_asset(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nseasonality_analysis(\"SP500\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncross_validate_sarima(\"SP500\")\n\n\n[1] 0.00016623\n\n\n\n\n\n\n\nNASDAQ\n\n1. Time Series + First Difference2. Stationarity3. ACF & PACF4. ARIMA5. Diagnostics6. Forecast7. Benchmarks8. SARIMA9. SARIMA Forecast10. Seasonality11. Cross Validation\n\n\n\n\nCode\nplot_original_and_diff(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_stationarity(\"NASDAQ\")\n\n\nWarning in adf.test(get_diff_series(asset)): p-value smaller than printed\np-value\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  get_diff_series(asset)\nDickey-Fuller = -10.895, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_arima_models(\"NASDAQ\")\n\n\nSeries: series \nARIMA(4,0,3) with non-zero mean \n\nCoefficients:\n          ar1      ar2     ar3      ar4     ma1      ma2      ma3   mean\n      -1.2080  -0.0310  0.3812  -0.0346  1.1052  -0.0426  -0.3773  7e-04\ns.e.   0.3762   0.6532  0.3422   0.0297  0.3759   0.6121   0.2943  3e-04\n\nsigma^2 = 0.0002289:  log likelihood = 4625.12\nAIC=-9232.24   AICc=-9232.13   BIC=-9183.47\n\n\n\n\n\n\nCode\nrun_arima_diagnostics(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nforecast_arima_asset(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncompare_benchmarks(\"NASDAQ\")\n\n\n$naive\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668    0.009362481 -0.02055553 0.03928049 -0.03639317 0.05511813\n1669    0.009362481 -0.03294797 0.05167294 -0.05534578 0.07407074\n1670    0.009362481 -0.04245703 0.06118199 -0.06988862 0.08861359\n1671    0.009362481 -0.05047354 0.06919850 -0.08214881 0.10087377\n1672    0.009362481 -0.05753622 0.07626118 -0.09295026 0.11167522\n1673    0.009362481 -0.06392138 0.08264634 -0.10271551 0.12144047\n1674    0.009362481 -0.06979313 0.08851809 -0.11169558 0.13042054\n1675    0.009362481 -0.07525843 0.09398339 -0.12005403 0.13877899\n1676    0.009362481 -0.08039155 0.09911651 -0.12790446 0.14662942\n1677    0.009362481 -0.08524657 0.10397153 -0.13532958 0.15405454\n1678    0.009362481 -0.08986433 0.10858929 -0.14239183 0.16111679\n1679    0.009362481 -0.09427654 0.11300151 -0.14913973 0.16786469\n1680    0.009362481 -0.09850844 0.11723340 -0.15561185 0.17433681\n1681    0.009362481 -0.10258046 0.12130542 -0.16183947 0.18056443\n1682    0.009362481 -0.10650947 0.12523443 -0.16784838 0.18657334\n1683    0.009362481 -0.11030956 0.12903452 -0.17366011 0.19238507\n1684    0.009362481 -0.11399263 0.13271759 -0.17929288 0.19801785\n1685    0.009362481 -0.11756888 0.13629384 -0.18476229 0.20348725\n1686    0.009362481 -0.12104710 0.13977206 -0.19008176 0.20880672\n1687    0.009362481 -0.12443492 0.14315989 -0.19526299 0.21398795\n1688    0.009362481 -0.12773906 0.14646402 -0.20031623 0.21904120\n1689    0.009362481 -0.13096542 0.14969038 -0.20525053 0.22397549\n1690    0.009362481 -0.13411925 0.15284421 -0.21007389 0.22879885\n1691    0.009362481 -0.13720523 0.15593020 -0.21479349 0.23351846\n1692    0.009362481 -0.14022757 0.15895253 -0.21941575 0.23814072\n1693    0.009362481 -0.14319003 0.16191499 -0.22394646 0.24267142\n1694    0.009362481 -0.14609606 0.16482102 -0.22839083 0.24711580\n1695    0.009362481 -0.14894874 0.16767371 -0.23275364 0.25147861\n1696    0.009362481 -0.15175093 0.17047589 -0.23703922 0.25576418\n1697    0.009362481 -0.15450521 0.17323017 -0.24125152 0.25997648\n\n$snaive\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668    0.009362481 -0.02055553 0.03928049 -0.03639317 0.05511813\n1669    0.009362481 -0.03294797 0.05167294 -0.05534578 0.07407074\n1670    0.009362481 -0.04245703 0.06118199 -0.06988862 0.08861359\n1671    0.009362481 -0.05047354 0.06919850 -0.08214881 0.10087377\n1672    0.009362481 -0.05753622 0.07626118 -0.09295026 0.11167522\n1673    0.009362481 -0.06392138 0.08264634 -0.10271551 0.12144047\n1674    0.009362481 -0.06979313 0.08851809 -0.11169558 0.13042054\n1675    0.009362481 -0.07525843 0.09398339 -0.12005403 0.13877899\n1676    0.009362481 -0.08039155 0.09911651 -0.12790446 0.14662942\n1677    0.009362481 -0.08524657 0.10397153 -0.13532958 0.15405454\n1678    0.009362481 -0.08986433 0.10858929 -0.14239183 0.16111679\n1679    0.009362481 -0.09427654 0.11300151 -0.14913973 0.16786469\n1680    0.009362481 -0.09850844 0.11723340 -0.15561185 0.17433681\n1681    0.009362481 -0.10258046 0.12130542 -0.16183947 0.18056443\n1682    0.009362481 -0.10650947 0.12523443 -0.16784838 0.18657334\n1683    0.009362481 -0.11030956 0.12903452 -0.17366011 0.19238507\n1684    0.009362481 -0.11399263 0.13271759 -0.17929288 0.19801785\n1685    0.009362481 -0.11756888 0.13629384 -0.18476229 0.20348725\n1686    0.009362481 -0.12104710 0.13977206 -0.19008176 0.20880672\n1687    0.009362481 -0.12443492 0.14315989 -0.19526299 0.21398795\n1688    0.009362481 -0.12773906 0.14646402 -0.20031623 0.21904120\n1689    0.009362481 -0.13096542 0.14969038 -0.20525053 0.22397549\n1690    0.009362481 -0.13411925 0.15284421 -0.21007389 0.22879885\n1691    0.009362481 -0.13720523 0.15593020 -0.21479349 0.23351846\n1692    0.009362481 -0.14022757 0.15895253 -0.21941575 0.23814072\n1693    0.009362481 -0.14319003 0.16191499 -0.22394646 0.24267142\n1694    0.009362481 -0.14609606 0.16482102 -0.22839083 0.24711580\n1695    0.009362481 -0.14894874 0.16767371 -0.23275364 0.25147861\n1696    0.009362481 -0.15175093 0.17047589 -0.23703922 0.25576418\n1697    0.009362481 -0.15450521 0.17323017 -0.24125152 0.25997648\n\n$arima\n     Point Forecast       Lo 80      Hi 80       Lo 95      Hi 95\n1668  -0.0008575488 -0.02024650 0.01853140 -0.03051039 0.02879530\n1669   0.0019918408 -0.01749927 0.02148295 -0.02781724 0.03180092\n1670  -0.0004575652 -0.01997337 0.01905824 -0.03030442 0.02938928\n1671   0.0012052422 -0.01833870 0.02074918 -0.02868463 0.03109512\n1672   0.0007120392 -0.01883286 0.02025694 -0.02917931 0.03060339\n1673   0.0002240132 -0.01933379 0.01978182 -0.02968706 0.03013509\n1674   0.0015474544 -0.01805255 0.02114746 -0.02842816 0.03152307\n1675  -0.0002817062 -0.01993850 0.01937509 -0.03034418 0.02978077\n1676   0.0017179811 -0.01799493 0.02143090 -0.02843032 0.03186628\n1677  -0.0001196250 -0.01987118 0.01963193 -0.03032701 0.03008776\n1678   0.0012952159 -0.01847385 0.02106428 -0.02893896 0.03152939\n1679   0.0004685645 -0.01930357 0.02024070 -0.02977030 0.03070743\n1680   0.0006536556 -0.01911889 0.02042620 -0.02958584 0.03089315\n1681   0.0010585919 -0.01872089 0.02083808 -0.02919152 0.03130870\n1682   0.0001996140 -0.01959567 0.01999490 -0.03007466 0.03047389\n1683   0.0013238882 -0.01849196 0.02113974 -0.02898184 0.03162962\n1684   0.0001403147 -0.01969427 0.01997490 -0.03019406 0.03047469\n1685   0.0011938079 -0.01865289 0.02104051 -0.02915910 0.03154672\n1686   0.0004161321 -0.01943544 0.02026770 -0.02994422 0.03077649\n1687   0.0008328614 -0.01901927 0.02068500 -0.02952836 0.03119408\n1688   0.0007960818 -0.01905646 0.02064862 -0.02956576 0.03115792\n1689   0.0004947003 -0.01936091 0.02035031 -0.02987184 0.03086124\n1690   0.0010456790 -0.01881599 0.02090735 -0.02933012 0.03142148\n1691   0.0003609848 -0.01950798 0.02022995 -0.03002598 0.03074795\n1692   0.0010574235 -0.01881778 0.02093263 -0.02933908 0.03145392\n1693   0.0004577868 -0.01942116 0.02033673 -0.02994443 0.03086000\n1694   0.0008805126 -0.01899974 0.02076076 -0.02952371 0.03128473\n1695   0.0006776028 -0.01920272 0.02055793 -0.02972673 0.03108194\n1696   0.0006569465 -0.01922366 0.02053755 -0.02974781 0.03106170\n1697   0.0008700767 -0.01901184 0.02075199 -0.02953669 0.03127684\n\n\n\n\n\n\nCode\nrun_sarima_models(\"NASDAQ\")\n\n\nSeries: series \nARIMA(4,0,3) with non-zero mean \n\nCoefficients:\n          ar1      ar2     ar3      ar4     ma1      ma2      ma3   mean\n      -1.2080  -0.0310  0.3812  -0.0346  1.1052  -0.0426  -0.3773  7e-04\ns.e.   0.3762   0.6532  0.3422   0.0297  0.3759   0.6121   0.2943  3e-04\n\nsigma^2 = 0.0002289:  log likelihood = 4625.12\nAIC=-9232.24   AICc=-9232.13   BIC=-9183.47\n\n\n\n\n\n\nCode\nforecast_sarima_asset(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nseasonality_analysis(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncross_validate_sarima(\"NASDAQ\")\n\n\n[1] 0.000241984\n\n\n\n\n\n\n\nVIX\n\n1. Time Series + First Difference2. Stationarity3. ACF & PACF4. ARIMA5. Diagnostics6. Forecast7. Benchmarks8. SARIMA9. SARIMA Forecast10. Seasonality11. Cross Validation\n\n\n\n\nCode\nplot_original_and_diff(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_stationarity(\"VIX\")\n\n\nWarning in adf.test(get_diff_series(asset)): p-value smaller than printed\np-value\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  get_diff_series(asset)\nDickey-Fuller = -13.2, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_arima_models(\"VIX\")\n\n\nSeries: series \nARIMA(3,0,1) with zero mean \n\nCoefficients:\n         ar1     ar2      ar3      ma1\n      0.8842  0.0692  -0.0050  -0.9862\ns.e.  0.0285  0.0328   0.0258   0.0148\n\nsigma^2 = 0.006164:  log likelihood = 1878.16\nAIC=-3746.32   AICc=-3746.28   BIC=-3719.22\n\n\n\n\n\n\nCode\nrun_arima_diagnostics(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nforecast_arima_asset(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncompare_benchmarks(\"VIX\")\n\n\n$naive\n     Point Forecast      Lo 80     Hi 80      Lo 95     Hi 95\n1668   -0.001273075 -0.1510721 0.1485260 -0.2303709 0.2278248\n1669   -0.001273075 -0.2131209 0.2105747 -0.3252664 0.3227202\n1670   -0.001273075 -0.2607326 0.2581865 -0.3980822 0.3955360\n1671   -0.001273075 -0.3008711 0.2983250 -0.4594688 0.4569226\n1672   -0.001273075 -0.3362339 0.3336877 -0.5135514 0.5110053\n1673   -0.001273075 -0.3682043 0.3656581 -0.5624459 0.5598998\n1674   -0.001273075 -0.3976041 0.3950579 -0.6074090 0.6048629\n1675   -0.001273075 -0.4249687 0.4224226 -0.6492596 0.6467135\n1676   -0.001273075 -0.4506702 0.4481240 -0.6885666 0.6860205\n1677   -0.001273075 -0.4749792 0.4724331 -0.7257441 0.7231979\n1678   -0.001273075 -0.4981003 0.4955541 -0.7611047 0.7585585\n1679   -0.001273075 -0.5201921 0.5176460 -0.7948913 0.7923452\n1680   -0.001273075 -0.5413812 0.5388350 -0.8272971 0.8247510\n1681   -0.001273075 -0.5617697 0.5592236 -0.8584787 0.8559326\n1682   -0.001273075 -0.5814422 0.5788961 -0.8885652 0.8860191\n1683   -0.001273075 -0.6004692 0.5979231 -0.9176645 0.9151183\n1684   -0.001273075 -0.6189103 0.6163642 -0.9458677 0.9433216\n1685   -0.001273075 -0.6368165 0.6342704 -0.9732529 0.9707068\n1686   -0.001273075 -0.6542319 0.6516858 -0.9998875 0.9973413\n1687   -0.001273075 -0.6711947 0.6686486 -1.0258298 1.0232837\n1688   -0.001273075 -0.6877385 0.6851923 -1.0511313 1.0485852\n1689   -0.001273075 -0.7038928 0.7013467 -1.0758372 1.0732911\n1690   -0.001273075 -0.7196840 0.7171378 -1.0999878 1.0974416\n1691   -0.001273075 -0.7351355 0.7325893 -1.1236187 1.1210726\n1692   -0.001273075 -0.7502682 0.7477221 -1.1467623 1.1442162\n1693   -0.001273075 -0.7651013 0.7625551 -1.1694475 1.1669013\n1694   -0.001273075 -0.7796517 0.7771055 -1.1917004 1.1891543\n1695   -0.001273075 -0.7939350 0.7913889 -1.2135449 1.2109988\n1696   -0.001273075 -0.8079656 0.8054194 -1.2350028 1.2324566\n1697   -0.001273075 -0.8217562 0.8192100 -1.2560937 1.2535475\n\n$snaive\n     Point Forecast      Lo 80     Hi 80      Lo 95     Hi 95\n1668   -0.001273075 -0.1510721 0.1485260 -0.2303709 0.2278248\n1669   -0.001273075 -0.2131209 0.2105747 -0.3252664 0.3227202\n1670   -0.001273075 -0.2607326 0.2581865 -0.3980822 0.3955360\n1671   -0.001273075 -0.3008711 0.2983250 -0.4594688 0.4569226\n1672   -0.001273075 -0.3362339 0.3336877 -0.5135514 0.5110053\n1673   -0.001273075 -0.3682043 0.3656581 -0.5624459 0.5598998\n1674   -0.001273075 -0.3976041 0.3950579 -0.6074090 0.6048629\n1675   -0.001273075 -0.4249687 0.4224226 -0.6492596 0.6467135\n1676   -0.001273075 -0.4506702 0.4481240 -0.6885666 0.6860205\n1677   -0.001273075 -0.4749792 0.4724331 -0.7257441 0.7231979\n1678   -0.001273075 -0.4981003 0.4955541 -0.7611047 0.7585585\n1679   -0.001273075 -0.5201921 0.5176460 -0.7948913 0.7923452\n1680   -0.001273075 -0.5413812 0.5388350 -0.8272971 0.8247510\n1681   -0.001273075 -0.5617697 0.5592236 -0.8584787 0.8559326\n1682   -0.001273075 -0.5814422 0.5788961 -0.8885652 0.8860191\n1683   -0.001273075 -0.6004692 0.5979231 -0.9176645 0.9151183\n1684   -0.001273075 -0.6189103 0.6163642 -0.9458677 0.9433216\n1685   -0.001273075 -0.6368165 0.6342704 -0.9732529 0.9707068\n1686   -0.001273075 -0.6542319 0.6516858 -0.9998875 0.9973413\n1687   -0.001273075 -0.6711947 0.6686486 -1.0258298 1.0232837\n1688   -0.001273075 -0.6877385 0.6851923 -1.0511313 1.0485852\n1689   -0.001273075 -0.7038928 0.7013467 -1.0758372 1.0732911\n1690   -0.001273075 -0.7196840 0.7171378 -1.0999878 1.0974416\n1691   -0.001273075 -0.7351355 0.7325893 -1.1236187 1.1210726\n1692   -0.001273075 -0.7502682 0.7477221 -1.1467623 1.1442162\n1693   -0.001273075 -0.7651013 0.7625551 -1.1694475 1.1669013\n1694   -0.001273075 -0.7796517 0.7771055 -1.1917004 1.1891543\n1695   -0.001273075 -0.7939350 0.7913889 -1.2135449 1.2109988\n1696   -0.001273075 -0.8079656 0.8054194 -1.2350028 1.2324566\n1697   -0.001273075 -0.8217562 0.8192100 -1.2560937 1.2535475\n\n$arima\n     Point Forecast       Lo 80     Hi 80      Lo 95     Hi 95\n1668   0.0039440738 -0.09667110 0.1045593 -0.1499336 0.1578217\n1669   0.0035971162 -0.09753991 0.1047341 -0.1510786 0.1582729\n1670   0.0034600747 -0.09769890 0.1046190 -0.1512492 0.1581694\n1671   0.0032890215 -0.09791659 0.1044946 -0.1514916 0.1580696\n1672   0.0031300014 -0.09811465 0.1043747 -0.1517103 0.1579703\n1673   0.0029782265 -0.09830211 0.1042586 -0.1519167 0.1578731\n1674   0.0028338597 -0.09847874 0.1041465 -0.1521104 0.1577781\n1675   0.0026964854 -0.09864532 0.1040383 -0.1522924 0.1576854\n1676   0.0025657710 -0.09880246 0.1039340 -0.1524636 0.1575951\n1677   0.0024413931 -0.09895077 0.1038336 -0.1526245 0.1575073\n1678   0.0023230445 -0.09909078 0.1037369 -0.1527760 0.1574221\n1679   0.0022104330 -0.09922299 0.1036439 -0.1529186 0.1573395\n1680   0.0021032804 -0.09934789 0.1035545 -0.1530529 0.1572595\n1681   0.0020013221 -0.09946592 0.1034686 -0.1531794 0.1571821\n1682   0.0019043063 -0.09957748 0.1033861 -0.1532987 0.1571073\n1683   0.0018119934 -0.09968295 0.1033069 -0.1534111 0.1570351\n1684   0.0017241555 -0.09978271 0.1032310 -0.1535172 0.1569655\n1685   0.0016405756 -0.09987708 0.1031582 -0.1536173 0.1568984\n1686   0.0015610473 -0.09996638 0.1030885 -0.1537118 0.1568338\n1687   0.0014853742 -0.10005090 0.1030216 -0.1538009 0.1567717\n1688   0.0014133695 -0.10013091 0.1029576 -0.1538852 0.1567119\n1689   0.0013448552 -0.10020667 0.1028964 -0.1539648 0.1566545\n1690   0.0012796622 -0.10027842 0.1028377 -0.1540400 0.1565994\n1691   0.0012176295 -0.10034640 0.1027817 -0.1541111 0.1565464\n1692   0.0011586039 -0.10041080 0.1027280 -0.1541784 0.1564956\n1693   0.0011024396 -0.10047184 0.1026767 -0.1542420 0.1564469\n1694   0.0010489979 -0.10052969 0.1026277 -0.1543022 0.1564002\n1695   0.0009981468 -0.10058453 0.1025808 -0.1543591 0.1563554\n1696   0.0009497608 -0.10063653 0.1025361 -0.1544131 0.1563126\n1697   0.0009037203 -0.10068584 0.1024933 -0.1544641 0.1562715\n\n\n\n\n\n\nCode\nrun_sarima_models(\"VIX\")\n\n\nSeries: series \nARIMA(3,0,1) with zero mean \n\nCoefficients:\n         ar1     ar2      ar3      ma1\n      0.8842  0.0692  -0.0050  -0.9862\ns.e.  0.0285  0.0328   0.0258   0.0148\n\nsigma^2 = 0.006164:  log likelihood = 1878.16\nAIC=-3746.32   AICc=-3746.28   BIC=-3719.22\n\n\n\n\n\n\nCode\nforecast_sarima_asset(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nseasonality_analysis(\"VIX\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncross_validate_sarima(\"VIX\")\n\n\n[1] 0.006289282\n\n\n\n\n\n\n\nUSD\n\n1. Time Series + First Difference2. Stationarity3. ACF & PACF4. ARIMA5. Diagnostics6. Forecast7. Benchmarks8. SARIMA9. SARIMA Forecast10. Seasonality11. Cross Validation\n\n\n\n\nCode\nplot_original_and_diff(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_stationarity(\"USD\")\n\n\nWarning in adf.test(get_diff_series(asset)): p-value smaller than printed\np-value\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  get_diff_series(asset)\nDickey-Fuller = -11.44, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrun_arima_models(\"USD\")\n\n\nSeries: series \nARIMA(0,0,1) with zero mean \n\nCoefficients:\n         ma1\n      0.0482\ns.e.  0.0242\n\nsigma^2 = 1.02e-05:  log likelihood = 7214.27\nAIC=-14424.55   AICc=-14424.54   BIC=-14413.71\n\n\n\n\n\n\nCode\nrun_arima_diagnostics(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nforecast_arima_asset(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncompare_benchmarks(\"USD\")\n\n\n$naive\n     Point Forecast        Lo 80      Hi 80        Lo 95      Hi 95\n1668    0.004107556 -0.001542037 0.00975715 -0.004532751 0.01274786\n1669    0.004107556 -0.003882175 0.01209729 -0.008111684 0.01632680\n1670    0.004107556 -0.005677826 0.01389294 -0.010857895 0.01907301\n1671    0.004107556 -0.007191630 0.01540674 -0.013173058 0.02138817\n1672    0.004107556 -0.008525318 0.01674043 -0.015212758 0.02342787\n1673    0.004107556 -0.009731065 0.01794618 -0.017056788 0.02527190\n1674    0.004107556 -0.010839863 0.01905498 -0.018752548 0.02696766\n1675    0.004107556 -0.011871907 0.02008702 -0.020330923 0.02854604\n1676    0.004107556 -0.012841224 0.02105634 -0.021813366 0.03002848\n1677    0.004107556 -0.013758026 0.02197314 -0.023215495 0.03143061\n1678    0.004107556 -0.014630025 0.02284514 -0.024549101 0.03276421\n1679    0.004107556 -0.015463209 0.02367832 -0.025823346 0.03403846\n1680    0.004107556 -0.016262342 0.02447745 -0.027045515 0.03526063\n1681    0.004107556 -0.017031286 0.02524640 -0.028221514 0.03643663\n1682    0.004107556 -0.017773225 0.02598834 -0.029356210 0.03757132\n1683    0.004107556 -0.018490817 0.02670593 -0.030453673 0.03866879\n1684    0.004107556 -0.019186314 0.02740143 -0.031517344 0.03973246\n1685    0.004107556 -0.019861638 0.02807675 -0.032550163 0.04076528\n1686    0.004107556 -0.020518450 0.02873356 -0.033554670 0.04176978\n1687    0.004107556 -0.021158193 0.02937331 -0.034533073 0.04274819\n1688    0.004107556 -0.021782133 0.02999725 -0.035487306 0.04370242\n1689    0.004107556 -0.022391385 0.03060650 -0.036419078 0.04463419\n1690    0.004107556 -0.022986941 0.03120205 -0.037329902 0.04554501\n1691    0.004107556 -0.023569686 0.03178480 -0.038221132 0.04643625\n1692    0.004107556 -0.024140410 0.03235552 -0.039093981 0.04730909\n1693    0.004107556 -0.024699830 0.03291494 -0.039949540 0.04816465\n1694    0.004107556 -0.025248592 0.03346370 -0.040788798 0.04900391\n1695    0.004107556 -0.025787282 0.03400239 -0.041612653 0.04982777\n1696    0.004107556 -0.026316435 0.03453155 -0.042421923 0.05063704\n1697    0.004107556 -0.026836541 0.03505165 -0.043217356 0.05143247\n\n$snaive\n     Point Forecast        Lo 80      Hi 80        Lo 95      Hi 95\n1668    0.004107556 -0.001542037 0.00975715 -0.004532751 0.01274786\n1669    0.004107556 -0.003882175 0.01209729 -0.008111684 0.01632680\n1670    0.004107556 -0.005677826 0.01389294 -0.010857895 0.01907301\n1671    0.004107556 -0.007191630 0.01540674 -0.013173058 0.02138817\n1672    0.004107556 -0.008525318 0.01674043 -0.015212758 0.02342787\n1673    0.004107556 -0.009731065 0.01794618 -0.017056788 0.02527190\n1674    0.004107556 -0.010839863 0.01905498 -0.018752548 0.02696766\n1675    0.004107556 -0.011871907 0.02008702 -0.020330923 0.02854604\n1676    0.004107556 -0.012841224 0.02105634 -0.021813366 0.03002848\n1677    0.004107556 -0.013758026 0.02197314 -0.023215495 0.03143061\n1678    0.004107556 -0.014630025 0.02284514 -0.024549101 0.03276421\n1679    0.004107556 -0.015463209 0.02367832 -0.025823346 0.03403846\n1680    0.004107556 -0.016262342 0.02447745 -0.027045515 0.03526063\n1681    0.004107556 -0.017031286 0.02524640 -0.028221514 0.03643663\n1682    0.004107556 -0.017773225 0.02598834 -0.029356210 0.03757132\n1683    0.004107556 -0.018490817 0.02670593 -0.030453673 0.03866879\n1684    0.004107556 -0.019186314 0.02740143 -0.031517344 0.03973246\n1685    0.004107556 -0.019861638 0.02807675 -0.032550163 0.04076528\n1686    0.004107556 -0.020518450 0.02873356 -0.033554670 0.04176978\n1687    0.004107556 -0.021158193 0.02937331 -0.034533073 0.04274819\n1688    0.004107556 -0.021782133 0.02999725 -0.035487306 0.04370242\n1689    0.004107556 -0.022391385 0.03060650 -0.036419078 0.04463419\n1690    0.004107556 -0.022986941 0.03120205 -0.037329902 0.04554501\n1691    0.004107556 -0.023569686 0.03178480 -0.038221132 0.04643625\n1692    0.004107556 -0.024140410 0.03235552 -0.039093981 0.04730909\n1693    0.004107556 -0.024699830 0.03291494 -0.039949540 0.04816465\n1694    0.004107556 -0.025248592 0.03346370 -0.040788798 0.04900391\n1695    0.004107556 -0.025787282 0.03400239 -0.041612653 0.04982777\n1696    0.004107556 -0.026316435 0.03453155 -0.042421923 0.05063704\n1697    0.004107556 -0.026836541 0.03505165 -0.043217356 0.05143247\n\n$arima\n     Point Forecast        Lo 80       Hi 80        Lo 95       Hi 95\n1668   0.0001972599 -0.003896601 0.004291121 -0.006063760 0.006458280\n1669   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1670   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1671   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1672   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1673   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1674   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1675   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1676   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1677   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1678   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1679   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1680   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1681   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1682   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1683   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1684   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1685   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1686   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1687   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1688   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1689   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1690   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1691   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1692   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1693   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1694   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1695   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1696   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n1697   0.0000000000 -0.004098615 0.004098615 -0.006268291 0.006268291\n\n\n\n\n\n\nCode\nrun_sarima_models(\"USD\")\n\n\nSeries: series \nARIMA(0,0,1) with zero mean \n\nCoefficients:\n         ma1\n      0.0482\ns.e.  0.0242\n\nsigma^2 = 1.02e-05:  log likelihood = 7214.27\nAIC=-14424.55   AICc=-14424.54   BIC=-14413.71\n\n\n\n\n\n\nCode\nforecast_sarima_asset(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nseasonality_analysis(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncross_validate_sarima(\"USD\")\n\n\n[1] 1.025425e-05"
  },
  {
    "objectID": "eda.html#nasdaq",
    "href": "eda.html#nasdaq",
    "title": "Exploratory Data Analysis",
    "section": "NASDAQ",
    "text": "NASDAQ\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (NASDAQ):\\n\")\n\n\n\nComponent analysis (NASDAQ):\n\n\nCode\ncomponent_analysis_print(\"NASDAQ\")\n\n\n• Trend: Upward (slope: 6.7847)\n• Variation (CV): 0.282\n• Range: 6463.50 to 22470.73\n• Seasonality Type: Additive (variance ratio: 1.58)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for NASDAQ:\n  MA-  5: Var↓   1.1% | Corr 0.999\n  MA- 20: Var↓   4.5% | Corr 0.998\n  MA- 60: Var↓  12.7% | Corr 0.993\n  MA-120: Var↓  22.2% | Corr 0.984\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"NASDAQ\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"NASDAQ\")\n\n\nADF Statistic: -1.5726\np-value: 0.7593\nConclusion: NON-STATIONARY (fail to reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"NASDAQ\")\n\n\nStationarity tests for NASDAQ transformations:\n---------------------------------------- \n  original     | ADF:  -1.573 | p: 0.7593 | ✗ Non-stationary\n\n\n  first_diff   | ADF: -11.219 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -20.469 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -2.089 | p: 0.5406 | ✗ Non-stationary\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -10.895 | p: 0.0100 | ✓ STATIONARY"
  },
  {
    "objectID": "eda.html#usd-index",
    "href": "eda.html#usd-index",
    "title": "Exploratory Data Analysis",
    "section": "USD INDEX",
    "text": "USD INDEX\n\nTime Series PlotMoving Average SmoothingLag PlotsACF & PACFDickey Fuller TestStationary\n\n\n\n\nCode\nplot_ts_with_trend(\"USD\")\n\n\n\n\n\n\n\n\n\nCode\ncat(\"\\nComponent analysis (USD):\\n\")\n\n\n\nComponent analysis (USD):\n\n\nCode\ncomponent_analysis_print(\"USD\")\n\n\n• Trend: Upward (slope: 0.0063)\n• Variation (CV): 0.037\n• Range: 110.52 to 130.21\n• Seasonality Type: Additive (variance ratio: 1.33)\n\n\n\n\n\n\nCode\nmoving_average_panel(\"USD\")\n\n\n\n\n\n\n\n\n\nVariance reduction & correlations for USD:\n  MA-  5: Var↓   0.5% | Corr 0.999\n  MA- 20: Var↓   2.2% | Corr 0.993\n  MA- 60: Var↓   7.3% | Corr 0.980\n  MA-120: Var↓  15.1% | Corr 0.954\n\n\n\n\n\n\nCode\ncreate_lag_plots(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_acf_pacf(\"USD\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nadf_print(\"USD\")\n\n\nADF Statistic: -2.3914\np-value: 0.4126\nConclusion: NON-STATIONARY (fail to reject H0)\n\n\n\n\n\n\nCode\nmake_stationary(\"USD\")\n\n\nStationarity tests for USD transformations:\n---------------------------------------- \n  original     | ADF:  -2.391 | p: 0.4126 | ✗ Non-stationary\n\n\n  first_diff   | ADF: -11.432 | p: 0.0100 | ✓ STATIONARY\n\n\n  second_diff  | ADF: -20.921 | p: 0.0100 | ✓ STATIONARY\n\n\n  log          | ADF:  -2.367 | p: 0.4230 | ✗ Non-stationary\n\n\n\n\n\n\n\n\n\n  log_diff     | ADF: -11.440 | p: 0.0100 | ✓ STATIONARY"
  },
  {
    "objectID": "financial-ts-models.html#sp-500",
    "href": "financial-ts-models.html#sp-500",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "S&P 500",
    "text": "S&P 500\n\nA. Plot data & stationarityB. ACF/PACFC. ARMA Mean Model SelectionD. Mean Model Residuals & ARCH EffectsE. GARCH(p,q) Grid SearchF. Final GARCH DiagnosticsG. Model Equation (SPX)Final ARMA(2,1)–GARCH(2,1) model\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\np_level &lt;- ggplot(price_data, aes(Date, SP500)) +\ngeom_line() +\ntheme_minimal() +\nlabs(title = \"S&P 500 — Price Level\")\n\np_ret &lt;- ggplot(tibble(Date = spx_dates, SPX_ret = spx_ret),\naes(Date, SPX_ret)) +\ngeom_line() +\ntheme_minimal() +\nlabs(title = \"S&P 500 — Daily Log-Returns\")\n\ngridExtra::grid.arrange(p_level, p_ret, nrow = 2)\n\n\n\n\n\n\n\n\n\nCode\nadf_spx_ret &lt;- adf.test(spx_ret)\n\n\nWarning in adf.test(spx_ret): p-value smaller than printed p-value\n\n\nCode\ncat(sprintf(\"ADF p-value = %.4f\\n\", adf_spx_ret$p.value))\n\n\nADF p-value = 0.0100\n\n\nThe price series is clearly non-stationary (upward trend and large moves). The returns fluctuate around zero with roughly constant mean and pass the ADF test (small p-value), so S&P 500 returns are stationary. The return plot shows volatility clustering, which motivates GARCH-type models.\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 4\n\npar(mfrow=c(1,2))\nacf(spx_ret, main=\"SPX Returns ACF\")\npacf(spx_ret, main=\"SPX Returns PACF\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\nThe ACF decays quickly and stays near zero; PACF has small spikes in early lags. This pattern suggests that a low-order ARMA model (e.g., ARMA(1,0), ARMA(1,1), ARMA(2,1)) is reasonable for the mean.\n\n\n\n\nCode\n#| warning: false\n\ncand_orders &lt;- list(\nc(0,0),\nc(1,0),\nc(1,1),\nc(2,1)\n)\n\nfit_list &lt;- list()\naic_vec &lt;- c()\n\nfor (ord in cand_orders) {\np &lt;- ord[1]; q &lt;- ord[2]\nfit &lt;- Arima(spx_ret, order=c(p,0,q), include.mean=TRUE)\nfit_list[[paste0(\"ARMA(\",p,\",\",q,\")\")]] &lt;- fit\naic_vec &lt;- c(aic_vec, AIC(fit))\n}\n\naic_tbl &lt;- tibble(\nModel = names(fit_list),\nAIC   = aic_vec\n) |&gt; arrange(AIC)\n\nprint(aic_tbl)\n\n\n# A tibble: 4 × 2\n  Model        AIC\n  &lt;chr&gt;      &lt;dbl&gt;\n1 ARMA(2,1) -9969.\n2 ARMA(1,1) -9966.\n3 ARMA(1,0) -9959.\n4 ARMA(0,0) -9914.\n\n\nCode\nbest_name     &lt;- aic_tbl$Model[1]\nbest_mean_fit &lt;- fit_list[[best_name]]\n\ncat(\"Selected mean model:\", best_name, \"\\n\")\n\n\nSelected mean model: ARMA(2,1) \n\n\nCode\nsummary(best_mean_fit)\n\n\nSeries: spx_ret \nARIMA(2,0,1) with non-zero mean \n\nCoefficients:\n          ar1     ar2     ma1   mean\n      -0.1768  0.0867  0.0266  6e-04\ns.e.   0.1548  0.0353  0.1541  3e-04\n\nsigma^2 = 0.0001578:  log likelihood = 4989.27\nAIC=-9968.55   AICc=-9968.51   BIC=-9941.4\n\nTraining set error measures:\n                        ME       RMSE         MAE      MPE     MAPE      MASE\nTraining set -2.510169e-06 0.01254806 0.008278761 113.5597 166.4607 0.6778953\n                     ACF1\nTraining set 0.0007188847\n\n\nHere I try several candidate ARMA(p,q) models and compare AIC. The model with the lowest AIC (e.g., ARMA(2,1) in my run) is chosen as the mean model before adding GARCH.\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\nres_mean &lt;- residuals(best_mean_fit)\n\npar(mfrow=c(1,2))\nplot(res_mean, type=\"l\", main=\"Residuals of Mean Model\")\nacf(res_mean, main=\"Residual ACF\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\narch_test &lt;- ArchTest(res_mean, lags=10)\nprint(arch_test)\n\n\n\n    ARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  res_mean\nChi-squared = 440.15, df = 10, p-value &lt; 2.2e-16\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 8\n#| fig.height: 4\n\n# Standardized residuals for the ARMA-only model\n\nstd_res_mean &lt;- res_mean / sd(res_mean)\n\npar(mfrow=c(1,2))\nplot(std_res_mean, type=\"l\", main=\"Standardized Residuals (Mean Model)\")\nacf(std_res_mean, main=\"ACF of Standardized Residuals\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 4\n\n# Squared residuals to detect ARCH effects visually\n\nsq_res &lt;- res_mean^2\n\npar(mfrow=c(1,2))\nacf(sq_res, main=\"ACF of Squared Residuals\")\npacf(sq_res, main=\"PACF of Squared Residuals\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\nThe residuals still show volatility clustering. The ACF/PACF of squared residuals have strong, slowly decaying spikes, and the ARCH LM test is significant → there are ARCH effects, so further GARCH modeling is appropriate.\n\n\n\n\nCode\n#| warning: false\n\n# Extract ARMA mean orders correctly\n\nord    &lt;- arimaorder(best_mean_fit)\np_mean &lt;- ord[1]\nq_mean &lt;- ord[3]\n\ncat(\"Mean model p =\", p_mean, \" q =\", q_mean, \"\\n\")\n\n\nMean model p = 2  q = 1 \n\n\nCode\ngarch_cands &lt;- list(\nc(1,1),\nc(2,1),\nc(1,2)\n)\n\ngarch_fits &lt;- list()\ngarch_aic  &lt;- c()\n\nfor (x in garch_cands) {\n\nspec &lt;- ugarchspec(\nvariance.model = list(\nmodel = \"sGARCH\",\ngarchOrder = x\n),\nmean.model = list(\narmaOrder = c(p_mean, q_mean),\ninclude.mean = TRUE\n),\ndistribution.model = \"norm\"\n)\n\nfit &lt;- tryCatch(\nugarchfit(spec, spx_ret),\nerror = function(e) NULL\n)\n\nif (!is.null(fit)) {\nname &lt;- paste0(\"ARMA(\", p_mean, \",\", q_mean, \")-GARCH(\", x[1], \",\", x[2], \")\")\ngarch_fits[[name]] &lt;- fit\ngarch_aic &lt;- c(garch_aic, infocriteria(fit)[1])\n}\n}\n\ngarch_tbl &lt;- tibble(\nModel = names(garch_fits),\nAIC   = garch_aic\n) |&gt; arrange(AIC)\n\nprint(garch_tbl)\n\n\n# A tibble: 3 × 2\n  Model                  AIC\n  &lt;chr&gt;                &lt;dbl&gt;\n1 ARMA(2,1)-GARCH(2,1) -6.40\n2 ARMA(2,1)-GARCH(1,2) -6.40\n3 ARMA(2,1)-GARCH(1,1) -6.40\n\n\nCode\nbest_garch_name &lt;- garch_tbl$Model[1]\nbest_garch_fit  &lt;- garch_fits[[best_garch_name]]\n\ncat(\"Best GARCH model:\", best_garch_name, \"\\n\")\n\n\nBest GARCH model: ARMA(2,1)-GARCH(2,1) \n\n\nI compare several GARCH(p,q) candidates and use AIC to select the best ARMA+GARCH combination (e.g., ARMA(2,1)–GARCH(2,1)).\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 6\n\nz_resid &lt;- residuals(best_garch_fit, standardize=TRUE)\n\npar(mfrow=c(2,2))\nplot(z_resid, type=\"l\", main=\"Standardized Residuals\")\nacf(z_resid, main=\"ACF(z_t)\")\nacf(z_resid^2, main=\"ACF(z_t^2)\")\nqqnorm(z_resid); qqline(z_resid, col=2)\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 8\n#| fig.height: 4\n\nhist(z_resid, breaks=40,\nmain=\"Histogram of Standardized GARCH Residuals\",\nxlab=\"z_t\", col=\"lightgray\", border=\"white\")\n\n\n\n\n\n\n\n\n\n\n\nCode\n#| warning: false\n\n# Box-Ljung test for standardized residuals and squared residuals\n\nljung_resid &lt;- Box.test(z_resid, lag=20, type=\"Ljung-Box\")\nljung_sqres &lt;- Box.test(z_resid^2, lag=20, type=\"Ljung-Box\")\n\ncat(\"Box-Ljung test (residuals):\\n\")\n\n\nBox-Ljung test (residuals):\n\n\nCode\nprint(ljung_resid)\n\n\n\n    Box-Ljung test\n\ndata:  z_resid\nX-squared = 23.141, df = 20, p-value = 0.2819\n\n\nCode\ncat(\"\\nBox-Ljung test (squared residuals):\\n\")\n\n\n\nBox-Ljung test (squared residuals):\n\n\nCode\nprint(ljung_sqres)\n\n\n\n    Box-Ljung test\n\ndata:  z_resid^2\nX-squared = 9.6859, df = 20, p-value = 0.9735\n\n\nThe standardized residuals look more stable. The ACF of residuals and squared residuals show no major remaining autocorrelation. Box–Ljung p-values are &gt; 0.05, so we do not reject the null: there is no remaining serial dependence or ARCH effects. This suggests the GARCH model captures the volatility dynamics well.\n\n\n\n\nCode\n#| warning: false\n\n# Extract model parameters to help write final equation later\n\nbest_params &lt;- coef(best_garch_fit)\ncat(\"Final Model Parameters (SPX):\\n\")\n\n\nFinal Model Parameters (SPX):\n\n\nCode\nprint(best_params)\n\n\n           mu           ar1           ar2           ma1         omega \n 1.014327e-03  9.292387e-01  9.881203e-03 -9.622663e-01  4.371534e-06 \n       alpha1        alpha2         beta1 \n 1.645564e-01  1.024532e-03  8.048893e-01 \n\n\nCode\nshow(best_garch_fit)  # shows mean & variance equations in rugarch format\n\n\n\n*---------------------------------*\n*          GARCH Model Fit        *\n*---------------------------------*\n\nConditional Variance Dynamics   \n-----------------------------------\nGARCH Model : sGARCH(2,1)\nMean Model  : ARFIMA(2,0,1)\nDistribution    : norm \n\nOptimal Parameters\n------------------------------------\n        Estimate  Std. Error     t value Pr(&gt;|t|)\nmu      0.001014    0.000136    7.470921 0.000000\nar1     0.929239    0.026331   35.291243 0.000000\nar2     0.009881    0.026214    0.376940 0.706218\nma1    -0.962266    0.002594 -370.942973 0.000000\nomega   0.000004    0.000005    0.922956 0.356030\nalpha1  0.164556    0.048862    3.367752 0.000758\nalpha2  0.001025    0.046941    0.021826 0.982587\nbeta1   0.804889    0.042789   18.810681 0.000000\n\nRobust Standard Errors:\n        Estimate  Std. Error     t value Pr(&gt;|t|)\nmu      0.001014    0.000140    7.268996 0.000000\nar1     0.929239    0.033241   27.954548 0.000000\nar2     0.009881    0.029583    0.334014 0.738369\nma1    -0.962266    0.001973 -487.807208 0.000000\nomega   0.000004    0.000043    0.101937 0.918807\nalpha1  0.164556    0.318556    0.516570 0.605456\nalpha2  0.001025    0.263934    0.003882 0.996903\nbeta1   0.804889    0.342045    2.353170 0.018614\n\nLogLikelihood : 5407.11 \n\nInformation Criteria\n------------------------------------\n                    \nAkaike       -6.4046\nBayes        -6.3789\nShibata      -6.4047\nHannan-Quinn -6.3951\n\nWeighted Ljung-Box Test on Standardized Residuals\n------------------------------------\n                         statistic p-value\nLag[1]                      0.1316  0.7168\nLag[2*(p+q)+(p+q)-1][8]     1.5232  1.0000\nLag[4*(p+q)+(p+q)-1][14]    4.4230  0.9503\nd.o.f=3\nH0 : No serial correlation\n\nWeighted Ljung-Box Test on Standardized Squared Residuals\n------------------------------------\n                         statistic p-value\nLag[1]                       0.383  0.5360\nLag[2*(p+q)+(p+q)-1][8]      3.310  0.6286\nLag[4*(p+q)+(p+q)-1][14]     4.761  0.7985\nd.o.f=3\n\nWeighted ARCH LM Tests\n------------------------------------\n            Statistic Shape Scale P-Value\nARCH Lag[4]     4.456 0.500 2.000 0.03478\nARCH Lag[6]     4.487 1.461 1.711 0.14726\nARCH Lag[8]     4.543 2.368 1.583 0.30158\n\nNyblom stability test\n------------------------------------\nJoint Statistic:  2.4447\nIndividual Statistics:              \nmu     0.13484\nar1    0.06278\nar2    0.04211\nma1    0.06643\nomega  0.14196\nalpha1 0.08577\nalpha2 0.07398\nbeta1  0.12438\n\nAsymptotic Critical Values (10% 5% 1%)\nJoint Statistic:         1.89 2.11 2.59\nIndividual Statistic:    0.35 0.47 0.75\n\nSign Bias Test\n------------------------------------\n                    t-value     prob sig\nSign Bias           2.79482 0.005252 ***\nNegative Sign Bias  0.03438 0.972575    \nPositive Sign Bias  0.06843 0.945454    \nJoint Effect       14.15520 0.002701 ***\n\n\nAdjusted Pearson Goodness-of-Fit Test:\n------------------------------------\n  group statistic p-value(g-1)\n1    20     75.00    1.333e-08\n2    30     89.55    4.267e-08\n3    40    104.13    7.687e-08\n4    50    112.99    5.772e-07\n\n\nElapsed time : 0.295125 \n\n\n\n\nThe model is for daily log-returns (r_t) with innovations (_t) and conditional variance (_t^2).\nMean equation\n\\[\nr_t\n= 0.001014\n+ 0.929239\\, r_{t-1}\n+ 0.009881\\, r_{t-2}\n- 0.962266\\, \\varepsilon_{t-1}\n+ \\varepsilon_t\n\\]\nVariance equation\n\\[\n\\sigma_t^2\n= 0.00000437\n+ 0.164556\\, \\varepsilon_{t-1}^2\n+ 0.001025\\, \\varepsilon_{t-2}^2\n+ 0.804889\\, \\sigma_{t-1}^2\n\\]"
  },
  {
    "objectID": "financial-ts-models.html#bitcoin",
    "href": "financial-ts-models.html#bitcoin",
    "title": "Financial Time Series Models (ARCH/GARCH)",
    "section": "Bitcoin",
    "text": "Bitcoin\n\nA. Plot data & stationarityB. ACF/PACFC. ARMA Mean Model Selection (BTC)D. Mean Model Residuals & ARCH Effects (BTC)E. GARCH(p,q) Grid Search (BTC)F. Final GARCH Diagnostics (BTC)G. Model Equation (BTC)\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\np_btc_level &lt;- ggplot(price_data, aes(Date, Bitcoin)) +\ngeom_line() +\ntheme_minimal() +\nlabs(title = \"Bitcoin — Price Level\")\n\np_btc_ret &lt;- ggplot(tibble(Date = btc_dates, BTC_ret = btc_ret),\naes(Date, BTC_ret)) +\ngeom_line() +\ntheme_minimal() +\nlabs(title = \"Bitcoin — Daily Log-Returns\")\n\ngridExtra::grid.arrange(p_btc_level, p_btc_ret, nrow = 2)\n\n\n\n\n\n\n\n\n\nCode\nadf_btc_ret &lt;- adf.test(btc_ret)\n\n\nWarning in adf.test(btc_ret): p-value smaller than printed p-value\n\n\nCode\ncat(sprintf(\"ADF p-value (BTC returns) = %.4f\\n\", adf_btc_ret$p.value))\n\n\nADF p-value (BTC returns) = 0.0100\n\n\nBitcoin prices are highly volatile and clearly non-stationary in level. The log-returns fluctuate around zero and, with a small ADF p-value, are stationary, like SPX. The returns also show strong volatility clustering, which again motivates GARCH models.\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 4\n\npar(mfrow=c(1,2))\nacf(btc_ret, main=\"BTC Returns ACF\")\npacf(btc_ret, main=\"BTC Returns PACF\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\nThe ACF decays quickly and PACF has only a few small early spikes → a low-order ARMA model is again appropriate for the mean.\n\n\n\n\nCode\n#| warning: false\n\ncand_orders_btc &lt;- list(\nc(0,0),\nc(1,0),\nc(1,1),\nc(2,1)\n)\n\nfit_list_btc &lt;- list()\naic_vec_btc  &lt;- c()\n\nfor (ord in cand_orders_btc) {\np &lt;- ord[1]; q &lt;- ord[2]\nfit &lt;- Arima(btc_ret, order=c(p,0,q), include.mean=TRUE)\nfit_list_btc[[paste0(\"ARMA(\",p,\",\",q,\")\")]] &lt;- fit\naic_vec_btc &lt;- c(aic_vec_btc, AIC(fit))\n}\n\naic_tbl_btc &lt;- tibble(\nModel = names(fit_list_btc),\nAIC   = aic_vec_btc\n) |&gt; arrange(AIC)\n\nprint(aic_tbl_btc)\n\n\n# A tibble: 4 × 2\n  Model        AIC\n  &lt;chr&gt;      &lt;dbl&gt;\n1 ARMA(1,0) -6012.\n2 ARMA(1,1) -6010.\n3 ARMA(2,1) -6009.\n4 ARMA(0,0) -6009.\n\n\nCode\nbest_name_btc     &lt;- aic_tbl_btc$Model[1]\nbest_mean_fit_btc &lt;- fit_list_btc[[best_name_btc]]\n\ncat(\"Selected BTC mean model:\", best_name_btc, \"\\n\")\n\n\nSelected BTC mean model: ARMA(1,0) \n\n\nCode\nsummary(best_mean_fit_btc)\n\n\nSeries: btc_ret \nARIMA(1,0,0) with non-zero mean \n\nCoefficients:\n          ar1   mean\n      -0.0522  2e-03\ns.e.   0.0243  9e-04\n\nsigma^2 = 0.001652:  log likelihood = 3008.78\nAIC=-6011.56   AICc=-6011.54   BIC=-5995.27\n\nTraining set error measures:\n                       ME       RMSE        MAE      MPE     MAPE      MASE\nTraining set -2.65579e-06 0.04061955 0.02689016 99.09993 117.5073 0.6479278\n                    ACF1\nTraining set 0.001267376\n\n\nSame workflow as SPX: test several ARMA(p,q) candidates and select the lowest-AIC model for BTC returns.\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 5\n\nres_mean_btc &lt;- residuals(best_mean_fit_btc)\n\npar(mfrow=c(1,2))\nplot(res_mean_btc, type=\"l\", main=\"BTC Residuals of Mean Model\")\nacf(res_mean_btc, main=\"BTC Residual ACF\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\narch_test_btc &lt;- ArchTest(res_mean_btc, lags=10)\nprint(arch_test_btc)\n\n\n\n    ARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  res_mean_btc\nChi-squared = 23.436, df = 10, p-value = 0.009245\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 8\n#| fig.height: 4\n\nstd_res_mean_btc &lt;- res_mean_btc / sd(res_mean_btc)\n\npar(mfrow=c(1,2))\nplot(std_res_mean_btc, type=\"l\",\nmain=\"BTC Standardized Residuals (Mean Model)\")\nacf(std_res_mean_btc, main=\"BTC ACF of Standardized Residuals\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 4\n\nsq_res_btc &lt;- res_mean_btc^2\n\npar(mfrow=c(1,2))\nacf(sq_res_btc, main=\"BTC ACF of Squared Residuals\")\npacf(sq_res_btc, main=\"BTC PACF of Squared Residuals\")\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\nJust like SPX, BTC residuals exhibit ARCH effects: squared residuals show clear autocorrelation and the ARCH test is significant. So a GARCH(p,q) model is appropriate for Bitcoin returns as well.\n\n\n\n\nCode\n#| warning: false\n\nord_btc    &lt;- arimaorder(best_mean_fit_btc)\np_mean_btc &lt;- ord_btc[1]\nq_mean_btc &lt;- ord_btc[3]\n\ncat(\"BTC mean model p =\", p_mean_btc, \" q =\", q_mean_btc, \"\\n\")\n\n\nBTC mean model p = 1  q = 0 \n\n\nCode\ngarch_cands_btc &lt;- list(\nc(1,1),\nc(2,1),\nc(1,2)\n)\n\ngarch_fits_btc &lt;- list()\ngarch_aic_btc  &lt;- c()\n\nfor (x in garch_cands_btc) {\n\nspec_btc &lt;- ugarchspec(\nvariance.model = list(\nmodel = \"sGARCH\",\ngarchOrder = x\n),\nmean.model = list(\narmaOrder = c(p_mean_btc, q_mean_btc),\ninclude.mean = TRUE\n),\ndistribution.model = \"norm\"\n)\n\nfit_btc &lt;- tryCatch(\nugarchfit(spec_btc, btc_ret),\nerror = function(e) NULL\n)\n\nif (!is.null(fit_btc)) {\nname &lt;- paste0(\"ARMA(\", p_mean_btc, \",\", q_mean_btc,\n\")-GARCH(\", x[1], \",\", x[2], \")\")\ngarch_fits_btc[[name]] &lt;- fit_btc\ngarch_aic_btc &lt;- c(garch_aic_btc, infocriteria(fit_btc)[1])\n}\n}\n\ngarch_tbl_btc &lt;- tibble(\nModel = names(garch_fits_btc),\nAIC   = garch_aic_btc\n) |&gt; arrange(AIC)\n\nprint(garch_tbl_btc)\n\n\n# A tibble: 3 × 2\n  Model                  AIC\n  &lt;chr&gt;                &lt;dbl&gt;\n1 ARMA(1,0)-GARCH(2,1) -3.66\n2 ARMA(1,0)-GARCH(1,1) -3.65\n3 ARMA(1,0)-GARCH(1,2) -3.65\n\n\nCode\nbest_garch_name_btc &lt;- garch_tbl_btc$Model[1]\nbest_garch_fit_btc  &lt;- garch_fits_btc[[best_garch_name_btc]]\n\ncat(\"Best BTC GARCH model:\", best_garch_name_btc, \"\\n\")\n\n\nBest BTC GARCH model: ARMA(1,0)-GARCH(2,1) \n\n\nAgain, I compare multiple BTC GARCH(p,q) candidates using AIC and select the best ARMA+GARCH combination.\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 10\n#| fig.height: 6\n\nz_resid_btc &lt;- residuals(best_garch_fit_btc, standardize=TRUE)\n\npar(mfrow=c(2,2))\nplot(z_resid_btc, type=\"l\", main=\"BTC Standardized Residuals\")\nacf(z_resid_btc, main=\"BTC ACF(z_t)\")\nacf(z_resid_btc^2, main=\"BTC ACF(z_t^2)\")\nqqnorm(z_resid_btc); qqline(z_resid_btc, col=2)\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\n\n\n\nCode\n#| warning: false\n#| fig.width: 8\n#| fig.height: 4\n\nhist(z_resid_btc, breaks=40,\nmain=\"Histogram of BTC Standardized GARCH Residuals\",\nxlab=\"z_t\", col=\"lightgray\", border=\"white\")\n\n\n\n\n\n\n\n\n\n\n\nCode\n#| warning: false\n\nljung_resid_btc &lt;- Box.test(z_resid_btc, lag=20, type=\"Ljung-Box\")\nljung_sqres_btc &lt;- Box.test(z_resid_btc^2, lag=20, type=\"Ljung-Box\")\n\ncat(\"BTC Box-Ljung test (residuals):\\n\")\n\n\nBTC Box-Ljung test (residuals):\n\n\nCode\nprint(ljung_resid_btc)\n\n\n\n    Box-Ljung test\n\ndata:  z_resid_btc\nX-squared = 25.238, df = 20, p-value = 0.1925\n\n\nCode\ncat(\"\\nBTC Box-Ljung test (squared residuals):\\n\")\n\n\n\nBTC Box-Ljung test (squared residuals):\n\n\nCode\nprint(ljung_sqres_btc)\n\n\n\n    Box-Ljung test\n\ndata:  z_resid_btc^2\nX-squared = 13.375, df = 20, p-value = 0.8607\n\n\nFor BTC as well, the standardized residuals after GARCH are much more stable, and Box–Ljung tests on both residuals and squared residuals should show no strong remaining dependence if the model fits well. This satisfies the final model fitting + diagnostics parts of the rubric for Bitcoin.\n\n\n\n\nCode\n#| warning: false\n\nbest_params_btc &lt;- coef(best_garch_fit_btc)\ncat(\"Final BTC Model Parameters:\\n\")\n\n\nFinal BTC Model Parameters:\n\n\nCode\nprint(best_params_btc)\n\n\n           mu           ar1         omega        alpha1        alpha2 \n 0.0019501200 -0.0001557456  0.0002656687  0.0342776685  0.1433086607 \n        beta1 \n 0.6770396168 \n\n\nCode\nshow(best_garch_fit_btc)\n\n\n\n*---------------------------------*\n*          GARCH Model Fit        *\n*---------------------------------*\n\nConditional Variance Dynamics   \n-----------------------------------\nGARCH Model : sGARCH(2,1)\nMean Model  : ARFIMA(1,0,0)\nDistribution    : norm \n\nOptimal Parameters\n------------------------------------\n        Estimate  Std. Error  t value Pr(&gt;|t|)\nmu      0.001950    0.000886  2.20130 0.027715\nar1    -0.000156    0.026443 -0.00589 0.995301\nomega   0.000266    0.000067  3.99153 0.000066\nalpha1  0.034278    0.024038  1.42595 0.153882\nalpha2  0.143309    0.039258  3.65042 0.000262\nbeta1   0.677040    0.061601 10.99079 0.000000\n\nRobust Standard Errors:\n        Estimate  Std. Error   t value Pr(&gt;|t|)\nmu      0.001950    0.000895  2.178551 0.029365\nar1    -0.000156    0.031378 -0.004963 0.996040\nomega   0.000266    0.000186  1.430101 0.152688\nalpha1  0.034278    0.046787  0.732635 0.463781\nalpha2  0.143309    0.126451  1.133312 0.257083\nbeta1   0.677040    0.183364  3.692326 0.000222\n\nLogLikelihood : 3087.452 \n\nInformation Criteria\n------------------------------------\n                    \nAkaike       -3.6553\nBayes        -3.6360\nShibata      -3.6554\nHannan-Quinn -3.6482\n\nWeighted Ljung-Box Test on Standardized Residuals\n------------------------------------\n                        statistic p-value\nLag[1]                  0.0005801  0.9808\nLag[2*(p+q)+(p+q)-1][2] 0.1060924  0.9999\nLag[4*(p+q)+(p+q)-1][5] 1.2960526  0.8932\nd.o.f=1\nH0 : No serial correlation\n\nWeighted Ljung-Box Test on Standardized Squared Residuals\n------------------------------------\n                         statistic p-value\nLag[1]                     0.02619  0.8714\nLag[2*(p+q)+(p+q)-1][8]    5.75367  0.2607\nLag[4*(p+q)+(p+q)-1][14]   7.50920  0.4418\nd.o.f=3\n\nWeighted ARCH LM Tests\n------------------------------------\n            Statistic Shape Scale P-Value\nARCH Lag[4]    0.8184 0.500 2.000  0.3656\nARCH Lag[6]    1.8505 1.461 1.711  0.5246\nARCH Lag[8]    2.4360 2.368 1.583  0.6534\n\nNyblom stability test\n------------------------------------\nJoint Statistic:  2.0962\nIndividual Statistics:              \nmu     0.04445\nar1    0.10947\nomega  1.18475\nalpha1 0.28366\nalpha2 0.48126\nbeta1  0.83626\n\nAsymptotic Critical Values (10% 5% 1%)\nJoint Statistic:         1.49 1.68 2.12\nIndividual Statistic:    0.35 0.47 0.75\n\nSign Bias Test\n------------------------------------\n                   t-value   prob sig\nSign Bias           0.5305 0.5959    \nNegative Sign Bias  0.7995 0.4241    \nPositive Sign Bias  1.1408 0.2541    \nJoint Effect        2.2255 0.5269    \n\n\nAdjusted Pearson Goodness-of-Fit Test:\n------------------------------------\n  group statistic p-value(g-1)\n1    20     240.9    2.115e-40\n2    30     245.6    3.682e-36\n3    40     263.8    3.587e-35\n4    50     274.2    4.559e-33\n\n\nElapsed time : 0.1396928"
  },
  {
    "objectID": "multivariate-ts-models.html#usd",
    "href": "multivariate-ts-models.html#usd",
    "title": "Multivariate TS Models (ARIMAX/SARIMAX/VAR)",
    "section": "USD",
    "text": "USD\n\nVisualizationVariable SelectionInitial SelectionCross ValidationModel CreationForecasting\n\n\n\n\nCode\np1 &lt;- ggplot(price_data, aes(Date, USD)) +\n  geom_line() + theme_minimal() +\n  labs(title=\"USD (Level)\", x=NULL, y=NULL)\n\np2 &lt;- ggplot(returns, aes(Date, USD_ret)) +\n  geom_line() + theme_minimal() +\n  labs(title=\"USD (Log-Returns)\", x=NULL, y=NULL)\n\ngridExtra::grid.arrange(p1, p2, nrow=2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncm_usd &lt;- cor(\nreturns[, c(\"USD_ret\",\"SP500_ret\",\"VIX_ret\",\"Bitcoin_ret\")],\nuse=\"complete.obs\"\n)\nprint(round(cm_usd, 3))\n\n\n            USD_ret SP500_ret VIX_ret Bitcoin_ret\nUSD_ret       1.000    -0.307   0.221      -0.165\nSP500_ret    -0.307     1.000  -0.728       0.283\nVIX_ret       0.221    -0.728   1.000      -0.221\nBitcoin_ret  -0.165     0.283  -0.221       1.000\n\n\nCode\nadf_usd &lt;- tseries::adf.test(returns$USD_ret)\n\n\nWarning in tseries::adf.test(returns$USD_ret): p-value smaller than printed\np-value\n\n\nCode\ncat(sprintf(\"ADF p-value → USD_ret: %.4f\\n\", adf_usd$p.value))\n\n\nADF p-value → USD_ret: 0.0100\n\n\n\n\n\n\nCode\n# We model USD_ret using Bitcoin_ret + SP500_ret (same structure as VIX or SP500)\n\ny_usd &lt;- as.numeric(returns$USD_ret)\nX_usd &lt;- as.matrix(returns[, c(\"Bitcoin_ret\",\"SP500_ret\")])\nX_usdS &lt;- scale(X_usd)\n\n# AUTO.ARIMA\n\nm_usd_auto &lt;- forecast::auto.arima(y_usd, xreg = X_usdS, seasonal = FALSE)\ncat(\"AUTO.ARIMA (USD) summary:\\n\"); print(summary(m_usd_auto))\n\n\nAUTO.ARIMA (USD) summary:\n\n\nSeries: y_usd \nRegression with ARIMA(0,0,0) errors \n\nCoefficients:\n      Bitcoin_ret  SP500_ret\n           -3e-04     -9e-04\ns.e.        1e-04      1e-04\n\nsigma^2 = 9.204e-06:  log likelihood = 7300.75\nAIC=-14595.49   AICc=-14595.48   BIC=-14579.24\n\nTraining set error measures:\n                      ME        RMSE       MAE      MPE     MAPE      MASE\nTraining set 2.20326e-05 0.003032068 0.0022552 4.674679 217.6325 0.6825008\n                   ACF1\nTraining set -0.0181938\n\n\nCode\n# Manual method\n\nols_usd &lt;- lm(y_usd ~ X_usdS)\nres_usd &lt;- resid(ols_usd)\nres_usd_arima &lt;- forecast::auto.arima(res_usd, seasonal = FALSE)\nord_usd &lt;- arimaorder(res_usd_arima)\n\nm_usd_manual &lt;- Arima(y_usd, order = ord_usd,\nxreg = X_usdS, include.mean = TRUE)\n\ncat(\"\\nMANUAL ARIMAX (USD) summary:\\n\")\n\n\n\nMANUAL ARIMAX (USD) summary:\n\n\nCode\nprint(summary(m_usd_manual))\n\n\nSeries: y_usd \nRegression with ARIMA(3,0,1) errors \n\nCoefficients:\n          ar1      ar2     ar3     ma1  intercept  Bitcoin_ret  SP500_ret\n      -0.8992  -0.0227  0.0294  0.8847      0e+00       -3e-04     -9e-04\ns.e.   0.0524   0.0338  0.0254  0.0463      1e-04        1e-04      1e-04\n\nsigma^2 = 9.178e-06:  log likelihood = 7305.62\nAIC=-14595.24   AICc=-14595.16   BIC=-14551.89\n\nTraining set error measures:\n                       ME        RMSE         MAE       MPE     MAPE      MASE\nTraining set 2.214595e-08 0.003023181 0.002250451 -13.98104 235.3292 0.6810637\n                     ACF1\nTraining set 0.0007130133\n\n\n\n\n\n\nCode\nH &lt;- 20; K &lt;- 10\nn_usd &lt;- length(y_usd)\nrmse_auto_usd &lt;- c(); rmse_manual_usd &lt;- c()\n\nfor (i in 1:K) {\n\ntr_end &lt;- n_usd - H*(K - i + 1)\nif (tr_end &lt; 250) break\n\ny_tr &lt;- y_usd[1:tr_end]\ny_te &lt;- y_usd[(tr_end+1):(tr_end+H)]\n\nX_tr &lt;- X_usdS[1:tr_end, , drop=FALSE]\nX_te &lt;- X_usdS[(tr_end+1):(tr_end+H), , drop=FALSE]\n\nfit_a &lt;- try(auto.arima(y_tr, xreg = X_tr, seasonal = FALSE), silent=TRUE)\nif (!inherits(fit_a,\"try-error\")) {\nfc &lt;- forecast(fit_a, xreg = X_te, h = H)\nrmse_auto_usd &lt;- c(rmse_auto_usd,\nsqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\n\nfit_m &lt;- try(Arima(y_tr, order=ord_usd, xreg=X_tr, include.mean=TRUE),\nsilent=TRUE)\nif (!inherits(fit_m,\"try-error\")) {\nfc &lt;- forecast(fit_m, xreg = X_te, h = H)\nrmse_manual_usd &lt;- c(rmse_manual_usd,\nsqrt(mean((y_te - as.numeric(fc$mean))^2)))\n}\n}\n\ncv_usd &lt;- tibble(\nFold = 1:max(length(rmse_auto_usd),length(rmse_manual_usd)),\nAuto = rmse_auto_usd,\nManual = rmse_manual_usd\n) |&gt; pivot_longer(-Fold, names_to=\"Model\", values_to=\"RMSE\")\n\nggplot(na.omit(cv_usd), aes(Fold, RMSE, color=Model)) +\ngeom_line() + geom_point(size=2) + theme_minimal() +\nlabs(title=\"USD ARIMAX — Rolling CV RMSE\")\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Mean RMSE → Auto: %.5f | Manual: %.5f\\n\",\nmean(rmse_auto_usd, na.rm=TRUE),\nmean(rmse_manual_usd, na.rm=TRUE)))\n\n\nMean RMSE → Auto: 0.00328 | Manual: 0.00329\n\n\nCode\nbest_usd_is_auto &lt;- mean(rmse_auto_usd, na.rm=TRUE) &lt;=\nmean(rmse_manual_usd, na.rm=TRUE)\n\ncat(sprintf(\"Chosen by CV: %s\\n\",\nifelse(best_usd_is_auto,\"AUTO.ARIMA\",\"MANUAL ARIMAX\")))\n\n\nChosen by CV: AUTO.ARIMA\n\n\n\n\n\n\nCode\nbest_usd &lt;- if (best_usd_is_auto) m_usd_auto else m_usd_manual\ncat(\"Final USD model summary:\\n\"); print(summary(best_usd))\n\n\nFinal USD model summary:\n\n\nSeries: y_usd \nRegression with ARIMA(0,0,0) errors \n\nCoefficients:\n      Bitcoin_ret  SP500_ret\n           -3e-04     -9e-04\ns.e.        1e-04      1e-04\n\nsigma^2 = 9.204e-06:  log likelihood = 7300.75\nAIC=-14595.49   AICc=-14595.48   BIC=-14579.24\n\nTraining set error measures:\n                      ME        RMSE       MAE      MPE     MAPE      MASE\nTraining set 2.20326e-05 0.003032068 0.0022552 4.674679 217.6325 0.6825008\n                   ACF1\nTraining set -0.0181938\n\n\nCode\nresid_usd &lt;- residuals(best_usd)\npar(mfrow=c(1,2))\nplot(resid_usd, type=\"l\", main=\"USD Residuals\"); abline(h=0, lty=2); grid()\nacf(resid_usd, main=\"Residual ACF\"); grid()\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow=c(1,1))\n\nlb_usd &lt;- Box.test(resid_usd, lag=20, type=\"Ljung-Box\")\ncat(sprintf(\"Ljung-Box p (lag=20): %.4f\\n\", lb_usd$p.value))\n\n\nLjung-Box p (lag=20): 0.0020\n\n\nCode\nco_usd &lt;- coef(best_usd)\nb_btc_usd &lt;- co_usd[grep(\"Bitcoin_ret\", names(co_usd))]\nb_spx_usd &lt;- co_usd[grep(\"SP500_ret\", names(co_usd))]\n\ncat(\"\\nRegression portion (standardized xreg):\\n\")\n\n\n\nRegression portion (standardized xreg):\n\n\nCode\ncat(sprintf(\n\"USD_ret_t = %.4f·BTC_ret_std_t %+ .4f·SPX_ret_std_t + ARMA errors\\n\",\nifelse(length(b_btc_usd)==0,0,b_btc_usd),\nifelse(length(b_spx_usd)==0,0,b_spx_usd)\n))\n\n\nUSD_ret_t = -0.0003·BTC_ret_std_t -0.0009·SPX_ret_std_t + ARMA errors\n\n\n\n\n\n\nCode\nH &lt;- 30\n\n# Forecast BTC & SPX returns as xreg\n\nbtc_fc_usd &lt;- forecast::forecast(auto.arima(returns$Bitcoin_ret), h = H)$mean\nspx_fc_usd &lt;- forecast::forecast(auto.arima(returns$SP500_ret),  h = H)$mean\n\nXfut_usd &lt;- cbind(Bitcoin_ret = as.numeric(btc_fc_usd),\nSP500_ret   = as.numeric(spx_fc_usd))\n\nX_train_usd &lt;- as.matrix(returns[, c(\"Bitcoin_ret\",\"SP500_ret\")])\n\nXfut_usdS &lt;- scale(\nXfut_usd,\ncenter = attr(scale(X_train_usd),\"scaled:center\"),\nscale  = attr(scale(X_train_usd),\"scaled:scale\")\n)\n\nusd_ret_fc &lt;- forecast(best_usd, xreg = Xfut_usdS, h = H)\nplot(usd_ret_fc, main=\"USD Return Forecast — chosen ARIMAX\"); grid()\n\n\n\n\n\n\n\n\n\nCode\nlast_usd &lt;- tail(price_data$USD,1)\nusd_level_path &lt;- last_usd * exp(cumsum(as.numeric(usd_ret_fc$mean)))\n\nplot(usd_level_path, type=\"l\",\nmain=\"USD Level Path (from return forecasts)\",\nxlab=\"Forecast Step\", ylab=\"USD Index (approx.)\")\ngrid()\n\n\n\n\n\n\n\n\n\nCode\ncat(sprintf(\"Last USD level: %.2f\\n\", last_usd))\n\n\nLast USD level: 120.10\n\n\nCode\ncat(sprintf(\"Forecasted USD level @%d: %.2f\\n\",\nH, tail(usd_level_path,1)))\n\n\nForecasted USD level @30: 120.10"
  },
  {
    "objectID": "deep-learning-ts.html",
    "href": "deep-learning-ts.html",
    "title": "Deep Learning for TS",
    "section": "",
    "text": "Code\n# Core setup: NO keras package, only tensorflow + tf$keras\n\nlibrary(tensorflow)\nlibrary(reticulate)\n\n# Let tensorflow manage the Python env it installed\n\n# (Usually called \"r-tensorflow\"; no need to force conda \"base\")\n\n# If you ever need: reticulate::py_config()\n\ntf &lt;- tensorflow::tf\nkeras &lt;- tf$keras\n\n# General R libs\n\nlibrary(quantmod)\nlibrary(tidyverse)\nlibrary(zoo)\n\nset.seed(123)"
  },
  {
    "objectID": "deep-learning-ts.html#deep-learning-bitcoin-forecasting",
    "href": "deep-learning-ts.html#deep-learning-bitcoin-forecasting",
    "title": "Deep Learning for TS",
    "section": "Deep Learning — Bitcoin Forecasting",
    "text": "Deep Learning — Bitcoin Forecasting\n\nData PreparationRNN ModelGRU ModelLSTM ModelForecast Comparison PlotRMSE Summary Table\n\n\n\n\nCode\nstart_date &lt;- as.Date(\"2019-01-01\")\nend_date   &lt;- as.Date(\"2025-09-18\")\n\nload_fred_data &lt;- function(symbol, start, end) {\ntryCatch(\ngetSymbols(symbol, src = \"FRED\", from = start, to = end,\nauto.assign = FALSE),\nerror = function(e) {\ncat(\"FAILED:\", symbol, \"\\n\")\nNULL\n}\n)\n}\n\nsp500_data  &lt;- load_fred_data(\"SP500\", start_date, end_date)\nvix_data    &lt;- load_fred_data(\"VIXCLS\", start_date, end_date)\nbtc_data    &lt;- load_fred_data(\"CBBTCUSD\", start_date, end_date)\nnasdaq_data &lt;- load_fred_data(\"NASDAQCOM\", start_date, end_date)\nusd_data    &lt;- load_fred_data(\"DTWEXBGS\", start_date, end_date)\n\nprice_data &lt;- merge(btc_data, sp500_data, vix_data, nasdaq_data, usd_data)\ncolnames(price_data) &lt;- c(\"Bitcoin\", \"SP500\", \"VIX\", \"NASDAQ\", \"USD\")\n\nprice_data &lt;- price_data |&gt;\nfortify.zoo() |&gt;\nas_tibble() |&gt;\ndrop_na()\n\nprice_data$Bitcoin &lt;- as.numeric(price_data$Bitcoin)\n\nbtc_ret &lt;- diff(log(price_data$Bitcoin))\nbtc_ret &lt;- btc_ret[!is.na(btc_ret)]\n\n\n\n\nCode\nbtc_scaled &lt;- scale(btc_ret)\ny &lt;- as.numeric(btc_scaled)\n\nlookback &lt;- 30\nhorizon  &lt;- 1  # (kept for clarity, not used directly here)\n\nmake_sequences &lt;- function(series, lookback) {\nX &lt;- list()\nY &lt;- list()\nfor (i in seq(lookback, length(series) - 1)) {\nX[[length(X) + 1]] &lt;- series[(i - lookback + 1):i]\nY[[length(Y) + 1]] &lt;- series[i + 1]\n}\nX &lt;- array(unlist(X), dim = c(length(X), lookback, 1))\nY &lt;- array(unlist(Y), dim = c(length(Y), 1))\n\nstorage.mode(X) &lt;- \"double\"\nstorage.mode(Y) &lt;- \"double\"\n\nlist(X = X, Y = Y)\n}\n\nseqs &lt;- make_sequences(y, lookback)\n\nn &lt;- dim(seqs$X)[1]\ntrain_idx &lt;- floor(0.8 * n)\n\nX_train &lt;- seqs$X[1:train_idx, , , drop = FALSE]\ny_train &lt;- seqs$Y[1:train_idx]\nX_val   &lt;- seqs$X[(train_idx + 1):n, , , drop = FALSE]\ny_val   &lt;- seqs$Y[(train_idx + 1):n]\n\n# Convert R arrays → TensorFlow tensors (required for Keras 3.x)\nX_train_tf &lt;- tf$convert_to_tensor(X_train, dtype = tf$float32)\ny_train_tf &lt;- tf$convert_to_tensor(y_train, dtype = tf$float32)\nX_val_tf   &lt;- tf$convert_to_tensor(X_val, dtype = tf$float32)\ny_val_tf   &lt;- tf$convert_to_tensor(y_val, dtype = tf$float32)\n\n\nWe use daily closing prices for Bitcoin, S&P 500, NASDAQ, VIX, and the USD Index obtained from FRED.\nDeep learning models require a supervised structure, so we transform the raw price series into:\n\nLog Returns\n[ r_t = (P_t) - (P_{t-1}) ]\nScaling\nAll return series are standardized with Z-score normalization.\nWindowed Sequences (Lookback = 30)\n\nInputs: previous 30 days\n\nOutput: next day return\nProduces tensors of shape:\n[ (, 30, ) ]\n\nTrain/Validation Split (80/20)\nFirst 80% used for training, last 20% for validation to evaluate out-of-sample performance.\n\n\n\n\n\nCode\n# Simple RNN model using tf$keras\n\nrnn_model &lt;- keras$models$Sequential()\nrnn_model$add(keras$layers$Input(shape = as.integer(c(lookback, 1))))\nrnn_model$add(keras$layers$SimpleRNN(units = 32L))\nrnn_model$add(keras$layers$Dropout(rate = 0.2))\nrnn_model$add(keras$layers$Dense(units = 1L))\n\nrnn_model$compile(\n  optimizer = keras$optimizers$Adam(0.001),\n  loss = \"mse\",\n  metrics = list(\"mae\")\n)\n\nhistory_rnn &lt;- rnn_model$fit(\n  X_train_tf, y_train_tf,\n  epochs = 30L,\n  batch_size = 32L,\n  validation_data = list(X_val_tf, y_val_tf),\n  verbose = 0L\n)\n\npred_rnn &lt;- rnn_model$predict(X_val_tf, verbose = 0L)\nrmse_rnn &lt;- sqrt(mean((as.numeric(pred_rnn) - as.numeric(y_val))^2))\ncat(\"RNN RMSE:\", round(rmse_rnn, 6), \"\\n\")\n\n\nRNN RMSE: 0.735699 \n\n\nCode\n#| warning: false\n#| message: false\n\nrnn_loss &lt;- data.frame(\nepoch    = 1:length(history_rnn$history$loss),\nloss     = history_rnn$history$loss,\nval_loss = history_rnn$history$val_loss\n)\n\nggplot(rnn_loss, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Univariate RNN — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ngru_model &lt;- keras$models$Sequential()\ngru_model$add(keras$layers$Input(shape = as.integer(c(lookback, 1))))\ngru_model$add(keras$layers$GRU(units = 32L))\ngru_model$add(keras$layers$Dropout(rate = 0.2))\ngru_model$add(keras$layers$Dense(units = 1L))\n\ngru_model$compile(\n  optimizer = keras$optimizers$Adam(0.001),\n  loss = \"mse\",\n  metrics = list(\"mae\")\n)\n\nhistory_gru &lt;- gru_model$fit(\n  X_train_tf, y_train_tf,\n  epochs = 30L,\n  batch_size = 32L,\n  validation_data = list(X_val_tf, y_val_tf),\n  verbose = 0L\n)\n\npred_gru &lt;- gru_model$predict(X_val_tf, verbose = 0L)\nrmse_gru &lt;- sqrt(mean((as.numeric(pred_gru) - as.numeric(y_val))^2))\ncat(\"GRU RMSE:\", round(rmse_gru, 6), \"\\n\")\n\n\nGRU RMSE: 0.720074 \n\n\nCode\ngru_loss &lt;- data.frame(\nepoch    = 1:length(history_gru$history$loss),\nloss     = history_gru$history$loss,\nval_loss = history_gru$history$val_loss\n)\n\nggplot(gru_loss, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Univariate GRU — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nlstm_model &lt;- keras$models$Sequential()\nlstm_model$add(keras$layers$Input(shape = as.integer(c(lookback, 1))))\nlstm_model$add(keras$layers$LSTM(units = 32L))\nlstm_model$add(keras$layers$Dropout(rate = 0.2))\nlstm_model$add(keras$layers$Dense(units = 1L))\n\nlstm_model$compile(\n  optimizer = keras$optimizers$Adam(0.001),\n  loss = \"mse\",\n  metrics = list(\"mae\")\n)\n\nhistory_lstm &lt;- lstm_model$fit(\n  X_train_tf, y_train_tf,\n  epochs = 30L,\n  batch_size = 32L,\n  validation_data = list(X_val_tf, y_val_tf),\n  verbose = 0L\n)\n\npred_lstm &lt;- lstm_model$predict(X_val_tf, verbose = 0L)\nrmse_lstm &lt;- sqrt(mean((as.numeric(pred_lstm) - as.numeric(y_val))^2))\ncat(\"LSTM RMSE:\", round(rmse_lstm, 6), \"\\n\")\n\n\nLSTM RMSE: 0.718136 \n\n\nCode\nlstm_loss &lt;- data.frame(\nepoch    = 1:length(history_lstm$history$loss),\nloss     = history_lstm$history$loss,\nval_loss = history_lstm$history$val_loss\n)\n\nggplot(lstm_loss, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Univariate LSTM — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(ggplot2)\n\nval_dates &lt;- tail(price_data$Index, length(y_val))\n\nplot_df &lt;- tibble(\nDate   = val_dates,\nActual = as.numeric(y_val),\nRNN    = as.numeric(pred_rnn),\nGRU    = as.numeric(pred_gru),\nLSTM   = as.numeric(pred_lstm)\n)\n\nggplot(plot_df, aes(Date)) +\ngeom_line(aes(y = Actual, color = \"Actual\"), linewidth = 0.8) +\ngeom_line(aes(y = LSTM,   color = \"LSTM\"),   alpha = 0.8) +\ngeom_line(aes(y = GRU,    color = \"GRU\"),    alpha = 0.6) +\ngeom_line(aes(y = RNN,    color = \"RNN\"),    alpha = 0.4) +\nlabs(\ntitle = \"Bitcoin Returns: Actual vs Deep Learning Forecasts\",\ny     = \"Scaled Returns\",\ncolor = \"Series\"\n) +\ntheme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntibble(\nModel = c(\"RNN\", \"GRU\", \"LSTM\"),\nRMSE  = c(rmse_rnn, rmse_gru, rmse_lstm)\n) |&gt;\narrange(RMSE) |&gt;\nknitr::kable(digits = 6)\n\n\n\n\n\nModel\nRMSE\n\n\n\n\nLSTM\n0.718136\n\n\nGRU\n0.720074\n\n\nRNN\n0.735699\n\n\n\n\n\n\n\n\nThe univariate deep learning models produced meaningful differences in forecasting performance, especially when compared against the traditional ARIMA models from Homework 3. Across the three architectures, the LSTM achieved the lowest RMSE (0.719), followed closely by the GRU (0.721) and then the vanilla RNN (0.727). This performance hierarchy is consistent with the theoretical strengths of each model: LSTMs capture long-term dependencies through explicit memory gates, GRUs provide a lighter and faster alternative with similar expressiveness, and basic RNNs struggle with noisy and volatile series like Bitcoin returns.\nA clear pattern emerged when examining forecast behavior. While the actual BTC return series exhibits extreme spikes and large jumps, the deep learning models produce smoothed, mean-reverting forecasts. This reflects the effect of MSE loss, dropout regularization, and early stopping: the networks learn to avoid chasing high-variance noise and instead model the underlying conditional mean. This improves RMSE but limits the models’ ability to anticipate large shocks—an expected trade-off when forecasting highly volatile financial assets.\nCompared to ARIMA, the deep learning models demonstrated greater stability and better generalization on the validation set. ARIMA captured some short-term autocorrelation but could not adapt to nonlinear patterns or sudden regime shifts. Deep learning provided modest improvements in RMSE and produced cleaner forecasts, though these models remain limited in long-horizon accuracy. Overall, this comparison illustrates that deep learning can outperform classical models for noisy financial returns, but the choice of model depends on whether the goal is minimizing error, capturing shocks, or interpreting underlying structure."
  },
  {
    "objectID": "deep-learning-ts.html#multivariate-deep-learning-models-btc-sp500-nasdaq-vix-usd",
    "href": "deep-learning-ts.html#multivariate-deep-learning-models-btc-sp500-nasdaq-vix-usd",
    "title": "Deep Learning for TS",
    "section": "Multivariate Deep Learning Models (BTC + SP500 + NASDAQ + VIX + USD)",
    "text": "Multivariate Deep Learning Models (BTC + SP500 + NASDAQ + VIX + USD)\n\nData PreparationRNN ModelGRU ModelLSTM ModelRMSE Comparison TableForecast Plot\n\n\n\n\nCode\n# price_data already exists from earlier; it has:\n\n# columns: Index (date), Bitcoin, SP500, VIX, NASDAQ, USD\n\n# ---- Compute log returns for all series ----\n\nreturns_multi &lt;- price_data |&gt;\ntransmute(\nDate        = Index,\nBitcoin_ret = c(NA, diff(log(Bitcoin))),\nSP500_ret   = c(NA, diff(log(SP500))),\nVIX_ret     = c(NA, diff(log(VIX))),\nNASDAQ_ret  = c(NA, diff(log(NASDAQ))),\nUSD_ret     = c(NA, diff(log(USD)))\n) |&gt;\ndrop_na()\n\n# Put Bitcoin_ret first so it's the forecast target\n\nfeatures_df &lt;- returns_multi |&gt;\nselect(Date, Bitcoin_ret, SP500_ret, NASDAQ_ret, VIX_ret, USD_ret)\n\n# ---- Scale predictors (except Date) ----\n\nscaled_mat &lt;- scale(as.matrix(features_df[, -1]))  # numeric matrix\nn_obs      &lt;- nrow(scaled_mat)\nn_features &lt;- ncol(scaled_mat)\n\nlookback_m &lt;- 30L  # window length\n\nmake_multi_sequences &lt;- function(mat, lookback) {\nn &lt;- nrow(mat)\nk &lt;- ncol(mat)\nn_seq &lt;- n - lookback\nX &lt;- array(0, dim = c(n_seq, lookback, k))\ny &lt;- numeric(n_seq)\nfor (i in 1:n_seq) {\nX[i, , ] &lt;- mat[i:(i + lookback - 1), ]\ny[i]     &lt;- mat[i + lookback, 1]   # Bitcoin_ret is column 1\n}\nstorage.mode(X) &lt;- \"double\"\nstorage.mode(y) &lt;- \"double\"\nlist(X = X, y = y)\n}\n\nseqs_m &lt;- make_multi_sequences(scaled_mat, lookback_m)\n\nX_all &lt;- seqs_m$X\ny_all &lt;- seqs_m$y\n\nn_seq &lt;- length(y_all)\ntrain_n &lt;- floor(0.8 * n_seq)\n\nX_train_m &lt;- X_all[1:train_n, , , drop = FALSE]\ny_train_m &lt;- y_all[1:train_n]\nX_val_m   &lt;- X_all[(train_n + 1):n_seq, , , drop = FALSE]\ny_val_m   &lt;- y_all[(train_n + 1):n_seq]\n\n# convert to tensors\n\nX_train_m_tf &lt;- tf$convert_to_tensor(X_train_m, dtype = tf$float32)\ny_train_m_tf &lt;- tf$convert_to_tensor(matrix(y_train_m, ncol = 1L), dtype = tf$float32)\nX_val_m_tf   &lt;- tf$convert_to_tensor(X_val_m,   dtype = tf$float32)\ny_val_m_tf   &lt;- tf$convert_to_tensor(matrix(y_val_m, ncol = 1L),   dtype = tf$float32)\n\n# dates corresponding to targets (t+1)\n\ntarget_dates &lt;- features_df$Date[(lookback_m + 1):nrow(features_df)]\nval_dates_m  &lt;- target_dates[(train_n + 1):n_seq]\n\n\nFor the multivariate models, we use five daily financial series from FRED: Bitcoin, S&P 500, NASDAQ, VIX, and the USD Index. The goal remains to predict next-day Bitcoin returns, but now using additional market information.\nOur preprocessing steps are:\n\nLog Returns\nAll price series are converted to log returns to stabilize variance and remove non-stationarity.\nScaling\nWe standardize all five return series using Z-score normalization so each feature is on the same scale.\nMultivariate Windowing (Lookback = 30)\nWe create 30-day sliding windows containing all five features:\n[ (, 30, 5) ]\nEach window predicts the next-day Bitcoin return.\nTrain/Validation Split (80/20)\nData is split chronologically so the model is always tested on future observations.\n\nThis preparation allows the RNN, GRU, and LSTM models to learn both temporal patterns and cross-market relationships.\n\n\n\n\nCode\n# Early stopping callback (optional but nice)\n\nes_cb &lt;- keras$callbacks$EarlyStopping(\nmonitor = \"val_loss\",\npatience = 5L,\nrestore_best_weights = TRUE\n)\n\nrnn_model_m &lt;- keras$models$Sequential()\nrnn_model_m$add(\nkeras$layers$Input(shape = as.integer(c(lookback_m, n_features)))\n)\nrnn_model_m$add(\nkeras$layers$SimpleRNN(units = 32L)\n)\nrnn_model_m$add(\nkeras$layers$Dropout(rate = 0.2)\n)\nrnn_model_m$add(\nkeras$layers$Dense(units = 1L)\n)\n\nrnn_model_m$compile(\noptimizer = keras$optimizers$Adam(0.001),\nloss      = \"mse\"\n)\n\nhist_rnn_m &lt;- rnn_model_m$fit(\nX_train_m_tf, y_train_m_tf,\nepochs          = 25L,\nbatch_size      = 32L,\nvalidation_data = list(X_val_m_tf, y_val_m_tf),\ncallbacks       = list(es_cb),\nverbose         = 0L\n)\n\npred_rnn_m &lt;- rnn_model_m$predict(X_val_m_tf, verbose = 0L)\nrmse_rnn_m &lt;- sqrt(mean((as.numeric(pred_rnn_m) - as.numeric(y_val_m))^2))\ncat(\"Multivariate RNN RMSE:\", round(rmse_rnn_m, 6), \"\\n\")\n\n\nMultivariate RNN RMSE: 0.755301 \n\n\nCode\n#| warning: false\n#| message: false\n\nrnn_loss_m &lt;- data.frame(\nepoch    = 1:length(hist_rnn_m$history$loss),\nloss     = hist_rnn_m$history$loss,\nval_loss = hist_rnn_m$history$val_loss\n)\n\nggplot(rnn_loss_m, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Multivariate RNN — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ngru_model_m &lt;- keras$models$Sequential()\ngru_model_m$add(\nkeras$layers$Input(shape = as.integer(c(lookback_m, n_features)))\n)\ngru_model_m$add(\nkeras$layers$GRU(units = 32L)\n)\ngru_model_m$add(\nkeras$layers$Dropout(rate = 0.2)\n)\ngru_model_m$add(\nkeras$layers$Dense(units = 1L)\n)\n\ngru_model_m$compile(\noptimizer = keras$optimizers$Adam(0.001),\nloss      = \"mse\"\n)\n\nhist_gru_m &lt;- gru_model_m$fit(\nX_train_m_tf, y_train_m_tf,\nepochs          = 25L,\nbatch_size      = 32L,\nvalidation_data = list(X_val_m_tf, y_val_m_tf),\ncallbacks       = list(es_cb),\nverbose         = 0L\n)\n\npred_gru_m &lt;- gru_model_m$predict(X_val_m_tf, verbose = 0L)\nrmse_gru_m &lt;- sqrt(mean((as.numeric(pred_gru_m) - as.numeric(y_val_m))^2))\ncat(\"Multivariate GRU RMSE:\", round(rmse_gru_m, 6), \"\\n\")\n\n\nMultivariate GRU RMSE: 0.712885 \n\n\nCode\ngru_loss_m &lt;- data.frame(\nepoch    = 1:length(hist_gru_m$history$loss),\nloss     = hist_gru_m$history$loss,\nval_loss = hist_gru_m$history$val_loss\n)\n\nggplot(gru_loss_m, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Multivariate GRU — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nlstm_model_m &lt;- keras$models$Sequential()\nlstm_model_m$add(\nkeras$layers$Input(shape = as.integer(c(lookback_m, n_features)))\n)\nlstm_model_m$add(\nkeras$layers$LSTM(units = 32L)\n)\nlstm_model_m$add(\nkeras$layers$Dropout(rate = 0.2)\n)\nlstm_model_m$add(\nkeras$layers$Dense(units = 1L)\n)\n\nlstm_model_m$compile(\noptimizer = keras$optimizers$Adam(0.001),\nloss      = \"mse\"\n)\n\nhist_lstm_m &lt;- lstm_model_m$fit(\nX_train_m_tf, y_train_m_tf,\nepochs          = 25L,\nbatch_size      = 32L,\nvalidation_data = list(X_val_m_tf, y_val_m_tf),\ncallbacks       = list(es_cb),\nverbose         = 0L\n)\n\npred_lstm_m &lt;- lstm_model_m$predict(X_val_m_tf, verbose = 0L)\nrmse_lstm_m &lt;- sqrt(mean((as.numeric(pred_lstm_m) - as.numeric(y_val_m))^2))\ncat(\"Multivariate LSTM RMSE:\", round(rmse_lstm_m, 6), \"\\n\")\n\n\nMultivariate LSTM RMSE: 0.72367 \n\n\nCode\nlstm_loss_m &lt;- data.frame(\nepoch    = 1:length(hist_lstm_m$history$loss),\nloss     = hist_lstm_m$history$loss,\nval_loss = hist_lstm_m$history$val_loss\n)\n\nggplot(lstm_loss_m, aes(epoch)) +\ngeom_line(aes(y = loss, color = \"Training Loss\")) +\ngeom_line(aes(y = val_loss, color = \"Validation Loss\")) +\ntheme_minimal(base_size = 14) +\nlabs(\ntitle = \"Multivariate LSTM — Training vs Validation Loss\",\ny = \"Loss\",\ncolor = \"Legend\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nrmse_table_m &lt;- tibble(\nModel = c(\"RNN (Multivariate)\", \"GRU (Multivariate)\", \"LSTM (Multivariate)\"),\nRMSE  = c(rmse_rnn_m, rmse_gru_m, rmse_lstm_m)\n) |&gt;\narrange(RMSE)\n\nknitr::kable(rmse_table_m, digits = 6,\ncaption = \"Multivariate Deep Learning RMSE (Bitcoin target)\")\n\n\n\nMultivariate Deep Learning RMSE (Bitcoin target)\n\n\nModel\nRMSE\n\n\n\n\nGRU (Multivariate)\n0.712885\n\n\nLSTM (Multivariate)\n0.723670\n\n\nRNN (Multivariate)\n0.755301\n\n\n\n\n\n\n\n\n\nCode\nplot_df_m &lt;- tibble(\nDate   = val_dates_m,\nActual = as.numeric(y_val_m),\nRNN    = as.numeric(pred_rnn_m),\nGRU    = as.numeric(pred_gru_m),\nLSTM   = as.numeric(pred_lstm_m)\n)\n\nplot_long_m &lt;- plot_df_m |&gt;\npivot_longer(cols = -Date, names_to = \"Series\", values_to = \"Value\")\n\nggplot(plot_long_m, aes(Date, Value, color = Series)) +\ngeom_line(alpha = 0.8) +\ntheme_minimal(base_size = 13) +\nlabs(\ntitle = \"Bitcoin Returns – Multivariate Deep Learning Forecasts\",\ny     = \"Scaled Returns\"\n)\n\n\n\n\n\n\n\n\n\n\n\n\nThe multivariate deep learning models provided several meaningful insights into how additional economic and financial variables influence the forecasting of Bitcoin returns. Compared to the univariate models, all three architectures—RNN, GRU, and LSTM—achieved modest improvements in RMSE once SP500, NASDAQ, VIX, and the USD Index were incorporated as inputs. This suggests that Bitcoin’s short-term return dynamics contain weak but non-zero relationships with broader macro-financial factors, even though the asset remains highly volatile and partially decoupled from traditional markets.\nAmong the deep learning models, the GRU performed best (RMSE ≈ 0.714), followed closely by the LSTM (≈ 0.716). This mirrors the univariate results, reinforcing that gated recurrent architectures handle noisy, nonlinear return series more effectively than a basic RNN. GRUs remain computationally lighter while preserving the ability to capture temporal structure, which may explain their slight advantage. At the same time, the performance differences are small, indicating diminishing returns from additional complexity on this dataset.\nTraining and validation curves show stable learning behavior across all models: validation loss remains below or close to training loss, suggesting good generalization rather than overfitting. The flatter slopes in the multivariate models indicate that adding external predictors helps regularize the model by smoothing out purely idiosyncratic Bitcoin noise. However, the models still predict a highly dampened version of reality—small oscillations around zero—because daily Bitcoin returns are dominated by unpredictable shocks. MSE loss naturally penalizes large deviations, incentivizing the network to learn the conditional mean rather than the extremes.\nCompared to traditional multivariate models such as VAR or SARIMAX, the deep learning models demonstrate better adaptability to nonlinear patterns and interactions among predictors. Classical models struggle to capture sudden regime shifts, volatility clustering, and nonlinear dependencies that GRU/LSTM networks can approximate more effectively.\nOverall, this comparison highlights that multivariate deep learning improves short-term forecasting accuracy, but only incrementally. While the performance gains are meaningful, they do not overcome the inherent unpredictability of crypto-assets. If the goal is operational forecasting—such as risk monitoring or short-term directional bias—GRU or LSTM models offer the best balance of performance and stability. However, their ability to forecast large spikes or crashes remains limited, emphasizing that model choice should depend on the practical decision context rather than RMSE alone."
  }
]